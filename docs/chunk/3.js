/*! For license information please see 3.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],Array(100).concat([function(e,i,n){(function(i){var n;n="undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(26))},function(e,i){e.exports={"toUnsigned":function(e){return e>>>0},"toHexString":function(e){return("00"+e.toString(16)).slice(-2)}}},function(e,i){function _extends(){return e.exports=_extends=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,_extends.apply(this,arguments)}e.exports=_extends,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,i,n){(function(i){var a,s=void 0!==i?i:"undefined"!=typeof window?window:{},o=n(111);"undefined"!=typeof document?a=document:(a=s["__GLOBAL_DOCUMENT_CACHE@4"])||(a=s["__GLOBAL_DOCUMENT_CACHE@4"]=o),e.exports=a}).call(this,n(26))},function(e,i,n){var a=n(14);e.exports=function _inheritsLoose(e,i){e.prototype=Object.create(i.prototype),e.prototype.constructor=e,a(e,i)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,i,n){"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var a=_interopDefault(n(121)),s=_interopDefault(n(100));e.exports=function resolveUrl(e,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(e)||(e=a.buildAbsoluteURL(s.location&&s.location.href||"",e)),a.buildAbsoluteURL(e,i))}},function(e,i,n){"use strict";(function(i){var a=function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(n(100));e.exports=function decodeB64ToUint8Array(e){for(var n=function atob(e){return a.atob?a.atob(e):i.from(e,"base64").toString("binary")}(e),s=new Uint8Array(n.length),o=0;o<n.length;o++)s[o]=n.charCodeAt(o);return s}}).call(this,n(123).Buffer)},function(e,i){function copy(e,i){for(var n in e)i[n]=e[n]}function _extends(e,i){var n=e.prototype;if(Object.create){var a=Object.create(i.prototype);n.__proto__=a}if(!(n instanceof i)){function t(){}t.prototype=i.prototype,copy(n,t=new t),e.prototype=n=t}n.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),n.constructor=e)}var n={},a=n.ELEMENT_NODE=1,s=n.ATTRIBUTE_NODE=2,o=n.TEXT_NODE=3,u=n.CDATA_SECTION_NODE=4,l=n.ENTITY_REFERENCE_NODE=5,c=n.ENTITY_NODE=6,h=n.PROCESSING_INSTRUCTION_NODE=7,f=n.COMMENT_NODE=8,m=n.DOCUMENT_NODE=9,g=n.DOCUMENT_TYPE_NODE=10,v=n.DOCUMENT_FRAGMENT_NODE=11,y=n.NOTATION_NODE=12,_={},T={},b=(_.INDEX_SIZE_ERR=(T[1]="Index size error",1),_.DOMSTRING_SIZE_ERR=(T[2]="DOMString size error",2),_.HIERARCHY_REQUEST_ERR=(T[3]="Hierarchy request error",3)),S=(_.WRONG_DOCUMENT_ERR=(T[4]="Wrong document",4),_.INVALID_CHARACTER_ERR=(T[5]="Invalid character",5),_.NO_DATA_ALLOWED_ERR=(T[6]="No data allowed",6),_.NO_MODIFICATION_ALLOWED_ERR=(T[7]="No modification allowed",7),_.NOT_FOUND_ERR=(T[8]="Not found",8)),C=(_.NOT_SUPPORTED_ERR=(T[9]="Not supported",9),_.INUSE_ATTRIBUTE_ERR=(T[10]="Attribute in use",10));_.INVALID_STATE_ERR=(T[11]="Invalid state",11),_.SYNTAX_ERR=(T[12]="Syntax error",12),_.INVALID_MODIFICATION_ERR=(T[13]="Invalid modification",13),_.NAMESPACE_ERR=(T[14]="Invalid namespace",14),_.INVALID_ACCESS_ERR=(T[15]="Invalid access",15);function DOMException(e,i){if(i instanceof Error)var n=i;else n=this,Error.call(this,T[e]),this.message=T[e],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return n.code=e,i&&(this.message=this.message+": "+i),n}function NodeList(){}function LiveNodeList(e,i){this._node=e,this._refresh=i,_updateLiveList(this)}function _updateLiveList(e){var i=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=i){var n=e._refresh(e._node);__set__(e,"length",n.length),copy(n,e),e._inc=i}}function NamedNodeMap(){}function _findNodeIndex(e,i){for(var n=e.length;n--;)if(e[n]===i)return n}function _addNamedNode(e,i,n,a){if(a?i[_findNodeIndex(i,a)]=n:i[i.length++]=n,e){n.ownerElement=e;var s=e.ownerDocument;s&&(a&&_onRemoveAttribute(s,e,a),function _onAddAttribute(e,i,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(i._nsMap[n.prefix?n.localName:""]=n.value)}(s,e,n))}}function _removeNamedNode(e,i,n){var a=_findNodeIndex(i,n);if(!(a>=0))throw DOMException(S,new Error(e.tagName+"@"+n));for(var s=i.length-1;a<s;)i[a]=i[++a];if(i.length=s,e){var o=e.ownerDocument;o&&(_onRemoveAttribute(o,e,n),n.ownerElement=null)}}function DOMImplementation(e){if(this._features={},e)for(var i in e)this._features=e[i]}function Node(){}function _xmlEncoder(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function _visitNode(e,i){if(i(e))return!0;if(e=e.firstChild)do{if(_visitNode(e,i))return!0}while(e=e.nextSibling)}function Document(){}function _onRemoveAttribute(e,i,n,a){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete i._nsMap[n.prefix?n.localName:""]}function _onUpdateChild(e,i,n){if(e&&e._inc){e._inc++;var a=i.childNodes;if(n)a[a.length++]=n;else{for(var s=i.firstChild,o=0;s;)a[o++]=s,s=s.nextSibling;a.length=o}}}function _removeChild(e,i){var n=i.previousSibling,a=i.nextSibling;return n?n.nextSibling=a:e.firstChild=a,a?a.previousSibling=n:e.lastChild=n,_onUpdateChild(e.ownerDocument,e),i}function _insertBefore(e,i,n){var a=i.parentNode;if(a&&a.removeChild(i),i.nodeType===v){var s=i.firstChild;if(null==s)return i;var o=i.lastChild}else s=o=i;var u=n?n.previousSibling:e.lastChild;s.previousSibling=u,o.nextSibling=n,u?u.nextSibling=s:e.firstChild=s,null==n?e.lastChild=o:n.previousSibling=o;do{s.parentNode=e}while(s!==o&&(s=s.nextSibling));return _onUpdateChild(e.ownerDocument||e,e),i.nodeType==v&&(i.firstChild=i.lastChild=null),i}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(e,i){var n=[],a=9==this.nodeType?this.documentElement:this,s=a.prefix,o=a.namespaceURI;if(o&&null==s&&null==(s=a.lookupPrefix(o)))var u=[{"namespace":o,"prefix":null}];return serializeToString(this,n,e,i,u),n.join("")}function needNamespaceDefine(e,i,n){var a=e.prefix||"",s=e.namespaceURI;if(!a&&!s)return!1;if("xml"===a&&"http://www.w3.org/XML/1998/namespace"===s||"http://www.w3.org/2000/xmlns/"==s)return!1;for(var o=n.length;o--;){var u=n[o];if(u.prefix==a)return u.namespace!=s}return!0}function serializeToString(e,i,n,c,y){if(c){if(!(e=c(e)))return;if("string"==typeof e)return void i.push(e)}switch(e.nodeType){case a:y||(y=[]);y.length;var _=e.attributes,T=_.length,b=e.firstChild,S=e.tagName;n="http://www.w3.org/1999/xhtml"===e.namespaceURI||n,i.push("<",S);for(var C=0;C<T;C++){"xmlns"==(k=_.item(C)).prefix?y.push({"prefix":k.localName,"namespace":k.value}):"xmlns"==k.nodeName&&y.push({"prefix":"","namespace":k.value})}for(C=0;C<T;C++){var k;if(needNamespaceDefine(k=_.item(C),0,y)){var E=k.prefix||"",w=k.namespaceURI,P=E?" xmlns:"+E:" xmlns";i.push(P,'="',w,'"'),y.push({"prefix":E,"namespace":w})}serializeToString(k,i,n,c,y)}if(needNamespaceDefine(e,0,y)){E=e.prefix||"",w=e.namespaceURI,P=E?" xmlns:"+E:" xmlns";i.push(P,'="',w,'"'),y.push({"prefix":E,"namespace":w})}if(b||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(S)){if(i.push(">"),n&&/^script$/i.test(S))for(;b;)b.data?i.push(b.data):serializeToString(b,i,n,c,y),b=b.nextSibling;else for(;b;)serializeToString(b,i,n,c,y),b=b.nextSibling;i.push("</",S,">")}else i.push("/>");return;case m:case v:for(b=e.firstChild;b;)serializeToString(b,i,n,c,y),b=b.nextSibling;return;case s:return i.push(" ",e.name,'="',e.value.replace(/[<&"]/g,_xmlEncoder),'"');case o:return i.push(e.data.replace(/[<&]/g,_xmlEncoder));case u:return i.push("<![CDATA[",e.data,"]]>");case f:return i.push("\x3c!--",e.data,"--\x3e");case g:var I=e.publicId,x=e.systemId;if(i.push("<!DOCTYPE ",e.name),I)i.push(' PUBLIC "',I),x&&"."!=x&&i.push('" "',x),i.push('">');else if(x&&"."!=x)i.push(' SYSTEM "',x,'">');else{var A=e.internalSubset;A&&i.push(" [",A,"]"),i.push(">")}return;case h:return i.push("<?",e.target," ",e.data,"?>");case l:return i.push("&",e.nodeName,";");default:i.push("??",e.nodeName)}}function __set__(e,i,n){e[i]=n}DOMException.prototype=Error.prototype,copy(_,DOMException),NodeList.prototype={"length":0,"item":function(e){return this[e]||null},"toString":function(e,i){for(var n=[],a=0;a<this.length;a++)serializeToString(this[a],n,e,i);return n.join("")}},LiveNodeList.prototype.item=function(e){return _updateLiveList(this),this[e]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={"length":0,"item":NodeList.prototype.item,"getNamedItem":function(e){for(var i=this.length;i--;){var n=this[i];if(n.nodeName==e)return n}},"setNamedItem":function(e){var i=e.ownerElement;if(i&&i!=this._ownerElement)throw new DOMException(C);var n=this.getNamedItem(e.nodeName);return _addNamedNode(this._ownerElement,this,e,n),n},"setNamedItemNS":function(e){var i,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new DOMException(C);return i=this.getNamedItemNS(e.namespaceURI,e.localName),_addNamedNode(this._ownerElement,this,e,i),i},"removeNamedItem":function(e){var i=this.getNamedItem(e);return _removeNamedNode(this._ownerElement,this,i),i},"removeNamedItemNS":function(e,i){var n=this.getNamedItemNS(e,i);return _removeNamedNode(this._ownerElement,this,n),n},"getNamedItemNS":function(e,i){for(var n=this.length;n--;){var a=this[n];if(a.localName==i&&a.namespaceURI==e)return a}return null}},DOMImplementation.prototype={"hasFeature":function(e,i){var n=this._features[e.toLowerCase()];return!(!n||i&&!(i in n))},"createDocument":function(e,i,n){var a=new Document;if(a.implementation=this,a.childNodes=new NodeList,a.doctype=n,n&&a.appendChild(n),i){var s=a.createElementNS(e,i);a.appendChild(s)}return a},"createDocumentType":function(e,i,n){var a=new DocumentType;return a.name=e,a.nodeName=e,a.publicId=i,a.systemId=n,a}},Node.prototype={"firstChild":null,"lastChild":null,"previousSibling":null,"nextSibling":null,"attributes":null,"parentNode":null,"childNodes":null,"ownerDocument":null,"nodeValue":null,"namespaceURI":null,"prefix":null,"localName":null,"insertBefore":function(e,i){return _insertBefore(this,e,i)},"replaceChild":function(e,i){this.insertBefore(e,i),i&&this.removeChild(i)},"removeChild":function(e){return _removeChild(this,e)},"appendChild":function(e){return this.insertBefore(e,null)},"hasChildNodes":function(){return null!=this.firstChild},"cloneNode":function(e){return function cloneNode(e,i,n){var o=new i.constructor;for(var u in i){var l=i[u];"object"!=typeof l&&l!=o[u]&&(o[u]=l)}i.childNodes&&(o.childNodes=new NodeList);switch(o.ownerDocument=e,o.nodeType){case a:var c=i.attributes,h=o.attributes=new NamedNodeMap,f=c.length;h._ownerElement=o;for(var m=0;m<f;m++)o.setAttributeNode(cloneNode(e,c.item(m),!0));break;case s:n=!0}if(n)for(var g=i.firstChild;g;)o.appendChild(cloneNode(e,g,n)),g=g.nextSibling;return o}(this.ownerDocument||this,this,e)},"normalize":function(){for(var e=this.firstChild;e;){var i=e.nextSibling;i&&i.nodeType==o&&e.nodeType==o?(this.removeChild(i),e.appendData(i.data)):(e.normalize(),e=i)}},"isSupported":function(e,i){return this.ownerDocument.implementation.hasFeature(e,i)},"hasAttributes":function(){return this.attributes.length>0},"lookupPrefix":function(e){for(var i=this;i;){var n=i._nsMap;if(n)for(var a in n)if(n[a]==e)return a;i=i.nodeType==s?i.ownerDocument:i.parentNode}return null},"lookupNamespaceURI":function(e){for(var i=this;i;){var n=i._nsMap;if(n&&e in n)return n[e];i=i.nodeType==s?i.ownerDocument:i.parentNode}return null},"isDefaultNamespace":function(e){return null==this.lookupPrefix(e)}},copy(n,Node),copy(n,Node.prototype),Document.prototype={"nodeName":"#document","nodeType":m,"doctype":null,"documentElement":null,"_inc":1,"insertBefore":function(e,i){if(e.nodeType==v){for(var n=e.firstChild;n;){var s=n.nextSibling;this.insertBefore(n,i),n=s}return e}return null==this.documentElement&&e.nodeType==a&&(this.documentElement=e),_insertBefore(this,e,i),e.ownerDocument=this,e},"removeChild":function(e){return this.documentElement==e&&(this.documentElement=null),_removeChild(this,e)},"importNode":function(e,i){return function importNode(e,i,n){var o;switch(i.nodeType){case a:(o=i.cloneNode(!1)).ownerDocument=e;case v:break;case s:n=!0}o||(o=i.cloneNode(!1));if(o.ownerDocument=e,o.parentNode=null,n)for(var u=i.firstChild;u;)o.appendChild(importNode(e,u,n)),u=u.nextSibling;return o}(this,e,i)},"getElementById":function(e){var i=null;return _visitNode(this.documentElement,(function(n){if(n.nodeType==a&&n.getAttribute("id")==e)return i=n,!0})),i},"createElement":function(e){var i=new Element;return i.ownerDocument=this,i.nodeName=e,i.tagName=e,i.childNodes=new NodeList,(i.attributes=new NamedNodeMap)._ownerElement=i,i},"createDocumentFragment":function(){var e=new DocumentFragment;return e.ownerDocument=this,e.childNodes=new NodeList,e},"createTextNode":function(e){var i=new Text;return i.ownerDocument=this,i.appendData(e),i},"createComment":function(e){var i=new Comment;return i.ownerDocument=this,i.appendData(e),i},"createCDATASection":function(e){var i=new CDATASection;return i.ownerDocument=this,i.appendData(e),i},"createProcessingInstruction":function(e,i){var n=new ProcessingInstruction;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=i,n},"createAttribute":function(e){var i=new Attr;return i.ownerDocument=this,i.name=e,i.nodeName=e,i.localName=e,i.specified=!0,i},"createEntityReference":function(e){var i=new EntityReference;return i.ownerDocument=this,i.nodeName=e,i},"createElementNS":function(e,i){var n=new Element,a=i.split(":"),s=n.attributes=new NamedNodeMap;return n.childNodes=new NodeList,n.ownerDocument=this,n.nodeName=i,n.tagName=i,n.namespaceURI=e,2==a.length?(n.prefix=a[0],n.localName=a[1]):n.localName=i,s._ownerElement=n,n},"createAttributeNS":function(e,i){var n=new Attr,a=i.split(":");return n.ownerDocument=this,n.nodeName=i,n.name=i,n.namespaceURI=e,n.specified=!0,2==a.length?(n.prefix=a[0],n.localName=a[1]):n.localName=i,n}},_extends(Document,Node),Element.prototype={"nodeType":a,"hasAttribute":function(e){return null!=this.getAttributeNode(e)},"getAttribute":function(e){var i=this.getAttributeNode(e);return i&&i.value||""},"getAttributeNode":function(e){return this.attributes.getNamedItem(e)},"setAttribute":function(e,i){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+i,this.setAttributeNode(n)},"removeAttribute":function(e){var i=this.getAttributeNode(e);i&&this.removeAttributeNode(i)},"appendChild":function(e){return e.nodeType===v?this.insertBefore(e,null):function _appendSingleChild(e,i){var n=i.parentNode;if(n){var a=e.lastChild;n.removeChild(i);a=e.lastChild}return a=e.lastChild,i.parentNode=e,i.previousSibling=a,i.nextSibling=null,a?a.nextSibling=i:e.firstChild=i,e.lastChild=i,_onUpdateChild(e.ownerDocument,e,i),i}(this,e)},"setAttributeNode":function(e){return this.attributes.setNamedItem(e)},"setAttributeNodeNS":function(e){return this.attributes.setNamedItemNS(e)},"removeAttributeNode":function(e){return this.attributes.removeNamedItem(e.nodeName)},"removeAttributeNS":function(e,i){var n=this.getAttributeNodeNS(e,i);n&&this.removeAttributeNode(n)},"hasAttributeNS":function(e,i){return null!=this.getAttributeNodeNS(e,i)},"getAttributeNS":function(e,i){var n=this.getAttributeNodeNS(e,i);return n&&n.value||""},"setAttributeNS":function(e,i,n){var a=this.ownerDocument.createAttributeNS(e,i);a.value=a.nodeValue=""+n,this.setAttributeNode(a)},"getAttributeNodeNS":function(e,i){return this.attributes.getNamedItemNS(e,i)},"getElementsByTagName":function(e){return new LiveNodeList(this,(function(i){var n=[];return _visitNode(i,(function(s){s===i||s.nodeType!=a||"*"!==e&&s.tagName!=e||n.push(s)})),n}))},"getElementsByTagNameNS":function(e,i){return new LiveNodeList(this,(function(n){var s=[];return _visitNode(n,(function(o){o===n||o.nodeType!==a||"*"!==e&&o.namespaceURI!==e||"*"!==i&&o.localName!=i||s.push(o)})),s}))}},Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=s,_extends(Attr,Node),CharacterData.prototype={"data":"","substringData":function(e,i){return this.data.substring(e,e+i)},"appendData":function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},"insertData":function(e,i){this.replaceData(e,0,i)},"appendChild":function(e){throw new Error(T[b])},"deleteData":function(e,i){this.replaceData(e,i,"")},"replaceData":function(e,i,n){n=this.data.substring(0,e)+n+this.data.substring(e+i),this.nodeValue=this.data=n,this.length=n.length}},_extends(CharacterData,Node),Text.prototype={"nodeName":"#text","nodeType":o,"splitText":function(e){var i=this.data,n=i.substring(e);i=i.substring(0,e),this.data=this.nodeValue=i,this.length=i.length;var a=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling),a}},_extends(Text,CharacterData),Comment.prototype={"nodeName":"#comment","nodeType":f},_extends(Comment,CharacterData),CDATASection.prototype={"nodeName":"#cdata-section","nodeType":u},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=g,_extends(DocumentType,Node),Notation.prototype.nodeType=y,_extends(Notation,Node),Entity.prototype.nodeType=c,_extends(Entity,Node),EntityReference.prototype.nodeType=l,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=v,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=h,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(e,i,n){return nodeSerializeToString.call(e,i,n)},Node.prototype.toString=nodeSerializeToString;try{if(Object.defineProperty){Object.defineProperty(LiveNodeList.prototype,"length",{"get":function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{"get":function(){return function getTextContent(e){switch(e.nodeType){case a:case v:var i=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&i.push(getTextContent(e)),e=e.nextSibling;return i.join("");default:return e.nodeValue}}(this)},"set":function(e){switch(this.nodeType){case a:case v:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),__set__=function(e,i,n){e["$$"+i]=n}}}catch(e){}i.DOMImplementation=DOMImplementation,i.XMLSerializer=XMLSerializer},function(e,i,n){"use strict";e.exports={"H264_STREAM_TYPE":27,"ADTS_STREAM_TYPE":15,"METADATA_STREAM_TYPE":21}},function(e,i){var n,a,s,o,u,l,c;n=function(e){return 9e4*e},a=function(e,i){return e*i},s=function(e){return e/9e4},o=function(e,i){return e/i},u=function(e,i){return n(o(e,i))},l=function(e,i){return a(s(e),i)},c=function(e,i,n){return s(n?e:e-i)},e.exports={"ONE_SECOND_IN_TS":9e4,"secondsToVideoTs":n,"secondsToAudioTs":a,"videoTsToSeconds":s,"audioTsToSeconds":o,"audioTsToVideoTs":u,"videoTsToAudioTs":l,"metadataTsToSeconds":c}},function(e,i){e.exports=function(e){var i="";return i+=String.fromCharCode(e[0]),i+=String.fromCharCode(e[1]),i+=String.fromCharCode(e[2]),i+=String.fromCharCode(e[3])}},,function(e,i){e.exports=function SafeParseTuple(e,i){var n,a=null;try{n=JSON.parse(e,i)}catch(e){a=e}return[a,n]}},function(e,i){function keyCode(e){if(e&&"object"==typeof e){var i=e.which||e.keyCode||e.charCode;i&&(e=i)}if("number"==typeof e)return o[e];var s,u=String(e);return(s=n[u.toLowerCase()])?s:(s=a[u.toLowerCase()])||(1===u.length?u.charCodeAt(0):void 0)}keyCode.isEventKey=function isEventKey(e,i){if(e&&"object"==typeof e){var s=e.which||e.keyCode||e.charCode;if(null==s)return!1;if("string"==typeof i){var o;if(o=n[i.toLowerCase()])return o===s;if(o=a[i.toLowerCase()])return o===s}else if("number"==typeof i)return i===s;return!1}};var n=(i=e.exports=keyCode).code=i.codes={"backspace":8,"tab":9,"enter":13,"shift":16,"ctrl":17,"alt":18,"pause/break":19,"caps lock":20,"esc":27,"space":32,"page up":33,"page down":34,"end":35,"home":36,"left":37,"up":38,"right":39,"down":40,"insert":45,"delete":46,"command":91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},a=i.aliases={"windows":91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,"ctl":17,"control":17,"option":18,"pause":19,"break":19,"caps":20,"return":13,"escape":27,"spc":32,"spacebar":32,"pgup":33,"pgdn":34,"ins":45,"del":46,"cmd":91};for(s=97;s<123;s++)n[String.fromCharCode(s)]=s-32;for(var s=48;s<58;s++)n[s-48]=s;for(s=1;s<13;s++)n["f"+s]=s+111;for(s=0;s<10;s++)n["numpad "+s]=s+96;var o=i.names=i.title={};for(s in n)o[n[s]]=s;for(var u in a)n[u]=a[u]},function(e,i,n){"use strict";var a=n(100),s=n(102),o=n(115);function initParams(e,i,n){var a=e;return o(i)?(n=i,"string"==typeof e&&(a={"uri":e})):a=s({},i,{"uri":e}),a.callback=n,a}function createXHR(e,i,n){return _createXHR(i=initParams(e,i,n))}function _createXHR(e){if(void 0===e.callback)throw new Error("callback argument missing");var i=!1,n=function cbOnce(n,a,s){i||(i=!0,e.callback(n,a,s))};function getBody(){var e=void 0;if(e=o.response?o.response:o.responseText||function getXml(e){try{if("document"===e.responseType)return e.responseXML;var i=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!i)return e.responseXML}catch(e){}return null}(o),g)try{e=JSON.parse(e)}catch(e){}return e}function errorFunc(e){return clearTimeout(u),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,v)}function loadFunc(){if(!s){var i;clearTimeout(u),i=e.useXDR&&void 0===o.status?200:1223===o.status?204:o.status;var a=v,h=null;return 0!==i?(a={"body":getBody(),"statusCode":i,"method":c,"headers":{},"url":l,"rawRequest":o},o.getAllResponseHeaders&&(a.headers=function(e){var i={};return e?(e.trim().split("\n").forEach((function(e){var n=e.indexOf(":"),a=e.slice(0,n).trim().toLowerCase(),s=e.slice(n+1).trim();void 0===i[a]?i[a]=s:Array.isArray(i[a])?i[a].push(s):i[a]=[i[a],s]})),i):i}(o.getAllResponseHeaders()))):h=new Error("Internal XMLHttpRequest Error"),n(h,a,a.body)}}var a,s,o=e.xhr||null;o||(o=e.cors||e.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var u,l=o.url=e.uri||e.url,c=o.method=e.method||"GET",h=e.body||e.data,f=o.headers=e.headers||{},m=!!e.sync,g=!1,v={"body":void 0,"headers":{},"statusCode":0,"method":c,"url":l,"rawRequest":o};if("json"in e&&!1!==e.json&&(g=!0,f.accept||f.Accept||(f.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(f["content-type"]||f["Content-Type"]||(f["Content-Type"]="application/json"),h=JSON.stringify(!0===e.json?h:e.json))),o.onreadystatechange=function readystatechange(){4===o.readyState&&setTimeout(loadFunc,0)},o.onload=loadFunc,o.onerror=errorFunc,o.onprogress=function(){},o.onabort=function(){s=!0},o.ontimeout=errorFunc,o.open(c,l,!m,e.username,e.password),m||(o.withCredentials=!!e.withCredentials),!m&&e.timeout>0&&(u=setTimeout((function(){if(!s){s=!0,o.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",errorFunc(e)}}),e.timeout)),o.setRequestHeader)for(a in f)f.hasOwnProperty(a)&&o.setRequestHeader(a,f[a]);else if(e.headers&&!function isEmpty(e){for(var i in e)if(e.hasOwnProperty(i))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(o.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(o),o.send(h||null),o}e.exports=createXHR,e.exports.default=createXHR,createXHR.XMLHttpRequest=a.XMLHttpRequest||function noop(){},createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:a.XDomainRequest,function forEachArray(e,i){for(var n=0;n<e.length;n++)i(e[n])}(["get","put","post","patch","head","delete"],(function(e){createXHR["delete"===e?"del":e]=function(i,n,a){return(n=initParams(i,n,a)).method=e.toUpperCase(),_createXHR(n)}}))},function(e,i){e.exports=function isFunction(e){if(!e)return!1;var i=n.call(e);return"[object Function]"===i||"function"==typeof e&&"[object RegExp]"!==i||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString},function(e,i,n){var a=n(100),s=e.exports={"WebVTT":n(117),"VTTCue":n(118),"VTTRegion":n(119)};a.vttjs=s,a.WebVTT=s.WebVTT;var o=s.VTTCue,u=s.VTTRegion,l=a.VTTCue,c=a.VTTRegion;s.shim=function(){a.VTTCue=o,a.VTTRegion=u},s.restore=function(){a.VTTCue=l,a.VTTRegion=c},a.VTTCue||s.shim()},function(e,i,n){var a=n(103),s=Object.create||function(){function F(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return F.prototype=e,new F}}();function ParsingError(e,i){this.name="ParsingError",this.code=e.code,this.message=i||e.message}function parseTimeStamp(e){function computeSeconds(e,i,n,a){return 3600*(0|e)+60*(0|i)+(0|n)+(0|a)/1e3}var i=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return i?i[3]?computeSeconds(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?computeSeconds(i[1],i[2],0,i[4]):computeSeconds(0,i[1],i[2],i[4]):null}function Settings(){this.values=s(null)}function parseOptions(e,i,n,a){var s=a?e.split(a):[e];for(var o in s)if("string"==typeof s[o]){var u=s[o].split(n);if(2===u.length)i(u[0],u[1])}}function parseCue(e,i,n){var a=e;function consumeTimeStamp(){var i=parseTimeStamp(e);if(null===i)throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed timestamp: "+a);return e=e.replace(/^[^\sa-zA-Z-]+/,""),i}function skipWhitespace(){e=e.replace(/^\s+/,"")}if(skipWhitespace(),i.startTime=consumeTimeStamp(),skipWhitespace(),"--\x3e"!==e.substr(0,3))throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+a);e=e.substr(3),skipWhitespace(),i.endTime=consumeTimeStamp(),skipWhitespace(),function consumeCueSettings(e,i){var a=new Settings;parseOptions(e,(function(e,i){switch(e){case"region":for(var s=n.length-1;s>=0;s--)if(n[s].id===i){a.set(e,n[s].region);break}break;case"vertical":a.alt(e,i,["rl","lr"]);break;case"line":var o=i.split(","),u=o[0];a.integer(e,u),a.percent(e,u)&&a.set("snapToLines",!1),a.alt(e,u,["auto"]),2===o.length&&a.alt("lineAlign",o[1],["start","center","end"]);break;case"position":o=i.split(","),a.percent(e,o[0]),2===o.length&&a.alt("positionAlign",o[1],["start","center","end"]);break;case"size":a.percent(e,i);break;case"align":a.alt(e,i,["start","center","end","left","right"])}}),/:/,/\s/),i.region=a.get("region",null),i.vertical=a.get("vertical","");try{i.line=a.get("line","auto")}catch(e){}i.lineAlign=a.get("lineAlign","start"),i.snapToLines=a.get("snapToLines",!0),i.size=a.get("size",100);try{i.align=a.get("align","center")}catch(e){i.align=a.get("align","middle")}try{i.position=a.get("position","auto")}catch(e){i.position=a.get("position",{"start":0,"left":0,"center":50,"middle":50,"end":100,"right":100},i.align)}i.positionAlign=a.get("positionAlign",{"start":"start","left":"start","center":"center","middle":"center","end":"end","right":"end"},i.align)}(e,i)}ParsingError.prototype=s(Error.prototype),ParsingError.prototype.constructor=ParsingError,ParsingError.Errors={"BadSignature":{"code":0,"message":"Malformed WebVTT signature."},"BadTimeStamp":{"code":1,"message":"Malformed time stamp."}},Settings.prototype={"set":function(e,i){this.get(e)||""===i||(this.values[e]=i)},"get":function(e,i,n){return n?this.has(e)?this.values[e]:i[n]:this.has(e)?this.values[e]:i},"has":function(e){return e in this.values},"alt":function(e,i,n){for(var a=0;a<n.length;++a)if(i===n[a]){this.set(e,i);break}},"integer":function(e,i){/^-?\d+$/.test(i)&&this.set(e,parseInt(i,10))},"percent":function(e,i){return!!(i.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(i=parseFloat(i))>=0&&i<=100)&&(this.set(e,i),!0)}};var o=a.createElement("textarea"),u={"c":"span","i":"i","b":"b","u":"u","ruby":"ruby","rt":"rt","v":"span","lang":"span"},l={"white":"rgba(255,255,255,1)","lime":"rgba(0,255,0,1)","cyan":"rgba(0,255,255,1)","red":"rgba(255,0,0,1)","yellow":"rgba(255,255,0,1)","magenta":"rgba(255,0,255,1)","blue":"rgba(0,0,255,1)","black":"rgba(0,0,0,1)"},c={"v":"title","lang":"lang"},h={"rt":"ruby"};function parseContent(e,i){function nextToken(){if(!i)return null;var e=i.match(/^([^<]*)(<[^>]*>?)?/);return function consume(e){return i=i.substr(e.length),e}(e[1]?e[1]:e[2])}function shouldAdd(e,i){return!h[i.localName]||h[i.localName]===e.localName}function createElement(i,n){var a=u[i];if(!a)return null;var s=e.document.createElement(a),o=c[i];return o&&n&&(s[o]=n.trim()),s}for(var n,a,s=e.document.createElement("div"),f=s,m=[];null!==(n=nextToken());)if("<"!==n[0])f.appendChild(e.document.createTextNode((a=n,o.innerHTML=a,a=o.textContent,o.textContent="",a)));else{if("/"===n[1]){m.length&&m[m.length-1]===n.substr(2).replace(">","")&&(m.pop(),f=f.parentNode);continue}var g,v=parseTimeStamp(n.substr(1,n.length-2));if(v){g=e.document.createProcessingInstruction("timestamp",v),f.appendChild(g);continue}var y=n.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(!(g=createElement(y[1],y[3])))continue;if(!shouldAdd(f,g))continue;if(y[2]){var _=y[2].split(".");_.forEach((function(e){var i=/^bg_/.test(e),n=i?e.slice(3):e;if(l.hasOwnProperty(n)){var a=i?"background-color":"color",s=l[n];g.style[a]=s}})),g.className=_.join(" ")}m.push(y[1]),f.appendChild(g),f=g}return s}var f=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function isStrongRTLChar(e){for(var i=0;i<f.length;i++){var n=f[i];if(e>=n[0]&&e<=n[1])return!0}return!1}function determineBidi(e){var i=[],n="";if(!e||!e.childNodes)return"ltr";function pushNodes(e,i){for(var n=i.childNodes.length-1;n>=0;n--)e.push(i.childNodes[n])}function nextTextNode(e){if(!e||!e.length)return null;var i=e.pop(),n=i.textContent||i.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===i.tagName?nextTextNode(e):i.childNodes?(pushNodes(e,i),nextTextNode(e)):void 0}for(pushNodes(i,e);n=nextTextNode(i);)for(var a=0;a<n.length;a++)if(isStrongRTLChar(n.charCodeAt(a)))return"rtl";return"ltr"}function StyleBox(){}function CueStyleBox(e,i,n){StyleBox.call(this),this.cue=i,this.cueDiv=parseContent(e,i.text);var a={"color":"rgba(255, 255, 255, 1)","backgroundColor":"rgba(0, 0, 0, 0.8)","position":"relative","left":0,"right":0,"top":0,"bottom":0,"display":"inline","writingMode":""===i.vertical?"horizontal-tb":"lr"===i.vertical?"vertical-lr":"vertical-rl","unicodeBidi":"plaintext"};this.applyStyles(a,this.cueDiv),this.div=e.document.createElement("div"),a={"direction":determineBidi(this.cueDiv),"writingMode":""===i.vertical?"horizontal-tb":"lr"===i.vertical?"vertical-lr":"vertical-rl","unicodeBidi":"plaintext","textAlign":"middle"===i.align?"center":i.align,"font":n.font,"whiteSpace":"pre-line","position":"absolute"},this.applyStyles(a),this.div.appendChild(this.cueDiv);var s=0;switch(i.positionAlign){case"start":s=i.position;break;case"center":s=i.position-i.size/2;break;case"end":s=i.position-i.size}""===i.vertical?this.applyStyles({"left":this.formatStyle(s,"%"),"width":this.formatStyle(i.size,"%")}):this.applyStyles({"top":this.formatStyle(s,"%"),"height":this.formatStyle(i.size,"%")}),this.move=function(e){this.applyStyles({"top":this.formatStyle(e.top,"px"),"bottom":this.formatStyle(e.bottom,"px"),"left":this.formatStyle(e.left,"px"),"right":this.formatStyle(e.right,"px"),"height":this.formatStyle(e.height,"px"),"width":this.formatStyle(e.width,"px")})}}function BoxPosition(e){var i,n,a,s;if(e.div){n=e.div.offsetHeight,a=e.div.offsetWidth,s=e.div.offsetTop;var o=(o=e.div.childNodes)&&(o=o[0])&&o.getClientRects&&o.getClientRects();e=e.div.getBoundingClientRect(),i=o?Math.max(o[0]&&o[0].height||0,e.height/o.length):0}this.left=e.left,this.right=e.right,this.top=e.top||s,this.height=e.height||n,this.bottom=e.bottom||s+(e.height||n),this.width=e.width||a,this.lineHeight=void 0!==i?i:e.lineHeight}function moveBoxToLinePosition(e,i,n,a){var s=new BoxPosition(i),o=i.cue,u=function computeLinePos(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var i=e.track,n=i.textTrackList,a=0,s=0;s<n.length&&n[s]!==i;s++)"showing"===n[s].mode&&a++;return-1*++a}(o),l=[];if(o.snapToLines){var c;switch(o.vertical){case"":l=["+y","-y"],c="height";break;case"rl":l=["+x","-x"],c="width";break;case"lr":l=["-x","+x"],c="width"}var h=s.lineHeight,f=h*Math.round(u),m=n[c]+h,g=l[0];Math.abs(f)>m&&(f=f<0?-1:1,f*=Math.ceil(m/h)*h),u<0&&(f+=""===o.vertical?n.height:n.width,l=l.reverse()),s.move(g,f)}else{var v=s.lineHeight/n.height*100;switch(o.lineAlign){case"center":u-=v/2;break;case"end":u-=v}switch(o.vertical){case"":i.applyStyles({"top":i.formatStyle(u,"%")});break;case"rl":i.applyStyles({"left":i.formatStyle(u,"%")});break;case"lr":i.applyStyles({"right":i.formatStyle(u,"%")})}l=["+y","-x","+x","-y"],s=new BoxPosition(i)}var y=function findBestPosition(e,i){for(var s,o=new BoxPosition(e),u=1,l=0;l<i.length;l++){for(;e.overlapsOppositeAxis(n,i[l])||e.within(n)&&e.overlapsAny(a);)e.move(i[l]);if(e.within(n))return e;var c=e.intersectPercentage(n);u>c&&(s=new BoxPosition(e),u=c),e=new BoxPosition(o)}return s||o}(s,l);i.move(y.toCSSCompatValues(n))}function WebVTT(){}StyleBox.prototype.applyStyles=function(e,i){for(var n in i=i||this.div,e)e.hasOwnProperty(n)&&(i.style[n]=e[n])},StyleBox.prototype.formatStyle=function(e,i){return 0===e?0:e+i},CueStyleBox.prototype=s(StyleBox.prototype),CueStyleBox.prototype.constructor=CueStyleBox,BoxPosition.prototype.move=function(e,i){switch(i=void 0!==i?i:this.lineHeight,e){case"+x":this.left+=i,this.right+=i;break;case"-x":this.left-=i,this.right-=i;break;case"+y":this.top+=i,this.bottom+=i;break;case"-y":this.top-=i,this.bottom-=i}},BoxPosition.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},BoxPosition.prototype.overlapsAny=function(e){for(var i=0;i<e.length;i++)if(this.overlaps(e[i]))return!0;return!1},BoxPosition.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},BoxPosition.prototype.overlapsOppositeAxis=function(e,i){switch(i){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},BoxPosition.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},BoxPosition.prototype.toCSSCompatValues=function(e){return{"top":this.top-e.top,"bottom":e.bottom-this.bottom,"left":this.left-e.left,"right":e.right-this.right,"height":this.height,"width":this.width}},BoxPosition.getSimpleBoxPosition=function(e){var i=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,a=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{"left":(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,"right":e.right,"top":e.top||a,"height":e.height||i,"bottom":e.bottom||a+(e.height||i),"width":e.width||n}},WebVTT.StringDecoder=function(){return{"decode":function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},WebVTT.convertCueToDOMTree=function(e,i){return e&&i?parseContent(e,i):null};WebVTT.processCues=function(e,i,n){if(!e||!i||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var a=e.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",n.appendChild(a),function shouldCompute(e){for(var i=0;i<e.length;i++)if(e[i].hasBeenReset||!e[i].displayState)return!0;return!1}(i)){var s=[],o=BoxPosition.getSimpleBoxPosition(a),u={"font":Math.round(.05*o.height*100)/100+"px sans-serif"};!function(){for(var n,l,c=0;c<i.length;c++)l=i[c],n=new CueStyleBox(e,l,u),a.appendChild(n.div),moveBoxToLinePosition(0,n,o,s),l.displayState=n.div,s.push(BoxPosition.getSimpleBoxPosition(n))}()}else for(var l=0;l<i.length;l++)a.appendChild(i[l].displayState)},WebVTT.Parser=function(e,i,n){n||(n=i,i={}),i||(i={}),this.window=e,this.vttjs=i,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},WebVTT.Parser.prototype={"reportOrThrowError":function(e){if(!(e instanceof ParsingError))throw e;this.onparsingerror&&this.onparsingerror(e)},"parse":function(e){var i=this;function collectNextLine(){for(var e=i.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var a=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,i.buffer=e.substr(n),a}function parseHeader(e){e.match(/X-TIMESTAMP-MAP/)?parseOptions(e,(function(e,n){switch(e){case"X-TIMESTAMP-MAP":!function parseTimestampMap(e){var n=new Settings;parseOptions(e,(function(e,i){switch(e){case"MPEGT":n.integer(e+"S",i);break;case"LOCA":n.set(e+"L",parseTimeStamp(i))}}),/[^\d]:/,/,/),i.ontimestampmap&&i.ontimestampmap({"MPEGTS":n.get("MPEGTS"),"LOCAL":n.get("LOCAL")})}(n)}}),/=/):parseOptions(e,(function(e,n){switch(e){case"Region":!function parseRegion(e){var n=new Settings;if(parseOptions(e,(function(e,i){switch(e){case"id":n.set(e,i);break;case"width":n.percent(e,i);break;case"lines":n.integer(e,i);break;case"regionanchor":case"viewportanchor":var a=i.split(",");if(2!==a.length)break;var s=new Settings;if(s.percent("x",a[0]),s.percent("y",a[1]),!s.has("x")||!s.has("y"))break;n.set(e+"X",s.get("x")),n.set(e+"Y",s.get("y"));break;case"scroll":n.alt(e,i,["up"])}}),/=/,/\s/),n.has("id")){var a=new(i.vttjs.VTTRegion||i.window.VTTRegion);a.width=n.get("width",100),a.lines=n.get("lines",3),a.regionAnchorX=n.get("regionanchorX",0),a.regionAnchorY=n.get("regionanchorY",100),a.viewportAnchorX=n.get("viewportanchorX",0),a.viewportAnchorY=n.get("viewportanchorY",100),a.scroll=n.get("scroll",""),i.onregion&&i.onregion(a),i.regionList.push({"id":n.get("id"),"region":a})}}(n)}}),/:/)}e&&(i.buffer+=i.decoder.decode(e,{"stream":!0}));try{var n;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;var a=(n=collectNextLine()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new ParsingError(ParsingError.Errors.BadSignature);i.state="HEADER"}for(var s=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(s?s=!1:n=collectNextLine(),i.state){case"HEADER":/:/.test(n)?parseHeader(n):n||(i.state="ID");continue;case"NOTE":n||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){i.state="NOTE";break}if(!n)continue;i.cue=new(i.vttjs.VTTCue||i.window.VTTCue)(0,0,"");try{i.cue.align="center"}catch(e){i.cue.align="middle"}if(i.state="CUE",-1===n.indexOf("--\x3e")){i.cue.id=n;continue}case"CUE":try{parseCue(n,i.cue,i.regionList)}catch(e){i.reportOrThrowError(e),i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(s=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=n.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":n||(i.state="ID");continue}}}catch(e){i.reportOrThrowError(e),"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},"flush":function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new ParsingError(ParsingError.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}},e.exports=WebVTT},function(e,i){var n={"":1,"lr":1,"rl":1},a={"start":1,"center":1,"end":1,"left":1,"right":1,"auto":1,"line-left":1,"line-right":1};function findAlignSetting(e){return"string"==typeof e&&(!!a[e.toLowerCase()]&&e.toLowerCase())}function VTTCue(e,i,a){this.hasBeenReset=!1;var s="",o=!1,u=e,l=i,c=a,h=null,f="",m=!0,g="auto",v="start",y="auto",_="auto",T=100,b="center";Object.defineProperties(this,{"id":{"enumerable":!0,"get":function(){return s},"set":function(e){s=""+e}},"pauseOnExit":{"enumerable":!0,"get":function(){return o},"set":function(e){o=!!e}},"startTime":{"enumerable":!0,"get":function(){return u},"set":function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");u=e,this.hasBeenReset=!0}},"endTime":{"enumerable":!0,"get":function(){return l},"set":function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}},"text":{"enumerable":!0,"get":function(){return c},"set":function(e){c=""+e,this.hasBeenReset=!0}},"region":{"enumerable":!0,"get":function(){return h},"set":function(e){h=e,this.hasBeenReset=!0}},"vertical":{"enumerable":!0,"get":function(){return f},"set":function(e){var i=function findDirectionSetting(e){return"string"==typeof e&&(!!n[e.toLowerCase()]&&e.toLowerCase())}(e);if(!1===i)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");f=i,this.hasBeenReset=!0}},"snapToLines":{"enumerable":!0,"get":function(){return m},"set":function(e){m=!!e,this.hasBeenReset=!0}},"line":{"enumerable":!0,"get":function(){return g},"set":function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}},"lineAlign":{"enumerable":!0,"get":function(){return v},"set":function(e){var i=findAlignSetting(e);i?(v=i,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},"position":{"enumerable":!0,"get":function(){return y},"set":function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}},"positionAlign":{"enumerable":!0,"get":function(){return _},"set":function(e){var i=findAlignSetting(e);i?(_=i,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},"size":{"enumerable":!0,"get":function(){return T},"set":function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");T=e,this.hasBeenReset=!0}},"align":{"enumerable":!0,"get":function(){return b},"set":function(e){var i=findAlignSetting(e);if(!i)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");b=i,this.hasBeenReset=!0}}}),this.displayState=void 0}VTTCue.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=VTTCue},function(e,i){var n={"":!0,"up":!0};function isValidPercentValue(e){return"number"==typeof e&&e>=0&&e<=100}e.exports=function VTTRegion(){var e=100,i=3,a=0,s=100,o=0,u=100,l="";Object.defineProperties(this,{"width":{"enumerable":!0,"get":function(){return e},"set":function(i){if(!isValidPercentValue(i))throw new Error("Width must be between 0 and 100.");e=i}},"lines":{"enumerable":!0,"get":function(){return i},"set":function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");i=e}},"regionAnchorY":{"enumerable":!0,"get":function(){return s},"set":function(e){if(!isValidPercentValue(e))throw new Error("RegionAnchorX must be between 0 and 100.");s=e}},"regionAnchorX":{"enumerable":!0,"get":function(){return a},"set":function(e){if(!isValidPercentValue(e))throw new Error("RegionAnchorY must be between 0 and 100.");a=e}},"viewportAnchorY":{"enumerable":!0,"get":function(){return u},"set":function(e){if(!isValidPercentValue(e))throw new Error("ViewportAnchorY must be between 0 and 100.");u=e}},"viewportAnchorX":{"enumerable":!0,"get":function(){return o},"set":function(e){if(!isValidPercentValue(e))throw new Error("ViewportAnchorX must be between 0 and 100.");o=e}},"scroll":{"enumerable":!0,"get":function(){return l},"set":function(e){var i=function findScrollSetting(e){return"string"==typeof e&&(!!n[e.toLowerCase()]&&e.toLowerCase())}(e);!1===i?console.warn("Scroll: an invalid or illegal string was specified."):l=i}}})}},function(e,i,n){var a=n(14);e.exports=function _inherits(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{"constructor":{"value":e,"writable":!0,"configurable":!0}}),i&&a(e,i)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,i,n){var a,s,o,u,l;a=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,s=/^([^\/?#]*)(.*)$/,o=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={"buildAbsoluteURL":function(e,i,n){if(n=n||{},e=e.trim(),!(i=i.trim())){if(!n.alwaysNormalize)return e;var a=l.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return a.path=l.normalizePath(a.path),l.buildURLFromParts(a)}var o=l.parseURL(i);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return n.alwaysNormalize?(o.path=l.normalizePath(o.path),l.buildURLFromParts(o)):i;var u=l.parseURL(e);if(!u)throw new Error("Error trying to parse base URL.");if(!u.netLoc&&u.path&&"/"!==u.path[0]){var c=s.exec(u.path);u.netLoc=c[1],u.path=c[2]}u.netLoc&&!u.path&&(u.path="/");var h={"scheme":u.scheme,"netLoc":o.netLoc,"path":null,"params":o.params,"query":o.query,"fragment":o.fragment};if(!o.netLoc&&(h.netLoc=u.netLoc,"/"!==o.path[0]))if(o.path){var f=u.path,m=f.substring(0,f.lastIndexOf("/")+1)+o.path;h.path=l.normalizePath(m)}else h.path=u.path,o.params||(h.params=u.params,o.query||(h.query=u.query));return null===h.path&&(h.path=n.alwaysNormalize?l.normalizePath(o.path):o.path),l.buildURLFromParts(h)},"parseURL":function(e){var i=a.exec(e);return i?{"scheme":i[1]||"","netLoc":i[2]||"","path":i[3]||"","params":i[4]||"","query":i[5]||"","fragment":i[6]||""}:null},"normalizePath":function(e){for(e=e.split("").reverse().join("").replace(o,"");e.length!==(e=e.replace(u,"")).length;);return e.split("").reverse().join("")},"buildURLFromParts":function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=l},function(e,i,n){"use strict";var a=function(){function Stream(){this.listeners={}}var e=Stream.prototype;return e.on=function on(e,i){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(i)},e.off=function off(e,i){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(i);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(n,1),n>-1},e.trigger=function trigger(e){var i=this.listeners[e];if(i)if(2===arguments.length)for(var n=i.length,a=0;a<n;++a)i[a].call(this,arguments[1]);else for(var s=Array.prototype.slice.call(arguments,1),o=i.length,u=0;u<o;++u)i[u].apply(this,s)},e.dispose=function dispose(){this.listeners={}},e.pipe=function pipe(e){this.on("data",(function(i){e.push(i)}))},Stream}();e.exports=a},function(e,i,n){"use strict";(function(e){var a=n(27),s=n(124),o=n(125);function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,i){if(kMaxLength()<i)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(i)).__proto__=Buffer.prototype:(null===e&&(e=new Buffer(i)),e.length=i),e}function Buffer(e,i,n){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(e,i,n);if("number"==typeof e){if("string"==typeof i)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}return from(this,e,i,n)}function from(e,i,n,a){if("number"==typeof i)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer?function fromArrayBuffer(e,i,n,a){if(i.byteLength,n<0||i.byteLength<n)throw new RangeError("'offset' is out of bounds");if(i.byteLength<n+(a||0))throw new RangeError("'length' is out of bounds");i=void 0===n&&void 0===a?new Uint8Array(i):void 0===a?new Uint8Array(i,n):new Uint8Array(i,n,a);Buffer.TYPED_ARRAY_SUPPORT?(e=i).__proto__=Buffer.prototype:e=fromArrayLike(e,i);return e}(e,i,n,a):"string"==typeof i?function fromString(e,i,n){"string"==typeof n&&""!==n||(n="utf8");if(!Buffer.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var a=0|byteLength(i,n),s=(e=createBuffer(e,a)).write(i,n);s!==a&&(e=e.slice(0,s));return e}(e,i,n):function fromObject(e,i){if(Buffer.isBuffer(i)){var n=0|checked(i.length);return 0===(e=createBuffer(e,n)).length||i.copy(e,0,0,n),e}if(i){if("undefined"!=typeof ArrayBuffer&&i.buffer instanceof ArrayBuffer||"length"in i)return"number"!=typeof i.length||function isnan(e){return e!=e}(i.length)?createBuffer(e,0):fromArrayLike(e,i);if("Buffer"===i.type&&o(i.data))return fromArrayLike(e,i.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,i)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(e,i){if(assertSize(i),e=createBuffer(e,i<0?0:0|checked(i)),!Buffer.TYPED_ARRAY_SUPPORT)for(var n=0;n<i;++n)e[n]=0;return e}function fromArrayLike(e,i){var n=i.length<0?0:0|checked(i.length);e=createBuffer(e,n);for(var a=0;a<n;a+=1)e[a]=255&i[a];return e}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function byteLength(e,i){if(Buffer.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var a=!1;;)switch(i){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return base64ToBytes(e).length;default:if(a)return utf8ToBytes(e).length;i=(""+i).toLowerCase(),a=!0}}function slowToString(e,i,n){var a=!1;if((void 0===i||i<0)&&(i=0),i>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(i>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,i,n);case"utf8":case"utf-8":return utf8Slice(this,i,n);case"ascii":return asciiSlice(this,i,n);case"latin1":case"binary":return latin1Slice(this,i,n);case"base64":return base64Slice(this,i,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,i,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function swap(e,i,n){var a=e[i];e[i]=e[n],e[n]=a}function bidirectionalIndexOf(e,i,n,a,s){if(0===e.length)return-1;if("string"==typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof i&&(i=Buffer.from(i,a)),Buffer.isBuffer(i))return 0===i.length?-1:arrayIndexOf(e,i,n,a,s);if("number"==typeof i)return i&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,i,n):Uint8Array.prototype.lastIndexOf.call(e,i,n):arrayIndexOf(e,[i],n,a,s);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,i,n,a,s){var o,u=1,l=e.length,c=i.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||i.length<2)return-1;u=2,l/=2,c/=2,n/=2}function read(e,i){return 1===u?e[i]:e.readUInt16BE(i*u)}if(s){var h=-1;for(o=n;o<l;o++)if(read(e,o)===read(i,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===c)return h*u}else-1!==h&&(o-=o-h),h=-1}else for(n+c>l&&(n=l-c),o=n;o>=0;o--){for(var f=!0,m=0;m<c;m++)if(read(e,o+m)!==read(i,m)){f=!1;break}if(f)return o}return-1}function hexWrite(e,i,n,a){n=Number(n)||0;var s=e.length-n;a?(a=Number(a))>s&&(a=s):a=s;var o=i.length;if(o%2!=0)throw new TypeError("Invalid hex string");a>o/2&&(a=o/2);for(var u=0;u<a;++u){var l=parseInt(i.substr(2*u,2),16);if(isNaN(l))return u;e[n+u]=l}return u}function utf8Write(e,i,n,a){return blitBuffer(utf8ToBytes(i,e.length-n),e,n,a)}function asciiWrite(e,i,n,a){return blitBuffer(function asciiToBytes(e){for(var i=[],n=0;n<e.length;++n)i.push(255&e.charCodeAt(n));return i}(i),e,n,a)}function latin1Write(e,i,n,a){return asciiWrite(e,i,n,a)}function base64Write(e,i,n,a){return blitBuffer(base64ToBytes(i),e,n,a)}function ucs2Write(e,i,n,a){return blitBuffer(function utf16leToBytes(e,i){for(var n,a,s,o=[],u=0;u<e.length&&!((i-=2)<0);++u)n=e.charCodeAt(u),a=n>>8,s=n%256,o.push(s),o.push(a);return o}(i,e.length-n),e,n,a)}function base64Slice(e,i,n){return 0===i&&n===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(i,n))}function utf8Slice(e,i,n){n=Math.min(e.length,n);for(var a=[],s=i;s<n;){var o,u,l,c,h=e[s],f=null,m=h>239?4:h>223?3:h>191?2:1;if(s+m<=n)switch(m){case 1:h<128&&(f=h);break;case 2:128==(192&(o=e[s+1]))&&(c=(31&h)<<6|63&o)>127&&(f=c);break;case 3:o=e[s+1],u=e[s+2],128==(192&o)&&128==(192&u)&&(c=(15&h)<<12|(63&o)<<6|63&u)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:o=e[s+1],u=e[s+2],l=e[s+3],128==(192&o)&&128==(192&u)&&128==(192&l)&&(c=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&l)>65535&&c<1114112&&(f=c)}null===f?(f=65533,m=1):f>65535&&(f-=65536,a.push(f>>>10&1023|55296),f=56320|1023&f),a.push(f),s+=m}return function decodeCodePointsArray(e){var i=e.length;if(i<=4096)return String.fromCharCode.apply(String,e);var n="",a=0;for(;a<i;)n+=String.fromCharCode.apply(String,e.slice(a,a+=4096));return n}(a)}i.Buffer=Buffer,i.SlowBuffer=function SlowBuffer(e){+e!=e&&(e=0);return Buffer.alloc(+e)},i.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function typedArraySupport(){try{var e=new Uint8Array(1);return e.__proto__={"__proto__":Uint8Array.prototype,"foo":function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),i.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(e){return e.__proto__=Buffer.prototype,e},Buffer.from=function(e,i,n){return from(null,e,i,n)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{"value":null,"configurable":!0})),Buffer.alloc=function(e,i,n){return function alloc(e,i,n,a){return assertSize(i),i<=0?createBuffer(e,i):void 0!==n?"string"==typeof a?createBuffer(e,i).fill(n,a):createBuffer(e,i).fill(n):createBuffer(e,i)}(null,e,i,n)},Buffer.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer.isBuffer=function isBuffer(e){return!(null==e||!e._isBuffer)},Buffer.compare=function compare(e,i){if(!Buffer.isBuffer(e)||!Buffer.isBuffer(i))throw new TypeError("Arguments must be Buffers");if(e===i)return 0;for(var n=e.length,a=i.length,s=0,o=Math.min(n,a);s<o;++s)if(e[s]!==i[s]){n=e[s],a=i[s];break}return n<a?-1:a<n?1:0},Buffer.isEncoding=function isEncoding(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function concat(e,i){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);var n;if(void 0===i)for(i=0,n=0;n<e.length;++n)i+=e[n].length;var a=Buffer.allocUnsafe(i),s=0;for(n=0;n<e.length;++n){var u=e[n];if(!Buffer.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(a,s),s+=u.length}return a},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function swap16(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<e;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function swap32(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<e;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function swap64(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<e;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function toString(){var e=0|this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.equals=function equals(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function inspect(){var e="",n=i.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},Buffer.prototype.compare=function compare(e,i,n,a,s){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===i&&(i=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===s&&(s=this.length),i<0||n>e.length||a<0||s>this.length)throw new RangeError("out of range index");if(a>=s&&i>=n)return 0;if(a>=s)return-1;if(i>=n)return 1;if(this===e)return 0;for(var o=(s>>>=0)-(a>>>=0),u=(n>>>=0)-(i>>>=0),l=Math.min(o,u),c=this.slice(a,s),h=e.slice(i,n),f=0;f<l;++f)if(c[f]!==h[f]){o=c[f],u=h[f];break}return o<u?-1:u<o?1:0},Buffer.prototype.includes=function includes(e,i,n){return-1!==this.indexOf(e,i,n)},Buffer.prototype.indexOf=function indexOf(e,i,n){return bidirectionalIndexOf(this,e,i,n,!0)},Buffer.prototype.lastIndexOf=function lastIndexOf(e,i,n){return bidirectionalIndexOf(this,e,i,n,!1)},Buffer.prototype.write=function write(e,i,n,a){if(void 0===i)a="utf8",n=this.length,i=0;else if(void 0===n&&"string"==typeof i)a=i,n=this.length,i=0;else{if(!isFinite(i))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");i|=0,isFinite(n)?(n|=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}var s=this.length-i;if((void 0===n||n>s)&&(n=s),e.length>0&&(n<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var o=!1;;)switch(a){case"hex":return hexWrite(this,e,i,n);case"utf8":case"utf-8":return utf8Write(this,e,i,n);case"ascii":return asciiWrite(this,e,i,n);case"latin1":case"binary":return latin1Write(this,e,i,n);case"base64":return base64Write(this,e,i,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,i,n);default:if(o)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),o=!0}},Buffer.prototype.toJSON=function toJSON(){return{"type":"Buffer","data":Array.prototype.slice.call(this._arr||this,0)}};function asciiSlice(e,i,n){var a="";n=Math.min(e.length,n);for(var s=i;s<n;++s)a+=String.fromCharCode(127&e[s]);return a}function latin1Slice(e,i,n){var a="";n=Math.min(e.length,n);for(var s=i;s<n;++s)a+=String.fromCharCode(e[s]);return a}function hexSlice(e,i,n){var a=e.length;(!i||i<0)&&(i=0),(!n||n<0||n>a)&&(n=a);for(var s="",o=i;o<n;++o)s+=toHex(e[o]);return s}function utf16leSlice(e,i,n){for(var a=e.slice(i,n),s="",o=0;o<a.length;o+=2)s+=String.fromCharCode(a[o]+256*a[o+1]);return s}function checkOffset(e,i,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+i>n)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,i,n,a,s,o){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i>s||i<o)throw new RangeError('"value" argument is out of bounds');if(n+a>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,i,n,a){i<0&&(i=65535+i+1);for(var s=0,o=Math.min(e.length-n,2);s<o;++s)e[n+s]=(i&255<<8*(a?s:1-s))>>>8*(a?s:1-s)}function objectWriteUInt32(e,i,n,a){i<0&&(i=4294967295+i+1);for(var s=0,o=Math.min(e.length-n,4);s<o;++s)e[n+s]=i>>>8*(a?s:3-s)&255}function checkIEEE754(e,i,n,a,s,o){if(n+a>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function writeFloat(e,i,n,a,o){return o||checkIEEE754(e,0,n,4),s.write(e,i,n,a,23,4),n+4}function writeDouble(e,i,n,a,o){return o||checkIEEE754(e,0,n,8),s.write(e,i,n,a,52,8),n+8}Buffer.prototype.slice=function slice(e,i){var n,a=this.length;if((e=~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),(i=void 0===i?a:~~i)<0?(i+=a)<0&&(i=0):i>a&&(i=a),i<e&&(i=e),Buffer.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,i)).__proto__=Buffer.prototype;else{var s=i-e;n=new Buffer(s,void 0);for(var o=0;o<s;++o)n[o]=this[o+e]}return n},Buffer.prototype.readUIntLE=function readUIntLE(e,i,n){e|=0,i|=0,n||checkOffset(e,i,this.length);for(var a=this[e],s=1,o=0;++o<i&&(s*=256);)a+=this[e+o]*s;return a},Buffer.prototype.readUIntBE=function readUIntBE(e,i,n){e|=0,i|=0,n||checkOffset(e,i,this.length);for(var a=this[e+--i],s=1;i>0&&(s*=256);)a+=this[e+--i]*s;return a},Buffer.prototype.readUInt8=function readUInt8(e,i){return i||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function readUInt16LE(e,i){return i||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function readUInt16BE(e,i){return i||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function readUInt32LE(e,i){return i||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function readUInt32BE(e,i){return i||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function readIntLE(e,i,n){e|=0,i|=0,n||checkOffset(e,i,this.length);for(var a=this[e],s=1,o=0;++o<i&&(s*=256);)a+=this[e+o]*s;return a>=(s*=128)&&(a-=Math.pow(2,8*i)),a},Buffer.prototype.readIntBE=function readIntBE(e,i,n){e|=0,i|=0,n||checkOffset(e,i,this.length);for(var a=i,s=1,o=this[e+--a];a>0&&(s*=256);)o+=this[e+--a]*s;return o>=(s*=128)&&(o-=Math.pow(2,8*i)),o},Buffer.prototype.readInt8=function readInt8(e,i){return i||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer.prototype.readInt16LE=function readInt16LE(e,i){i||checkOffset(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},Buffer.prototype.readInt16BE=function readInt16BE(e,i){i||checkOffset(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},Buffer.prototype.readInt32LE=function readInt32LE(e,i){return i||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function readInt32BE(e,i){return i||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function readFloatLE(e,i){return i||checkOffset(e,4,this.length),s.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function readFloatBE(e,i){return i||checkOffset(e,4,this.length),s.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function readDoubleLE(e,i){return i||checkOffset(e,8,this.length),s.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function readDoubleBE(e,i){return i||checkOffset(e,8,this.length),s.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function writeUIntLE(e,i,n,a){(e=+e,i|=0,n|=0,a)||checkInt(this,e,i,n,Math.pow(2,8*n)-1,0);var s=1,o=0;for(this[i]=255&e;++o<n&&(s*=256);)this[i+o]=e/s&255;return i+n},Buffer.prototype.writeUIntBE=function writeUIntBE(e,i,n,a){(e=+e,i|=0,n|=0,a)||checkInt(this,e,i,n,Math.pow(2,8*n)-1,0);var s=n-1,o=1;for(this[i+s]=255&e;--s>=0&&(o*=256);)this[i+s]=e/o&255;return i+n},Buffer.prototype.writeUInt8=function writeUInt8(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[i]=255&e,i+1},Buffer.prototype.writeUInt16LE=function writeUInt16LE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[i]=255&e,this[i+1]=e>>>8):objectWriteUInt16(this,e,i,!0),i+2},Buffer.prototype.writeUInt16BE=function writeUInt16BE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[i]=e>>>8,this[i+1]=255&e):objectWriteUInt16(this,e,i,!1),i+2},Buffer.prototype.writeUInt32LE=function writeUInt32LE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[i+3]=e>>>24,this[i+2]=e>>>16,this[i+1]=e>>>8,this[i]=255&e):objectWriteUInt32(this,e,i,!0),i+4},Buffer.prototype.writeUInt32BE=function writeUInt32BE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[i]=e>>>24,this[i+1]=e>>>16,this[i+2]=e>>>8,this[i+3]=255&e):objectWriteUInt32(this,e,i,!1),i+4},Buffer.prototype.writeIntLE=function writeIntLE(e,i,n,a){if(e=+e,i|=0,!a){var s=Math.pow(2,8*n-1);checkInt(this,e,i,n,s-1,-s)}var o=0,u=1,l=0;for(this[i]=255&e;++o<n&&(u*=256);)e<0&&0===l&&0!==this[i+o-1]&&(l=1),this[i+o]=(e/u>>0)-l&255;return i+n},Buffer.prototype.writeIntBE=function writeIntBE(e,i,n,a){if(e=+e,i|=0,!a){var s=Math.pow(2,8*n-1);checkInt(this,e,i,n,s-1,-s)}var o=n-1,u=1,l=0;for(this[i+o]=255&e;--o>=0&&(u*=256);)e<0&&0===l&&0!==this[i+o+1]&&(l=1),this[i+o]=(e/u>>0)-l&255;return i+n},Buffer.prototype.writeInt8=function writeInt8(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[i]=255&e,i+1},Buffer.prototype.writeInt16LE=function writeInt16LE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[i]=255&e,this[i+1]=e>>>8):objectWriteUInt16(this,e,i,!0),i+2},Buffer.prototype.writeInt16BE=function writeInt16BE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[i]=e>>>8,this[i+1]=255&e):objectWriteUInt16(this,e,i,!1),i+2},Buffer.prototype.writeInt32LE=function writeInt32LE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[i]=255&e,this[i+1]=e>>>8,this[i+2]=e>>>16,this[i+3]=e>>>24):objectWriteUInt32(this,e,i,!0),i+4},Buffer.prototype.writeInt32BE=function writeInt32BE(e,i,n){return e=+e,i|=0,n||checkInt(this,e,i,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer.TYPED_ARRAY_SUPPORT?(this[i]=e>>>24,this[i+1]=e>>>16,this[i+2]=e>>>8,this[i+3]=255&e):objectWriteUInt32(this,e,i,!1),i+4},Buffer.prototype.writeFloatLE=function writeFloatLE(e,i,n){return writeFloat(this,e,i,!0,n)},Buffer.prototype.writeFloatBE=function writeFloatBE(e,i,n){return writeFloat(this,e,i,!1,n)},Buffer.prototype.writeDoubleLE=function writeDoubleLE(e,i,n){return writeDouble(this,e,i,!0,n)},Buffer.prototype.writeDoubleBE=function writeDoubleBE(e,i,n){return writeDouble(this,e,i,!1,n)},Buffer.prototype.copy=function copy(e,i,n,a){if(n||(n=0),a||0===a||(a=this.length),i>=e.length&&(i=e.length),i||(i=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===e.length||0===this.length)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-i<a-n&&(a=e.length-i+n);var s,o=a-n;if(this===e&&n<i&&i<a)for(s=o-1;s>=0;--s)e[s+i]=this[s+n];else if(o<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(s=0;s<o;++s)e[s+i]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),i);return o},Buffer.prototype.fill=function fill(e,i,n,a){if("string"==typeof e){if("string"==typeof i?(a=i,i=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),1===e.length){var s=e.charCodeAt(0);s<256&&(e=s)}if(void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!Buffer.isEncoding(a))throw new TypeError("Unknown encoding: "+a)}else"number"==typeof e&&(e&=255);if(i<0||this.length<i||this.length<n)throw new RangeError("Out of range index");if(n<=i)return this;var o;if(i>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=i;o<n;++o)this[o]=e;else{var u=Buffer.isBuffer(e)?e:utf8ToBytes(new Buffer(e,a).toString()),l=u.length;for(o=0;o<n-i;++o)this[o+i]=u[o%l]}return this};var u=/[^+\/0-9A-Za-z-_]/g;function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,i){var n;i=i||1/0;for(var a=e.length,s=null,o=[],u=0;u<a;++u){if((n=e.charCodeAt(u))>55295&&n<57344){if(!s){if(n>56319){(i-=3)>-1&&o.push(239,191,189);continue}if(u+1===a){(i-=3)>-1&&o.push(239,191,189);continue}s=n;continue}if(n<56320){(i-=3)>-1&&o.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(i-=3)>-1&&o.push(239,191,189);if(s=null,n<128){if((i-=1)<0)break;o.push(n)}else if(n<2048){if((i-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((i-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((i-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function base64ToBytes(e){return a.toByteArray(function base64clean(e){if((e=function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(u,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function blitBuffer(e,i,n,a){for(var s=0;s<a&&!(s+n>=i.length||s>=e.length);++s)i[s+n]=e[s];return s}}).call(this,n(26))},function(e,i){i.read=function(e,i,n,a,s){var o,u,l=8*s-a-1,c=(1<<l)-1,h=c>>1,f=-7,m=n?s-1:0,g=n?-1:1,v=e[i+m];for(m+=g,o=v&(1<<-f)-1,v>>=-f,f+=l;f>0;o=256*o+e[i+m],m+=g,f-=8);for(u=o&(1<<-f)-1,o>>=-f,f+=a;f>0;u=256*u+e[i+m],m+=g,f-=8);if(0===o)o=1-h;else{if(o===c)return u?NaN:1/0*(v?-1:1);u+=Math.pow(2,a),o-=h}return(v?-1:1)*u*Math.pow(2,o-a)},i.write=function(e,i,n,a,s,o){var u,l,c,h=8*o-s-1,f=(1<<h)-1,m=f>>1,g=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,v=a?0:o-1,y=a?1:-1,_=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(l=isNaN(i)?1:0,u=f):(u=Math.floor(Math.log(i)/Math.LN2),i*(c=Math.pow(2,-u))<1&&(u--,c*=2),(i+=u+m>=1?g/c:g*Math.pow(2,1-m))*c>=2&&(u++,c/=2),u+m>=f?(l=0,u=f):u+m>=1?(l=(i*c-1)*Math.pow(2,s),u+=m):(l=i*Math.pow(2,m-1)*Math.pow(2,s),u=0));s>=8;e[n+v]=255&l,v+=y,l/=256,s-=8);for(u=u<<s|l,h+=s;h>0;e[n+v]=255&u,v+=y,u/=256,h-=8);e[n+v-y]|=128*_}},function(e,i){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,i,n){"use strict";Object.defineProperty(i,"__esModule",{"value":!0});var a=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,s=/^application\/dash\+xml/i;i.simpleTypeFromSourceType=function simpleTypeFromSourceType(e){return a.test(e)?"hls":s.test(e)?"dash":"application/vnd.videojs.vhs+json"===e?"vhs-json":null}},function(e,i,n){function DOMParser(e){this.options=e||{"locator":{}}}function DOMHandler(){this.cdata=!1}function position(e,i){i.lineNumber=e.lineNumber,i.columnNumber=e.columnNumber}function _locator(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function _toString(e,i,n){return"string"==typeof e?e.substr(i,n):e.length>=i+n||i?new java.lang.String(e,i,n)+"":e}function appendElement(e,i){e.currentElement?e.currentElement.appendChild(i):e.doc.appendChild(i)}DOMParser.prototype.parseFromString=function(e,i){var n=this.options,s=new a,o=n.domBuilder||new DOMHandler,u=n.errorHandler,l=n.locator,c=n.xmlns||{},h={"lt":"<","gt":">","amp":"&","quot":'"',"apos":"'"};return l&&o.setDocumentLocator(l),s.errorHandler=function buildErrorHandler(e,i,n){if(!e){if(i instanceof DOMHandler)return i;e=i}var a={},s=e instanceof Function;function build(i){var o=e[i];!o&&s&&(o=2==e.length?function(n){e(i,n)}:e),a[i]=o&&function(e){o("[xmldom "+i+"]\t"+e+_locator(n))}||function(){}}return n=n||{},build("warning"),build("error"),build("fatalError"),a}(u,o,l),s.domBuilder=n.domBuilder||o,/\/x?html?$/.test(i)&&(h.nbsp=" ",h.copy="©",c[""]="http://www.w3.org/1999/xhtml"),c.xml=c.xml||"http://www.w3.org/XML/1998/namespace",e?s.parse(e,c,h):s.errorHandler.error("invalid doc source"),o.doc},DOMHandler.prototype={"startDocument":function(){this.doc=(new s).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},"startElement":function(e,i,n,a){var s=this.doc,o=s.createElementNS(e,n||i),u=a.length;appendElement(this,o),this.currentElement=o,this.locator&&position(this.locator,o);for(var l=0;l<u;l++){e=a.getURI(l);var c=a.getValue(l),h=(n=a.getQName(l),s.createAttributeNS(e,n));this.locator&&position(a.getLocator(l),h),h.value=h.nodeValue=c,o.setAttributeNode(h)}},"endElement":function(e,i,n){var a=this.currentElement;a.tagName;this.currentElement=a.parentNode},"startPrefixMapping":function(e,i){},"endPrefixMapping":function(e){},"processingInstruction":function(e,i){var n=this.doc.createProcessingInstruction(e,i);this.locator&&position(this.locator,n),appendElement(this,n)},"ignorableWhitespace":function(e,i,n){},"characters":function(e,i,n){if(e=_toString.apply(this,arguments)){if(this.cdata)var a=this.doc.createCDATASection(e);else a=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(a):/^\s*$/.test(e)&&this.doc.appendChild(a),this.locator&&position(this.locator,a)}},"skippedEntity":function(e){},"endDocument":function(){this.doc.normalize()},"setDocumentLocator":function(e){(this.locator=e)&&(e.lineNumber=0)},"comment":function(e,i,n){e=_toString.apply(this,arguments);var a=this.doc.createComment(e);this.locator&&position(this.locator,a),appendElement(this,a)},"startCDATA":function(){this.cdata=!0},"endCDATA":function(){this.cdata=!1},"startDTD":function(e,i,n){var a=this.doc.implementation;if(a&&a.createDocumentType){var s=a.createDocumentType(e,i,n);this.locator&&position(this.locator,s),appendElement(this,s)}},"warning":function(e){console.warn("[xmldom warning]\t"+e,_locator(this.locator))},"error":function(e){console.error("[xmldom error]\t"+e,_locator(this.locator))},"fatalError":function(e){throw console.error("[xmldom fatalError]\t"+e,_locator(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){DOMHandler.prototype[e]=function(){return null}}));var a=n(128).XMLReader,s=i.DOMImplementation=n(107).DOMImplementation;i.XMLSerializer=n(107).XMLSerializer,i.DOMParser=DOMParser},function(e,i){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,a=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),s=new RegExp("^"+n.source+a.source+"*(?::"+n.source+a.source+"*)?$");function XMLReader(){}function copyLocator(e,i){return i.lineNumber=e.lineNumber,i.columnNumber=e.columnNumber,i}function parseElementStartPart(e,i,n,a,s,o){for(var u,l=++i,c=0;;){var h=e.charAt(l);switch(h){case"=":if(1===c)u=e.slice(i,l),c=3;else{if(2!==c)throw new Error("attribute equal must after attrName");c=3}break;case"'":case'"':if(3===c||1===c){if(1===c&&(o.warning('attribute value must after "="'),u=e.slice(i,l)),i=l+1,!((l=e.indexOf(h,i))>0))throw new Error("attribute value no end '"+h+"' match");f=e.slice(i,l).replace(/&#?\w+;/g,s),n.add(u,f,i-1),c=5}else{if(4!=c)throw new Error('attribute value must after "="');f=e.slice(i,l).replace(/&#?\w+;/g,s),n.add(u,f,i),o.warning('attribute "'+u+'" missed start quot('+h+")!!"),i=l+1,c=5}break;case"/":switch(c){case 0:n.setTagName(e.slice(i,l));case 5:case 6:case 7:c=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),0==c&&n.setTagName(e.slice(i,l)),l;case">":switch(c){case 0:n.setTagName(e.slice(i,l));case 5:case 6:case 7:break;case 4:case 1:"/"===(f=e.slice(i,l)).slice(-1)&&(n.closed=!0,f=f.slice(0,-1));case 2:2===c&&(f=u),4==c?(o.warning('attribute "'+f+'" missed quot(")!!'),n.add(u,f.replace(/&#?\w+;/g,s),i)):("http://www.w3.org/1999/xhtml"===a[""]&&f.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),n.add(f,f,i));break;case 3:throw new Error("attribute value missed!!")}return l;case"":h=" ";default:if(h<=" ")switch(c){case 0:n.setTagName(e.slice(i,l)),c=6;break;case 1:u=e.slice(i,l),c=2;break;case 4:var f=e.slice(i,l).replace(/&#?\w+;/g,s);o.warning('attribute "'+f+'" missed quot(")!!'),n.add(u,f,i);case 5:c=6}else switch(c){case 2:n.tagName;"http://www.w3.org/1999/xhtml"===a[""]&&u.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+u+'" missed value!! "'+u+'" instead2!!'),n.add(u,u,i),i=l,c=1;break;case 5:o.warning('attribute space is required"'+u+'"!!');case 6:c=1,i=l;break;case 3:c=4,i=l;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}l++}}function appendElement(e,i,n){for(var a=e.tagName,s=null,o=e.length;o--;){var u=e[o],l=u.qName,c=u.value;if((g=l.indexOf(":"))>0)var h=u.prefix=l.slice(0,g),f=l.slice(g+1),m="xmlns"===h&&f;else f=l,h=null,m="xmlns"===l&&"";u.localName=f,!1!==m&&(null==s&&(s={},_copy(n,n={})),n[m]=s[m]=c,u.uri="http://www.w3.org/2000/xmlns/",i.startPrefixMapping(m,c))}for(o=e.length;o--;){(h=(u=e[o]).prefix)&&("xml"===h&&(u.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==h&&(u.uri=n[h||""]))}var g;(g=a.indexOf(":"))>0?(h=e.prefix=a.slice(0,g),f=e.localName=a.slice(g+1)):(h=null,f=e.localName=a);var v=e.uri=n[h||""];if(i.startElement(v,f,a,e),!e.closed)return e.currentNSMap=n,e.localNSMap=s,!0;if(i.endElement(v,f,a),s)for(h in s)i.endPrefixMapping(h)}function parseHtmlSpecialContent(e,i,n,a,s){if(/^(?:script|textarea)$/i.test(n)){var o=e.indexOf("</"+n+">",i),u=e.substring(i+1,o);if(/[&<]/.test(u))return/^script$/i.test(n)?(s.characters(u,0,u.length),o):(u=u.replace(/&#?\w+;/g,a),s.characters(u,0,u.length),o)}return i+1}function fixSelfClosed(e,i,n,a){var s=a[n];return null==s&&((s=e.lastIndexOf("</"+n+">"))<i&&(s=e.lastIndexOf("</"+n)),a[n]=s),s<i}function _copy(e,i){for(var n in e)i[n]=e[n]}function parseDCC(e,i,n,a){switch(e.charAt(i+2)){case"-":return"-"===e.charAt(i+3)?(s=e.indexOf("--\x3e",i+4))>i?(n.comment(e,i+4,s-i-4),s+3):(a.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(i+3,6)){var s=e.indexOf("]]>",i+9);return n.startCDATA(),n.characters(e,i+9,s-i-9),n.endCDATA(),s+3}var o=function split(e,i){var n,a=[],s=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;s.lastIndex=i,s.exec(e);for(;n=s.exec(e);)if(a.push(n),n[1])return a}(e,i),u=o.length;if(u>1&&/!doctype/i.test(o[0][0])){var l=o[1][0],c=u>3&&/^public$/i.test(o[2][0])&&o[3][0],h=u>4&&o[4][0],f=o[u-1];return n.startDTD(l,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),h&&h.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),f.index+f[0].length}}return-1}function parseInstruction(e,i,n){var a=e.indexOf("?>",i);if(a){var s=e.substring(i,a).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(s){s[0].length;return n.processingInstruction(s[1],s[2]),a+2}return-1}return-1}function ElementAttributes(e){}function _set_proto_(e,i){return e.__proto__=i,e}XMLReader.prototype={"parse":function(e,i,n){var a=this.domBuilder;a.startDocument(),_copy(i,i={}),function parse(e,i,n,a,s){function entityReplacer(e){var i=e.slice(1,-1);return i in n?n[i]:"#"===i.charAt(0)?function fixedFromCharCode(e){if(e>65535){var i=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(i,n)}return String.fromCharCode(e)}(parseInt(i.substr(1).replace("x","0x"))):(s.error("entity not found:"+e),e)}function appendText(i){if(i>m){var n=e.substring(m,i).replace(/&#?\w+;/g,entityReplacer);c&&position(m),a.characters(n,0,i-m),m=i}}function position(i,n){for(;i>=u&&(n=l.exec(e));)o=n.index,u=o+n[0].length,c.lineNumber++;c.columnNumber=i-o+1}var o=0,u=0,l=/.*(?:\r\n?|\n)|.*$/g,c=a.locator,h=[{"currentNSMap":i}],f={},m=0;for(;;){try{var g=e.indexOf("<",m);if(g<0){if(!e.substr(m).match(/^\s*$/)){var v=a.doc,y=v.createTextNode(e.substr(m));v.appendChild(y),a.currentElement=y}return}switch(g>m&&appendText(g),e.charAt(g+1)){case"/":var _=e.indexOf(">",g+3),T=e.substring(g+2,_),b=h.pop();_<0?(T=e.substring(g+2).replace(/[\s<].*/,""),s.error("end tag name: "+T+" is not complete:"+b.tagName),_=g+1+T.length):T.match(/\s</)&&(T=T.replace(/[\s<].*/,""),s.error("end tag name: "+T+" maybe not complete"),_=g+1+T.length);var S=b.localNSMap,C=b.tagName==T;if(C||b.tagName&&b.tagName.toLowerCase()==T.toLowerCase()){if(a.endElement(b.uri,b.localName,T),S)for(var k in S)a.endPrefixMapping(k);C||s.fatalError("end tag name: "+T+" is not match the current start tagName:"+b.tagName)}else h.push(b);_++;break;case"?":c&&position(g),_=parseInstruction(e,g,a);break;case"!":c&&position(g),_=parseDCC(e,g,a,s);break;default:c&&position(g);var E=new ElementAttributes,w=h[h.length-1].currentNSMap,P=(_=parseElementStartPart(e,g,E,w,entityReplacer,s),E.length);if(!E.closed&&fixSelfClosed(e,_,E.tagName,f)&&(E.closed=!0,n.nbsp||s.warning("unclosed xml attribute")),c&&P){for(var I=copyLocator(c,{}),x=0;x<P;x++){var A=E[x];position(A.offset),A.locator=copyLocator(c,{})}a.locator=I,appendElement(E,a,w)&&h.push(E),a.locator=c}else appendElement(E,a,w)&&h.push(E);"http://www.w3.org/1999/xhtml"!==E.uri||E.closed?_++:_=parseHtmlSpecialContent(e,_,E.tagName,entityReplacer,a)}}catch(e){s.error("element parse error: "+e),_=-1}_>m?m=_:appendText(Math.max(g,m)+1)}}(e,i,n,a,this.errorHandler),a.endDocument()}},ElementAttributes.prototype={"setTagName":function(e){if(!s.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},"add":function(e,i,n){if(!s.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={"qName":e,"value":i,"offset":n}},"length":0,"getLocalName":function(e){return this[e].localName},"getLocator":function(e){return this[e].locator},"getQName":function(e){return this[e].qName},"getURI":function(e){return this[e].uri},"getValue":function(e){return this[e].value}},_set_proto_({},_set_proto_.prototype)instanceof _set_proto_||(_set_proto_=function(e,i){function p(){}for(i in p.prototype=i,p=new p,e)p[i]=e[i];return p}),i.XMLReader=XMLReader},function(e,i){var n=Math.pow(2,32);e.exports=function(e){var i=new DataView(e.buffer,e.byteOffset,e.byteLength),a={"version":e[0],"flags":new Uint8Array(e.subarray(1,4)),"references":[],"referenceId":i.getUint32(4),"timescale":i.getUint32(8)},s=12;0===a.version?(a.earliestPresentationTime=i.getUint32(s),a.firstOffset=i.getUint32(s+4),s+=8):(a.earliestPresentationTime=i.getUint32(s)*n+i.getUint32(s+4),a.firstOffset=i.getUint32(s+8)*n+i.getUint32(s+12),s+=16),s+=2;var o=i.getUint16(s);for(s+=2;o>0;s+=12,o--)a.references.push({"referenceType":(128&e[s])>>>7,"referencedSize":2147483647&i.getUint32(s),"subsegmentDuration":i.getUint32(s+4),"startsWithSap":!!(128&e[s+8]),"sapType":(112&e[s+8])>>>4,"sapDeltaTime":268435455&i.getUint32(s+8)});return a}},function(e,i,n){"use strict";Object.defineProperty(i,"__esModule",{"value":!0});var a=function toUint8(e){return e instanceof Uint8Array?e:new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0)},s=function bytesToString(e){if(!e)return"";e=Array.prototype.slice.call(e);var i=String.fromCharCode.apply(null,a(e));try{return decodeURIComponent(escape(i))}catch(e){}return i},o=function id3Size(e,i){void 0===i&&(i=0);var n=(e=a(e))[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9];return(16&e[i+5])>>4?n+20:n+10},u=function getId3Offset(e,i){return void 0===i&&(i=0),(e=a(e)).length-i<10||"ID3"!==s(e.subarray(i,i+3))?i:getId3Offset(e,i+=o(e,i))},l={"aac":function aac(e){var i=u(e);return e.length>=i+2&&255==(255&e[i])&&224==(224&e[i+1])&&16==(22&e[i+1])},"mp3":function mp3(e){var i=u(e);return e.length>=i+2&&255==(255&e[i])&&224==(224&e[i+1])&&2==(6&e[i+1])},"webm":function webm(e){return e.length>=4&&26==(255&e[0])&&69==(255&e[1])&&223==(255&e[2])&&163==(255&e[3])},"mp4":function mp4(e){return e.length>=8&&/^(f|s)typ$/.test(s(e.subarray(4,8)))&&!/^ftyp3g$/.test(s(e.subarray(4,10)))},"3gp":function gp(e){return e.length>=10&&/^ftyp3g$/.test(s(e.subarray(4,10)))},"ts":function ts(e){if(e.length<189&&e.length>=1)return 71===e[0];for(var i=0;i+188<e.length&&i<188;){if(71===e[i]&&71===e[i+188])return!0;i+=1}return!1},"flac":function flac(e){return e.length>=4&&/^fLaC$/.test(s(e.subarray(0,4)))},"ogg":function ogg(e){return e.length>=4&&/^OggS$/.test(s(e.subarray(0,4)))}},c=Object.keys(l).filter((function(e){return"ts"!==e})).concat("ts");c.forEach((function(e){var i=l[e];l[e]=function(e){return i(a(e))}}));i.detectContainerForBytes=function detectContainerForBytes(e){e=a(e);for(var i=0;i<c.length;i++){var n=c[i];if(l[n](e))return n}return""},i.getId3Offset=u,i.id3Size=o,i.isLikely=l,i.isLikelyFmp4MediaSegment=function isLikelyFmp4MediaSegment(e){e=a(e);for(var i=0;i<e.length;){var n=(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])>>>0;if("moof"===s(e.subarray(i+4,i+8)))return!0;0===n||n+i>e.length?i=e.length:i+=n}return!1}},function(e,i,n){"use strict";Object.defineProperty(i,"__esModule",{"value":!0});var a=function toUint8(e){return e instanceof Uint8Array?e:new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0)};i.bytesToString=function bytesToString(e){if(!e)return"";e=Array.prototype.slice.call(e);var i=String.fromCharCode.apply(null,a(e));try{return decodeURIComponent(escape(i))}catch(e){}return i},i.concatTypedArrays=function concatTypedArrays(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];var s=i.reduce((function(e,i){return e+=i&&(i.byteLength||i.length)||0}),0),o=new Uint8Array(s),u=0;return i.forEach((function(e){e=a(e),o.set(e,u),u+=e.byteLength})),o},i.isTypedArray=function isTypedArray(e){return ArrayBuffer.isView(e)},i.stringToBytes=function stringToBytes(e,i){void 0===i&&(i=!1);return"string"!=typeof e&&e&&"function"==typeof e.toString&&(e=e.toString()),"string"!=typeof e?[]:(i||(e=unescape(encodeURIComponent(e))),e.split("").map((function(e){return 255&e.charCodeAt(0)})))},i.toUint8=a},function(e,i,n){"use strict";var a=n(108),s=n(133).handleRollover,o={};o.ts=n(135),o.aac=n(136);var u=n(109).ONE_SECOND_IN_TS,parseAudioPes_=function(e,i,n){for(var a,s,u,l,c=0,h=188,f=!1;h<=e.byteLength;)if(71!==e[c]||71!==e[h]&&h!==e.byteLength)c++,h++;else{switch(a=e.subarray(c,h),o.ts.parseType(a,i.pid)){case"pes":s=o.ts.parsePesType(a,i.table),u=o.ts.parsePayloadUnitStartIndicator(a),"audio"===s&&u&&(l=o.ts.parsePesTime(a))&&(l.type="audio",n.audio.push(l),f=!0)}if(f)break;c+=188,h+=188}for(c=(h=e.byteLength)-188,f=!1;c>=0;)if(71!==e[c]||71!==e[h]&&h!==e.byteLength)c--,h--;else{switch(a=e.subarray(c,h),o.ts.parseType(a,i.pid)){case"pes":s=o.ts.parsePesType(a,i.table),u=o.ts.parsePayloadUnitStartIndicator(a),"audio"===s&&u&&(l=o.ts.parsePesTime(a))&&(l.type="audio",n.audio.push(l),f=!0)}if(f)break;c-=188,h-=188}},parseVideoPes_=function(e,i,n){for(var a,s,u,l,c,h,f,m=0,g=188,v=!1,y={"data":[],"size":0};g<e.byteLength;)if(71!==e[m]||71!==e[g])m++,g++;else{switch(a=e.subarray(m,g),o.ts.parseType(a,i.pid)){case"pes":if(s=o.ts.parsePesType(a,i.table),u=o.ts.parsePayloadUnitStartIndicator(a),"video"===s&&(u&&!v&&(l=o.ts.parsePesTime(a))&&(l.type="video",n.video.push(l),v=!0),!n.firstKeyFrame)){if(u&&0!==y.size){for(c=new Uint8Array(y.size),h=0;y.data.length;)f=y.data.shift(),c.set(f,h),h+=f.byteLength;if(o.ts.videoPacketContainsKeyFrame(c)){var _=o.ts.parsePesTime(c);_?(n.firstKeyFrame=_,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}y.size=0}y.data.push(a),y.size+=a.byteLength}}if(v&&n.firstKeyFrame)break;m+=188,g+=188}for(m=(g=e.byteLength)-188,v=!1;m>=0;)if(71!==e[m]||71!==e[g])m--,g--;else{switch(a=e.subarray(m,g),o.ts.parseType(a,i.pid)){case"pes":s=o.ts.parsePesType(a,i.table),u=o.ts.parsePayloadUnitStartIndicator(a),"video"===s&&u&&(l=o.ts.parsePesTime(a))&&(l.type="video",n.video.push(l),v=!0)}if(v)break;m-=188,g-=188}},inspectTs_=function(e){var i={"pid":null,"table":null},n={};for(var s in function(e,i){for(var n,a=0,s=188;s<e.byteLength;)if(71!==e[a]||71!==e[s])a++,s++;else{switch(n=e.subarray(a,s),o.ts.parseType(n,i.pid)){case"pat":i.pid||(i.pid=o.ts.parsePat(n));break;case"pmt":i.table||(i.table=o.ts.parsePmt(n))}if(i.pid&&i.table)return;a+=188,s+=188}}(e,i),i.table){if(i.table.hasOwnProperty(s))switch(i.table[s]){case a.H264_STREAM_TYPE:n.video=[],parseVideoPes_(e,i,n),0===n.video.length&&delete n.video;break;case a.ADTS_STREAM_TYPE:n.audio=[],parseAudioPes_(e,i,n),0===n.audio.length&&delete n.audio}}return n};e.exports={"inspect":function(e,i){var n;return(n=o.aac.isLikelyAacData(e)?function(e){for(var i,n=!1,a=0,s=null,l=null,c=0,h=0;e.length-h>=3;){switch(o.aac.parseType(e,h)){case"timed-metadata":if(e.length-h<10){n=!0;break}if((c=o.aac.parseId3TagSize(e,h))>e.length){n=!0;break}null===l&&(i=e.subarray(h,h+c),l=o.aac.parseAacTimestamp(i)),h+=c;break;case"audio":if(e.length-h<7){n=!0;break}if((c=o.aac.parseAdtsSize(e,h))>e.length){n=!0;break}null===s&&(i=e.subarray(h,h+c),s=o.aac.parseSampleRate(i)),a++,h+=c;break;default:h++}if(n)return null}if(null===s||null===l)return null;var f=u/s;return{"audio":[{"type":"audio","dts":l,"pts":l},{"type":"audio","dts":l+1024*a*f,"pts":l+1024*a*f}]}}(e):inspectTs_(e))&&(n.audio||n.video)?(function(e,i){if(e.audio&&e.audio.length){var n=i;void 0===n&&(n=e.audio[0].dts),e.audio.forEach((function(e){e.dts=s(e.dts,n),e.pts=s(e.pts,n),e.dtsTime=e.dts/u,e.ptsTime=e.pts/u}))}if(e.video&&e.video.length){var a=i;if(void 0===a&&(a=e.video[0].dts),e.video.forEach((function(e){e.dts=s(e.dts,a),e.pts=s(e.pts,a),e.dtsTime=e.dts/u,e.ptsTime=e.pts/u})),e.firstKeyFrame){var o=e.firstKeyFrame;o.dts=s(o.dts,a),o.pts=s(o.pts,a),o.dtsTime=o.dts/u,o.ptsTime=o.dts/u}}}(n,i),n):null},"parseAudioPes_":parseAudioPes_}},function(e,i,n){"use strict";var a=n(134),handleRollover=function(e,i){var n=1;for(e>i&&(n=-1);Math.abs(i-e)>4294967296;)e+=8589934592*n;return e},TimestampRolloverStream=function(e){var i,n;TimestampRolloverStream.prototype.init.call(this),this.type_=e||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===n&&(n=e.dts),e.dts=handleRollover(e.dts,n),e.pts=handleRollover(e.pts,n),i=e.dts,this.trigger("data",e))},this.flush=function(){n=i,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){n=void 0,i=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};TimestampRolloverStream.prototype=new a,e.exports={"TimestampRolloverStream":TimestampRolloverStream,"handleRollover":handleRollover}},function(e,i,n){"use strict";var Stream=function(){this.init=function(){var e={};this.on=function(i,n){e[i]||(e[i]=[]),e[i]=e[i].concat(n)},this.off=function(i,n){var a;return!!e[i]&&(a=e[i].indexOf(n),e[i]=e[i].slice(),e[i].splice(a,1),a>-1)},this.trigger=function(i){var n,a,s,o;if(n=e[i])if(2===arguments.length)for(s=n.length,a=0;a<s;++a)n[a].call(this,arguments[1]);else{for(o=[],a=arguments.length,a=1;a<arguments.length;++a)o.push(arguments[a]);for(s=n.length,a=0;a<s;++a)n[a].apply(this,o)}},this.dispose=function(){e={}}}};Stream.prototype.pipe=function(e){return this.on("data",(function(i){e.push(i)})),this.on("done",(function(i){e.flush(i)})),this.on("partialdone",(function(i){e.partialFlush(i)})),this.on("endedtimeline",(function(i){e.endTimeline(i)})),this.on("reset",(function(i){e.reset(i)})),e},Stream.prototype.push=function(e){this.trigger("data",e)},Stream.prototype.flush=function(e){this.trigger("done",e)},Stream.prototype.partialFlush=function(e){this.trigger("partialdone",e)},Stream.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},Stream.prototype.reset=function(e){this.trigger("reset",e)},e.exports=Stream},function(e,i,n){"use strict";var a=n(108),parsePid=function(e){var i=31&e[1];return i<<=8,i|=e[2]},parsePayloadUnitStartIndicator=function(e){return!!(64&e[1])},parseAdaptionField=function(e){var i=0;return(48&e[3])>>>4>1&&(i+=e[4]+1),i},parseNalUnitType=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};e.exports={"parseType":function(e,i){var n=parsePid(e);return 0===n?"pat":n===i?"pmt":i?"pes":null},"parsePat":function(e){var i=parsePayloadUnitStartIndicator(e),n=4+parseAdaptionField(e);return i&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},"parsePmt":function(e){var i={},n=parsePayloadUnitStartIndicator(e),a=4+parseAdaptionField(e);if(n&&(a+=e[a]+1),1&e[a+5]){var s;s=3+((15&e[a+1])<<8|e[a+2])-4;for(var o=12+((15&e[a+10])<<8|e[a+11]);o<s;){var u=a+o;i[(31&e[u+1])<<8|e[u+2]]=e[u],o+=5+((15&e[u+3])<<8|e[u+4])}return i}},"parsePayloadUnitStartIndicator":parsePayloadUnitStartIndicator,"parsePesType":function(e,i){switch(i[parsePid(e)]){case a.H264_STREAM_TYPE:return"video";case a.ADTS_STREAM_TYPE:return"audio";case a.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},"parsePesTime":function(e){if(!parsePayloadUnitStartIndicator(e))return null;var i=4+parseAdaptionField(e);if(i>=e.byteLength)return null;var n,a=null;return 192&(n=e[i+7])&&((a={}).pts=(14&e[i+9])<<27|(255&e[i+10])<<20|(254&e[i+11])<<12|(255&e[i+12])<<5|(254&e[i+13])>>>3,a.pts*=4,a.pts+=(6&e[i+13])>>>1,a.dts=a.pts,64&n&&(a.dts=(14&e[i+14])<<27|(255&e[i+15])<<20|(254&e[i+16])<<12|(255&e[i+17])<<5|(254&e[i+18])>>>3,a.dts*=4,a.dts+=(6&e[i+18])>>>1)),a},"videoPacketContainsKeyFrame":function(e){for(var i=4+parseAdaptionField(e),n=e.subarray(i),a=0,s=0,o=!1;s<n.byteLength-3;s++)if(1===n[s+2]){a=s+5;break}for(;a<n.byteLength;)switch(n[a]){case 0:if(0!==n[a-1]){a+=2;break}if(0!==n[a-2]){a++;break}s+3!==a-2&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&n[s+3])&&(o=!0);do{a++}while(1!==n[a]&&a<n.length);s=a-2,a+=3;break;case 1:if(0!==n[a-1]||0!==n[a-2]){a+=3;break}"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&n[s+3])&&(o=!0),s=a-2,a+=3;break;default:a+=3}return n=n.subarray(s),a-=s,s=0,n&&n.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&n[s+3])&&(o=!0),o}}},function(e,i,n){"use strict";var a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],parseId3TagSize=function(e,i){var n=e[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9];return n=n>=0?n:0,(16&e[i+5])>>4?n+20:n+10},getId3Offset=function(e,i){return e.length-i<10||e[i]!=="I".charCodeAt(0)||e[i+1]!=="D".charCodeAt(0)||e[i+2]!=="3".charCodeAt(0)?i:(i+=parseId3TagSize(e,i),getId3Offset(e,i))},parseSyncSafeInteger=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]};e.exports={"isLikelyAacData":function(e){var i=getId3Offset(e,0);return e.length>=i+2&&255==(255&e[i])&&240==(240&e[i+1])&&16==(22&e[i+1])},"parseId3TagSize":parseId3TagSize,"parseAdtsSize":function(e,i){var n=(224&e[i+5])>>5,a=e[i+4]<<3;return 6144&e[i+3]|a|n},"parseType":function(e,i){return e[i]==="I".charCodeAt(0)&&e[i+1]==="D".charCodeAt(0)&&e[i+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[i]&&240==(240&e[i+1])?"audio":null},"parseSampleRate":function(e){for(var i=0;i+5<e.length;){if(255===e[i]&&240==(246&e[i+1]))return a[(60&e[i+2])>>>2];i++}return null},"parseAacTimestamp":function(e){var i,n,a;i=10,64&e[5]&&(i+=4,i+=parseSyncSafeInteger(e.subarray(10,14)));do{if((n=parseSyncSafeInteger(e.subarray(i+4,i+8)))<1)return null;if("PRIV"===String.fromCharCode(e[i],e[i+1],e[i+2],e[i+3])){a=e.subarray(i+10,i+n+10);for(var s=0;s<a.byteLength;s++)if(0===a[s]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,i,n){var a,s="";for(a=i;a<n;a++)s+="%"+("00"+e[a].toString(16)).slice(-2);return s}(a,0,s))){var o=a.subarray(s+1),u=(1&o[3])<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;return u*=4,u+=3&o[7]}break}}i+=10,i+=n}while(i<e.byteLength);return null}}},function(e,i,n){"use strict";var a,s,o,u,l,c,h=n(101).toUnsigned,f=n(101).toHexString,m=n(138),g=n(110),v=n(139),y=n(140),_=n(142);a=function(e){return m(e,["moov","trak"]).reduce((function(e,i){var n,a,s,o,u;return(n=m(i,["tkhd"])[0])?(a=n[0],o=h(n[s=0===a?12:20]<<24|n[s+1]<<16|n[s+2]<<8|n[s+3]),(u=m(i,["mdia","mdhd"])[0])?(s=0===(a=u[0])?12:20,e[o]=h(u[s]<<24|u[s+1]<<16|u[s+2]<<8|u[s+3]),e):null):null}),{})},s=function(e,i){var n,a,s;return n=m(i,["moof","traf"]),a=[].concat.apply([],n.map((function(i){return m(i,["tfhd"]).map((function(n){var a,s,o;return a=h(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),s=e[a]||9e4,(o="number"!=typeof(o=m(i,["tfdt"]).map((function(e){var i,n;return i=e[0],n=h(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===i&&(n*=Math.pow(2,32),n+=h(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n}))[0])||isNaN(o)?1/0:o)/s}))}))),s=Math.min.apply(null,a),isFinite(s)?s:0},o=function(e,i){var n,a=m(i,["moof","traf"]),s=0,o=0;if(a&&a.length){var u=m(a[0],["tfhd"])[0],l=m(a[0],["trun"])[0],c=m(a[0],["tfdt"])[0];if(u)n=v(u).trackId;if(c)s=_(c).baseMediaDecodeTime;if(l){var h=y(l);h.samples&&h.samples.length&&(o=h.samples[0].compositionTimeOffset||0)}}return(s+o)/(e[n]||9e4)},u=function(e){var i=m(e,["moov","trak"]),n=[];return i.forEach((function(e){var i=m(e,["mdia","hdlr"]),a=m(e,["tkhd"]);i.forEach((function(e,i){var s,o,u=g(e.subarray(8,12)),l=a[i];"vide"===u&&(o=0===(s=new DataView(l.buffer,l.byteOffset,l.byteLength)).getUint8(0)?s.getUint32(12):s.getUint32(20),n.push(o))}))})),n},c=function(e){var i=0===e[0]?12:20;return h(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])},l=function(e){var i=m(e,["moov","trak"]),n=[];return i.forEach((function(e){var i,a,s={},o=m(e,["tkhd"])[0];o&&(a=(i=new DataView(o.buffer,o.byteOffset,o.byteLength)).getUint8(0),s.id=0===a?i.getUint32(12):i.getUint32(20));var u=m(e,["mdia","hdlr"])[0];if(u){var l=g(u.subarray(8,12));s.type="vide"===l?"video":"soun"===l?"audio":l}var h=m(e,["mdia","minf","stbl","stsd"])[0];if(h){var v=h.subarray(8);s.codec=g(v.subarray(4,8));var y,_=m(v,[s.codec])[0];_&&(/^[a-z]vc[1-9]$/i.test(s.codec)?(y=_.subarray(78),"avcC"===g(y.subarray(4,8))&&y.length>11?(s.codec+=".",s.codec+=f(y[9]),s.codec+=f(y[10]),s.codec+=f(y[11])):s.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(s.codec)?(y=_.subarray(28),"esds"===g(y.subarray(4,8))&&y.length>20&&0!==y[19]?(s.codec+="."+f(y[19]),s.codec+="."+f(y[20]>>>2&63).replace(/^0/,"")):s.codec="mp4a.40.2"):s.codec=s.codec.toLowerCase())}var T=m(e,["mdia","mdhd"])[0];T&&(s.timescale=c(T)),n.push(s)})),n},e.exports={"findBox":m,"parseType":g,"timescale":a,"startTime":s,"compositionStartTime":o,"videoTrackIds":u,"tracks":l,"getTimescaleFromMediaHeader":c}},function(e,i,n){var a=n(101).toUnsigned,s=n(110),findBox=function(e,i){var n,o,u,l,c,h=[];if(!i.length)return null;for(n=0;n<e.byteLength;)o=a(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),u=s(e.subarray(n+4,n+8)),l=o>1?n+o:e.byteLength,u===i[0]&&(1===i.length?h.push(e.subarray(n+8,l)):(c=findBox(e.subarray(n+8,l),i.slice(1))).length&&(h=h.concat(c))),n=l;return h};e.exports=findBox},function(e,i){e.exports=function(e){var i,n=new DataView(e.buffer,e.byteOffset,e.byteLength),a={"version":e[0],"flags":new Uint8Array(e.subarray(1,4)),"trackId":n.getUint32(4)},s=1&a.flags[2],o=2&a.flags[2],u=8&a.flags[2],l=16&a.flags[2],c=32&a.flags[2],h=65536&a.flags[0],f=131072&a.flags[0];return i=8,s&&(i+=4,a.baseDataOffset=n.getUint32(12),i+=4),o&&(a.sampleDescriptionIndex=n.getUint32(i),i+=4),u&&(a.defaultSampleDuration=n.getUint32(i),i+=4),l&&(a.defaultSampleSize=n.getUint32(i),i+=4),c&&(a.defaultSampleFlags=n.getUint32(i)),h&&(a.durationIsEmpty=!0),!s&&f&&(a.baseDataOffsetIsMoof=!0),a}},function(e,i,n){var a=n(141);e.exports=function(e){var i,n={"version":e[0],"flags":new Uint8Array(e.subarray(1,4)),"samples":[]},s=new DataView(e.buffer,e.byteOffset,e.byteLength),o=1&n.flags[2],u=4&n.flags[2],l=1&n.flags[1],c=2&n.flags[1],h=4&n.flags[1],f=8&n.flags[1],m=s.getUint32(4),g=8;for(o&&(n.dataOffset=s.getInt32(g),g+=4),u&&m&&(i={"flags":a(e.subarray(g,g+4))},g+=4,l&&(i.duration=s.getUint32(g),g+=4),c&&(i.size=s.getUint32(g),g+=4),f&&(1===n.version?i.compositionTimeOffset=s.getInt32(g):i.compositionTimeOffset=s.getUint32(g),g+=4),n.samples.push(i),m--);m--;)i={},l&&(i.duration=s.getUint32(g),g+=4),c&&(i.size=s.getUint32(g),g+=4),h&&(i.flags=a(e.subarray(g,g+4)),g+=4),f&&(1===n.version?i.compositionTimeOffset=s.getInt32(g):i.compositionTimeOffset=s.getUint32(g),g+=4),n.samples.push(i);return n}},function(e,i){e.exports=function(e){return{"isLeading":(12&e[0])>>>2,"dependsOn":3&e[0],"isDependedOn":(192&e[1])>>>6,"hasRedundancy":(48&e[1])>>>4,"paddingValue":(14&e[1])>>>1,"isNonSyncSample":1&e[1],"degradationPriority":e[2]<<8|e[3]}}},function(e,i,n){var a=n(101).toUnsigned;e.exports=function(e){var i={"version":e[0],"flags":new Uint8Array(e.subarray(1,4)),"baseMediaDecodeTime":a(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===i.version&&(i.baseMediaDecodeTime*=Math.pow(2,32),i.baseMediaDecodeTime+=a(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),i}},function(e,i,n){"use strict";Object.defineProperty(i,"__esModule",{"value":!0});var a=function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(n(100)),s={"mp4":/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,"webm":/^(vp0?[89]|av0?1|opus|vorbis)/,"ogg":/^(vp0?[89]|theora|flac|opus|vorbis)/,"video":/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,"audio":/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3)/,"text":/^(stpp.ttml.im1t)/,"muxerVideo":/^(avc0?1)/,"muxerAudio":/^(mp4a)/,"muxerText":/a^/},o=["video","audio","text"],u=["Video","Audio","Text"],l=function translateLegacyCodec(e){return e?e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,i,n){return"avc1."+("00"+Number(i).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)})):e},c=function translateLegacyCodecs(e){return e.map(l)},h=function parseCodecs(e){void 0===e&&(e="");var i=e.split(","),n={},a=[];return i.forEach((function(e){var i;e=e.trim(),o.forEach((function(a){var o=s[a].exec(e.toLowerCase());if(o&&!(o.length<=1)){i=a;var u=e.substring(0,o[1].length),l=e.replace(u,"");n[a]={"type":u,"details":l}}})),i||a.push(e)})),a.length&&(n.unknown=a),n},f=function isAudioCodec(e){return void 0===e&&(e=""),s.audio.test(e.trim().toLowerCase())},m=function isTextCodec(e){return void 0===e&&(e=""),s.text.test(e.trim().toLowerCase())},g=function getMimeForCodec(e){if(e&&"string"==typeof e){var i=e.toLowerCase().split(",").map((function(e){return l(e.trim())})),n="video";1===i.length&&f(i[0])?n="audio":1===i.length&&m(i[0])&&(n="application");var a="mp4";return i.every((function(e){return s.mp4.test(e)}))?a="mp4":i.every((function(e){return s.webm.test(e)}))?a="webm":i.every((function(e){return s.ogg.test(e)}))&&(a="ogg"),n+"/"+a+';codecs="'+e+'"'}};i.DEFAULT_AUDIO_CODEC="mp4a.40.2",i.DEFAULT_VIDEO_CODEC="avc1.4d400d",i.browserSupportsCodec=function browserSupportsCodec(e){return void 0===e&&(e=""),a.MediaSource&&a.MediaSource.isTypeSupported&&a.MediaSource.isTypeSupported(g(e))||!1},i.codecsFromDefault=function codecsFromDefault(e,i){if(!e.mediaGroups.AUDIO||!i)return null;var n=e.mediaGroups.AUDIO[i];if(!n)return null;for(var a in n){var s=n[a];if(s.default&&s.playlists)return h(s.playlists[0].attributes.CODECS)}return null},i.getMimeForCodec=g,i.isAudioCodec=f,i.isTextCodec=m,i.isVideoCodec=function isVideoCodec(e){return void 0===e&&(e=""),s.video.test(e.trim().toLowerCase())},i.mapLegacyAvcCodecs=function mapLegacyAvcCodecs(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e){return c([e])[0]}))},i.muxerSupportsCodec=function muxerSupportsCodec(e){return void 0===e&&(e=""),e.toLowerCase().split(",").every((function(e){e=e.trim();for(var i=0;i<u.length;i++){if(s["muxer"+u[i]].test(e))return!0}return!1}))},i.parseCodecs=h,i.translateLegacyCodec=l,i.translateLegacyCodecs=c},function(e,i,n){},,,,function(e,i,n){"use strict";var a=n(100),s=n.n(a),o=n(103),u=n.n(o),l=n(102),c=n.n(l),h=n(44),f=n.n(h),m=(n(32),n(16),n(104)),g=n.n(m),v=n(112),y=n.n(v),_=n(113),T=n.n(_),b=n(114),S=n.n(b),C=n(116),k=n.n(C),E=n(31),w=n.n(E),P=n(120),I=n.n(P),x=n(105),A=n.n(x),L=n(122),D=n.n(L),O=n(106),M=n.n(O),R=function(e){function LineStream(){var i;return(i=e.call(this)||this).buffer="",i}return g()(LineStream,e),LineStream.prototype.push=function push(e){var i;for(this.buffer+=e,i=this.buffer.indexOf("\n");i>-1;i=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,i)),this.buffer=this.buffer.substring(i+1)},LineStream}(D.a),B=function parseAttributes(e){for(var i,n=e.split(function attributeSeparator(){return new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')}()),a={},s=n.length;s--;)""!==n[s]&&((i=/([^=]*)=(.*)/.exec(n[s]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),a[i[0]]=i[1]);return a},N=function(e){function ParseStream(){var i;return(i=e.call(this)||this).customParsers=[],i.tagMappers=[],i}g()(ParseStream,e);var i=ParseStream.prototype;return i.push=function push(e){var i,n,a=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce((function(i,n){var a=n(e);return a===e?i:i.concat([a])}),[e]).forEach((function(e){for(var s=0;s<a.customParsers.length;s++)if(a.customParsers[s].call(a,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),i=/^#EXTM3U/.exec(e))a.trigger("data",{"type":"tag","tagType":"m3u"});else{if(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return n={"type":"tag","tagType":"inf"},i[1]&&(n.duration=parseFloat(i[1])),i[2]&&(n.title=i[2]),void a.trigger("data",n);if(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return n={"type":"tag","tagType":"targetduration"},i[1]&&(n.duration=parseInt(i[1],10)),void a.trigger("data",n);if(i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return n={"type":"tag","tagType":"totalduration"},i[1]&&(n.duration=parseInt(i[1],10)),void a.trigger("data",n);if(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return n={"type":"tag","tagType":"version"},i[1]&&(n.version=parseInt(i[1],10)),void a.trigger("data",n);if(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={"type":"tag","tagType":"media-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void a.trigger("data",n);if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={"type":"tag","tagType":"discontinuity-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void a.trigger("data",n);if(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return n={"type":"tag","tagType":"playlist-type"},i[1]&&(n.playlistType=i[1]),void a.trigger("data",n);if(i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return n={"type":"tag","tagType":"byterange"},i[1]&&(n.length=parseInt(i[1],10)),i[2]&&(n.offset=parseInt(i[2],10)),void a.trigger("data",n);if(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return n={"type":"tag","tagType":"allow-cache"},i[1]&&(n.allowed=!/NO/.test(i[1])),void a.trigger("data",n);if(i=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(n={"type":"tag","tagType":"map"},i[1]){var o=B(i[1]);if(o.URI&&(n.uri=o.URI),o.BYTERANGE){var u=o.BYTERANGE.split("@"),l=u[0],c=u[1];n.byterange={},l&&(n.byterange.length=parseInt(l,10)),c&&(n.byterange.offset=parseInt(c,10))}}a.trigger("data",n)}else if(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(n={"type":"tag","tagType":"stream-inf"},i[1]){if(n.attributes=B(i[1]),n.attributes.RESOLUTION){var h=n.attributes.RESOLUTION.split("x"),f={};h[0]&&(f.width=parseInt(h[0],10)),h[1]&&(f.height=parseInt(h[1],10)),n.attributes.RESOLUTION=f}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}a.trigger("data",n)}else{if(i=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return n={"type":"tag","tagType":"media"},i[1]&&(n.attributes=B(i[1])),void a.trigger("data",n);if(i=/^#EXT-X-ENDLIST/.exec(e))a.trigger("data",{"type":"tag","tagType":"endlist"});else if(i=/^#EXT-X-DISCONTINUITY/.exec(e))a.trigger("data",{"type":"tag","tagType":"discontinuity"});else{if(i=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return n={"type":"tag","tagType":"program-date-time"},i[1]&&(n.dateTimeString=i[1],n.dateTimeObject=new Date(i[1])),void a.trigger("data",n);if(i=/^#EXT-X-KEY:?(.*)$/.exec(e))return n={"type":"tag","tagType":"key"},i[1]&&(n.attributes=B(i[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void a.trigger("data",n);if(i=/^#EXT-X-START:?(.*)$/.exec(e))return n={"type":"tag","tagType":"start"},i[1]&&(n.attributes=B(i[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void a.trigger("data",n);if(i=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return n={"type":"tag","tagType":"cue-out-cont"},i[1]?n.data=i[1]:n.data="",void a.trigger("data",n);if(i=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return n={"type":"tag","tagType":"cue-out"},i[1]?n.data=i[1]:n.data="",void a.trigger("data",n);if(i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return n={"type":"tag","tagType":"cue-in"},i[1]?n.data=i[1]:n.data="",void a.trigger("data",n);a.trigger("data",{"type":"tag","data":e.slice(4)})}}}else a.trigger("data",{"type":"comment","text":e.slice(1)})})):this.trigger("data",{"type":"uri","uri":e}))},i.addParser=function addParser(e){var i=this,n=e.expression,a=e.customType,s=e.dataParser,o=e.segment;"function"!=typeof s&&(s=function dataParser(e){return e}),this.customParsers.push((function(e){if(n.exec(e))return i.trigger("data",{"type":"custom","data":s(e),"customType":a,"segment":o}),!0}))},i.addTagMapper=function addTagMapper(e){var i=e.expression,n=e.map;this.tagMappers.push((function mapFn(e){return i.test(e)?n(e):e}))},ParseStream}(D.a),U=function(e){function Parser(){var i;(i=e.call(this)||this).lineStream=new R,i.parseStream=new N,i.lineStream.pipe(i.parseStream);var n,a,s=f()(i),o=[],u={},l=function noop(){},h={"AUDIO":{},"VIDEO":{},"CLOSED-CAPTIONS":{},"SUBTITLES":{}},m=0;i.manifest={"allowCache":!0,"discontinuityStarts":[],"segments":[]};var g=0;return i.parseStream.on("data",(function(e){var i,f;({"tag":function tag(){({"allow-cache":function allowCache(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{"message":"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},"byterange":function byterange(){var byterange={};"length"in e&&(u.byterange=byterange,byterange.length=e.length,"offset"in e||(e.offset=g)),"offset"in e&&(u.byterange=byterange,byterange.offset=e.offset),g=byterange.offset+byterange.length},"endlist":function endlist(){this.manifest.endList=!0},"inf":function inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{"message":"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{"message":"defaulting discontinuity sequence to zero"})),e.duration>0&&(u.duration=e.duration),0===e.duration&&(u.duration=.01,this.trigger("info",{"message":"updating zero segment duration to a small value"})),this.manifest.segments=o},"key":function key(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{"message":"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{"message":"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{"message":"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{"attributes":{"schemeIdUri":e.attributes.KEYFORMAT,"keyId":e.attributes.KEYID.substring(2)},"pssh":M()(e.attributes.URI.split(",")[1])}}):void this.trigger("warn",{"message":"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{"message":"defaulting key method to AES-128"}),a={"method":e.attributes.METHOD||"AES-128","uri":e.attributes.URI},void 0!==e.attributes.IV&&(a.iv=e.attributes.IV)}else this.trigger("warn",{"message":"ignoring key declaration without URI"});else a=null;else this.trigger("warn",{"message":"ignoring key declaration without attribute list"})},"media-sequence":function mediaSequence(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{"message":"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function discontinuitySequence(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,m=e.number):this.trigger("warn",{"message":"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function playlistType(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{"message":"ignoring unknown playlist type: "+e.playlist})},"map":function map(){n={},e.uri&&(n.uri=e.uri),e.byterange&&(n.byterange=e.byterange)},"stream-inf":function streamInf(){this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||h,e.attributes?(u.attributes||(u.attributes={}),c()(u.attributes,e.attributes)):this.trigger("warn",{"message":"ignoring empty stream-inf attributes"})},"media":function media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||h,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var n=this.manifest.mediaGroups[e.attributes.TYPE];n[e.attributes["GROUP-ID"]]=n[e.attributes["GROUP-ID"]]||{},i=n[e.attributes["GROUP-ID"]],(f={"default":/yes/i.test(e.attributes.DEFAULT)}).default?f.autoselect=!0:f.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(f.language=e.attributes.LANGUAGE),e.attributes.URI&&(f.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(f.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(f.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(f.forced=/yes/i.test(e.attributes.FORCED)),i[e.attributes.NAME]=f}else this.trigger("warn",{"message":"ignoring incomplete or missing media group"})},"discontinuity":function discontinuity(){m+=1,u.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time":function programDateTime(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),u.dateTimeString=e.dateTimeString,u.dateTimeObject=e.dateTimeObject},"targetduration":function targetduration(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{"message":"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},"totalduration":function totalduration(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{"message":"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},"start":function start(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={"timeOffset":e.attributes["TIME-OFFSET"],"precise":e.attributes.PRECISE}:this.trigger("warn",{"message":"ignoring start declaration without appropriate attribute list"})},"cue-out":function cueOut(){u.cueOut=e.data},"cue-out-cont":function cueOutCont(){u.cueOutCont=e.data},"cue-in":function cueIn(){u.cueIn=e.data}}[e.tagType]||l).call(s)},"uri":function uri(){u.uri=e.uri,o.push(u),this.manifest.targetDuration&&!("duration"in u)&&(this.trigger("warn",{"message":"defaulting segment duration to the target duration"}),u.duration=this.manifest.targetDuration),a&&(u.key=a),u.timeline=m,n&&(u.map=n),u={}},"comment":function comment(){},"custom":function custom(){e.segment?(u.custom=u.custom||{},u.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(s)})),i}g()(Parser,e);var i=Parser.prototype;return i.push=function push(e){this.lineStream.push(e)},i.end=function end(){this.lineStream.push("\n")},i.addParser=function addParser(e){this.parseStream.addParser(e)},i.addTagMapper=function addTagMapper(e){this.parseStream.addTagMapper(e)},Parser}(D.a),j=n(126),V=n(127),H=function isObject(e){return!!e&&"object"==typeof e},W=function merge(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.reduce((function(e,i){return"object"!=typeof i||Object.keys(i).forEach((function(n){Array.isArray(e[n])&&Array.isArray(i[n])?e[n]=e[n].concat(i[n]):H(e[n])&&H(i[n])?e[n]=merge(e[n],i[n]):e[n]=i[n]})),e}),{})},q=function flatten(e){return e.reduce((function(e,i){return e.concat(i)}),[])},$=function from(e){if(!e.length)return[];for(var i=[],n=0;n<e.length;n++)i.push(e[n]);return i},z="INVALID_NUMBER_OF_PERIOD",G="DASH_EMPTY_MANIFEST",X="DASH_INVALID_XML",K="NO_BASE_URL",Y="SEGMENT_TIME_UNSPECIFIED",Q="UNSUPPORTED_UTC_TIMING_SCHEME",J=function urlTypeToSegment(e){var i=e.baseUrl,n=void 0===i?"":i,a=e.source,s=void 0===a?"":a,o=e.range,u=void 0===o?"":o,l=e.indexRange,c=void 0===l?"":l,h={"uri":s,"resolvedUri":A()(n||"",s)};if(u||c){var f=(u||c).split("-"),m=parseInt(f[0],10),g=parseInt(f[1],10);h.byterange={"length":g-m+1,"offset":m}}return h},Z=function byteRangeToString(e){var i=e.offset+e.length-1;return e.offset+"-"+i},ee={"static":function _static(e){var i=e.duration,n=e.timescale,a=void 0===n?1:n,s=e.sourceDuration;return{"start":0,"end":Math.ceil(s/(i/a))}},"dynamic":function dynamic(e){var i=e.NOW,n=e.clientOffset,a=e.availabilityStartTime,s=e.timescale,o=void 0===s?1:s,u=e.duration,l=e.start,c=void 0===l?0:l,h=e.minimumUpdatePeriod,f=void 0===h?0:h,m=e.timeShiftBufferDepth,g=void 0===m?1/0:m,v=(i+n)/1e3,y=a+c,_=v+f-y,T=Math.ceil(_*o/u),b=Math.floor((v-y-g)*o/u),S=Math.floor((v-y)*o/u);return{"start":Math.max(0,b),"end":Math.min(T,S)}}},te=function parseByDuration(e){var i=e.type,n=void 0===i?"static":i,a=e.duration,s=e.timescale,o=void 0===s?1:s,u=e.sourceDuration,l=ee[n](e),c=function range(e,i){for(var n=[],a=e;a<i;a++)n.push(a);return n}(l.start,l.end).map(function toSegments(e){return function(i,n){var a=e.duration,s=e.timescale,o=void 0===s?1:s,u=e.periodIndex,l=e.startNumber;return{"number":(void 0===l?1:l)+i,"duration":a/o,"timeline":u,"time":n*a}}}(e));if("static"===n){var h=c.length-1;c[h].duration=u-a/o*h}return c},ie=function segmentsFromBase(e){var i=e.baseUrl,n=e.initialization,a=void 0===n?{}:n,s=e.sourceDuration,o=e.indexRange,u=void 0===o?"":o,l=e.duration;if(!i)throw new Error(K);var c=J({"baseUrl":i,"source":a.sourceURL,"range":a.range}),h=J({"baseUrl":i,"source":i,"indexRange":u});if(h.map=c,l){var f=te(e);f.length&&(h.duration=f[0].duration,h.timeline=f[0].timeline)}else s&&(h.duration=s,h.timeline=0);return h.number=0,[h]},ne=function addSegmentsToPlaylist(e,i,n){for(var a=e.sidx.map?e.sidx.map:null,s=e.sidx.duration,o=e.timeline||0,u=e.sidx.byterange,l=u.offset+u.length,c=i.timescale,h=i.references.filter((function(e){return 1!==e.referenceType})),f=[],m=l+i.firstOffset,g=0;g<h.length;g++){var v=i.references[g],y=v.referencedSize,_=v.subsegmentDuration,T=ie({"baseUrl":n,"timescale":c,"timeline":o,"periodIndex":o,"duration":_,"sourceDuration":s,"indexRange":m+"-"+(m+y-1)})[0];a&&(T.map=a),f.push(T),m+=y}return e.segments=f,e},re=function mergeDiscontiguousPlaylists(e){return function values(e){return Object.keys(e).map((function(i){return e[i]}))}(e.reduce((function(e,i){var n,a=i.attributes.id+(i.attributes.lang||"");e[a]?(i.segments[0]&&(i.segments[0].discontinuity=!0),(n=e[a].segments).push.apply(n,i.segments),i.attributes.contentProtection&&(e[a].attributes.contentProtection=i.attributes.contentProtection)):e[a]=i;return e}),{})).map((function(e){return e.discontinuityStarts=function findIndexes(e,i){return e.reduce((function(e,n,a){return n[i]&&e.push(a),e}),[])}(e.segments,"discontinuity"),e}))},ae=function addSegmentInfoFromSidx(e,i){if(void 0===i&&(i={}),!Object.keys(i).length)return e;for(var n in e){var a=e[n];if(a.sidx){var s=a.sidx.uri+"-"+Z(a.sidx.byterange),o=i[s]&&i[s].sidx;a.sidx&&o&&ne(a,o,a.sidx.resolvedUri)}}return e},se=function formatAudioPlaylist(e){var i,n=e.attributes,a=e.segments,s=e.sidx,o={"attributes":(i={"NAME":n.id,"BANDWIDTH":n.bandwidth,"CODECS":n.codecs},i["PROGRAM-ID"]=1,i),"uri":"","endList":"static"===(n.type||"static"),"timeline":n.periodIndex,"resolvedUri":"","targetDuration":n.duration,"segments":a,"mediaSequence":a.length?a[0].number:1};return n.contentProtection&&(o.contentProtection=n.contentProtection),s&&(o.sidx=s),o},oe=function formatVttPlaylist(e){var i,n=e.attributes,a=e.segments;void 0===a&&(a=[{"uri":n.baseUrl,"timeline":n.periodIndex,"resolvedUri":n.baseUrl||"","duration":n.sourceDuration,"number":0}],n.duration=n.sourceDuration);var s=((i={"NAME":n.id,"BANDWIDTH":n.bandwidth})["PROGRAM-ID"]=1,i);return n.codecs&&(s.CODECS=n.codecs),{"attributes":s,"uri":"","endList":"static"===(n.type||"static"),"timeline":n.periodIndex,"resolvedUri":n.baseUrl||"","targetDuration":n.duration,"segments":a,"mediaSequence":a.length?a[0].number:1}},ue=function formatVideoPlaylist(e){var i,n=e.attributes,a=e.segments,s=e.sidx,o={"attributes":(i={"NAME":n.id,"AUDIO":"audio","SUBTITLES":"subs","RESOLUTION":{"width":n.width,"height":n.height},"CODECS":n.codecs,"BANDWIDTH":n.bandwidth},i["PROGRAM-ID"]=1,i),"uri":"","endList":"static"===(n.type||"static"),"timeline":n.periodIndex,"resolvedUri":"","targetDuration":n.duration,"segments":a,"mediaSequence":a.length?a[0].number:1};return n.contentProtection&&(o.contentProtection=n.contentProtection),s&&(o.sidx=s),o},le=function toM3u8(e,i,n){var a;if(void 0===n&&(n={}),!e.length)return{};var s=e[0].attributes,o=s.sourceDuration,u=s.type,l=void 0===u?"static":u,c=s.suggestedPresentationDelay,h=s.minimumUpdatePeriod,f=re(e.filter((function videoOnly(e){var i=e.attributes;return"video/mp4"===i.mimeType||"video/webm"===i.mimeType||"video"===i.contentType}))).map(ue),m=re(e.filter((function audioOnly(e){var i=e.attributes;return"audio/mp4"===i.mimeType||"audio/webm"===i.mimeType||"audio"===i.contentType}))),g=e.filter((function vttOnly(e){var i=e.attributes;return"text/vtt"===i.mimeType||"text"===i.contentType})),v={"allowCache":!0,"discontinuityStarts":[],"segments":[],"endList":!0,"mediaGroups":(a={"AUDIO":{},"VIDEO":{}},a["CLOSED-CAPTIONS"]={},a.SUBTITLES={},a),"uri":"","duration":o,"playlists":ae(f,n)};return h>=0&&(v.minimumUpdatePeriod=1e3*h),i&&(v.locations=i),"dynamic"===l&&(v.suggestedPresentationDelay=c),m.length&&(v.mediaGroups.AUDIO.audio=function organizeAudioPlaylists(e,i){var n;void 0===i&&(i={});var a=e.reduce((function(e,a){var s=a.attributes.role&&a.attributes.role.value||"",o=a.attributes.lang||"",u="main";if(o){var l=s?" ("+s+")":"";u=""+a.attributes.lang+l}return e[u]&&e[u].playlists[0].attributes.BANDWIDTH>a.attributes.bandwidth||(e[u]={"language":o,"autoselect":!0,"default":"main"===s,"playlists":ae([se(a)],i),"uri":""},void 0===n&&"main"===s&&((n=a).default=!0)),e}),{});n||(a[Object.keys(a)[0]].default=!0);return a}(m,n)),g.length&&(v.mediaGroups.SUBTITLES.subs=function organizeVttPlaylists(e,i){return void 0===i&&(i={}),e.reduce((function(e,n){var a=n.attributes.lang||"text";return e[a]||(e[a]={"language":a,"default":!1,"autoselect":!1,"playlists":ae([oe(n)],i),"uri":""}),e}),{})}(g,n)),v},ce=function getLiveRValue(e,i,n){var a=e.NOW,s=e.clientOffset,o=e.availabilityStartTime,u=e.timescale,l=void 0===u?1:u,c=e.start,h=void 0===c?0:c,f=e.minimumUpdatePeriod,m=(a+s)/1e3+(void 0===f?0:f)-(o+h);return Math.ceil((m*l-i)/n)},de=function parseByTimeline(e,i){for(var n=e.type,a=void 0===n?"static":n,s=e.minimumUpdatePeriod,o=void 0===s?0:s,u=e.media,l=void 0===u?"":u,c=e.sourceDuration,h=e.timescale,f=void 0===h?1:h,m=e.startNumber,g=void 0===m?1:m,v=e.periodIndex,y=[],_=-1,T=0;T<i.length;T++){var b=i[T],S=b.d,C=b.r||0,k=b.t||0;_<0&&(_=k),k&&k>_&&(_=k);var E=void 0;if(C<0){var w=T+1;E=w===i.length?"dynamic"===a&&o>0&&l.indexOf("$Number$")>0?ce(e,_,S):(c*f-_)/S:(i[w].t-_)/S}else E=C+1;for(var P=g+y.length+E,I=g+y.length;I<P;)y.push({"number":I,"duration":S/f,"time":_,"timeline":v}),_+=S,I++}return y},he=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,pe=function constructTemplateUrl(e,i){return e.replace(he,function identifierReplacement(e){return function(i,n,a,s){if("$$"===i)return"$";if(void 0===e[n])return i;var o=""+e[n];return"RepresentationID"===n?o:(s=a?parseInt(s,10):1,o.length>=s?o:""+new Array(s-o.length+1).join("0")+o)}}(i))},fe=function segmentsFromTemplate(e,i){var n={"RepresentationID":e.id,"Bandwidth":e.bandwidth||0},a=e.initialization,s=void 0===a?{"sourceURL":"","range":""}:a,o=J({"baseUrl":e.baseUrl,"source":pe(s.sourceURL,n),"range":s.range});return function parseTemplateInfo(e,i){return e.duration||i?e.duration?te(e):de(e,i):[{"number":e.startNumber||1,"duration":e.sourceDuration,"time":0,"timeline":e.periodIndex}]}(e,i).map((function(i){n.Number=i.number,n.Time=i.time;var a=pe(e.media||"",n);return{"uri":a,"timeline":i.timeline,"duration":i.duration,"resolvedUri":A()(e.baseUrl||"",a),"map":o,"number":i.number}}))},me=function segmentsFromList(e,i){var n=e.duration,a=e.segmentUrls,s=void 0===a?[]:a;if(!n&&!i||n&&i)throw new Error(Y);var o,u=s.map((function(i){return function SegmentURLToSegmentObject(e,i){var n=e.baseUrl,a=e.initialization,s=void 0===a?{}:a,o=J({"baseUrl":n,"source":s.sourceURL,"range":s.range}),u=J({"baseUrl":n,"source":i.media,"range":i.mediaRange});return u.map=o,u}(e,i)}));return n&&(o=te(e)),i&&(o=de(e,i)),o.map((function(e,i){if(u[i]){var n=u[i];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}})).filter((function(e){return e}))},ge=function generateSegments(e){var i,n,a=e.attributes,s=e.segmentInfo;s.template?(n=fe,i=W(a,s.template)):s.base?(n=ie,i=W(a,s.base)):s.list&&(n=me,i=W(a,s.list));var o={"attributes":a};if(!n)return o;var u=n(i,s.timeline);if(i.duration){var l=i,c=l.duration,h=l.timescale,f=void 0===h?1:h;i.duration=c/f}else u.length?i.duration=u.reduce((function(e,i){return Math.max(e,Math.ceil(i.duration))}),0):i.duration=0;return o.attributes=i,o.segments=u,s.base&&i.indexRange&&(o.sidx=u[0],o.segments=[]),o},ve=function findChildren(e,i){return $(e.childNodes).filter((function(e){return e.tagName===i}))},ye=function getContent(e){return e.textContent.trim()},_e=function parseDuration(e){var i=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!i)return 0;var n=i.slice(1),a=n[0],s=n[1],o=n[2],u=n[3],l=n[4],c=n[5];return 31536e3*parseFloat(a||0)+2592e3*parseFloat(s||0)+86400*parseFloat(o||0)+3600*parseFloat(u||0)+60*parseFloat(l||0)+parseFloat(c||0)},Te={"mediaPresentationDuration":function mediaPresentationDuration(e){return _e(e)},"availabilityStartTime":function availabilityStartTime(e){return function parseDate(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),Date.parse(e)}(e)/1e3},"minimumUpdatePeriod":function minimumUpdatePeriod(e){return _e(e)},"suggestedPresentationDelay":function suggestedPresentationDelay(e){return _e(e)},"type":function type(e){return e},"timeShiftBufferDepth":function timeShiftBufferDepth(e){return _e(e)},"start":function start(e){return _e(e)},"width":function width(e){return parseInt(e,10)},"height":function height(e){return parseInt(e,10)},"bandwidth":function bandwidth(e){return parseInt(e,10)},"startNumber":function startNumber(e){return parseInt(e,10)},"timescale":function timescale(e){return parseInt(e,10)},"duration":function duration(e){var i=parseInt(e,10);return isNaN(i)?_e(e):i},"d":function d(e){return parseInt(e,10)},"t":function t(e){return parseInt(e,10)},"r":function r(e){return parseInt(e,10)},"DEFAULT":function DEFAULT(e){return e}},be=function parseAttributes(e){return e&&e.attributes?$(e.attributes).reduce((function(e,i){var n=Te[i.name]||Te.DEFAULT;return e[i.name]=n(i.value),e}),{}):{}},Se={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Ce=function buildBaseUrls(e,i){return i.length?q(e.map((function(e){return i.map((function(i){return A()(e,ye(i))}))}))):e},ke=function getSegmentInformation(e){var i=ve(e,"SegmentTemplate")[0],n=ve(e,"SegmentList")[0],a=n&&ve(n,"SegmentURL").map((function(e){return W({"tag":"SegmentURL"},be(e))})),s=ve(e,"SegmentBase")[0],o=n||i,u=o&&ve(o,"SegmentTimeline")[0],l=n||s||i,c=l&&ve(l,"Initialization")[0],h=i&&be(i);h&&c?h.initialization=c&&be(c):h&&h.initialization&&(h.initialization={"sourceURL":h.initialization});var f={"template":h,"timeline":u&&ve(u,"S").map((function(e){return be(e)})),"list":n&&W(be(n),{"segmentUrls":a,"initialization":be(c)}),"base":s&&W(be(s),{"initialization":be(c)})};return Object.keys(f).forEach((function(e){f[e]||delete f[e]})),f},Ee=function toRepresentations(e,i,n){return function(a){var s=be(a),o=Ce(i,ve(a,"BaseURL")),u=ve(a,"Role")[0],l={"role":be(u)},c=W(e,s,l),h=function generateKeySystemInformation(e){return e.reduce((function(e,i){var n=be(i),a=Se[n.schemeIdUri];if(a){e[a]={"attributes":n};var s=ve(i,"cenc:pssh")[0];if(s){var o=ye(s),u=o&&M()(o);e[a].pssh=u}}return e}),{})}(ve(a,"ContentProtection"));Object.keys(h).length&&(c=W(c,{"contentProtection":h}));var f=ke(a),m=ve(a,"Representation"),g=W(n,f);return q(m.map(function inheritBaseUrls(e,i,n){return function(a){var s=ve(a,"BaseURL"),o=Ce(i,s),u=W(e,be(a)),l=ke(a);return o.map((function(e){return{"segmentInfo":W(n,l),"attributes":W(u,{"baseUrl":e})}}))}}(c,o,g)))}},we=function toAdaptationSets(e,i){return function(n,a){var o=Ce(i,ve(n,"BaseURL")),u=be(n),l=parseInt(u.id,10),c=s.a.isNaN(l)?a:l,h=W(e,{"periodIndex":c}),f=ve(n,"AdaptationSet"),m=ke(n);return q(f.map(Ee(h,o,m)))}},Pe=function stringToMpdXml(e){if(""===e)throw new Error(G);var i,n,a=new V.DOMParser;try{n=(i=a.parseFromString(e,"application/xml"))&&"MPD"===i.documentElement.tagName?i.documentElement:null}catch(e){}if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(X);return n},Ie=function parse(e,i){void 0===i&&(i={});var n=function inheritAttributes(e,i){void 0===i&&(i={});var n=i,a=n.manifestUri,s=void 0===a?"":a,o=n.NOW,u=void 0===o?Date.now():o,l=n.clientOffset,c=void 0===l?0:l,h=ve(e,"Period");if(!h.length)throw new Error(z);var f=ve(e,"Location"),m=be(e),g=Ce([s],ve(e,"BaseURL"));return m.sourceDuration=m.mediaPresentationDuration||0,m.NOW=u,m.clientOffset=c,f.length&&(m.locations=f.map(ye)),{"locations":m.locations,"representationInfo":q(h.map(we(m,g)))}}(Pe(e),i),a=function toPlaylists(e){return e.map(ge)}(n.representationInfo);return le(a,n.locations,i.sidxMapping)},xe=function parseUTCTiming(e){return function parseUTCTimingScheme(e){var i=ve(e,"UTCTiming")[0];if(!i)return null;var n=be(i);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Q)}return n}(Pe(e))},Ae=ne,Le=n(129),De=n.n(Le),Oe=n(130),Me=n(131),Re=n(132),Be=n.n(Re),Ne=n(109),Ue=n(137),je=n.n(Ue),Fe=n(143),Ve=[];var He=function createLogger(e){var i,n="info",a=function log(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];i("log",n,a)};return i=function LogByTypeFactory(e,i){return function(n,a,o){var u=i.levels[a],l=new RegExp("^("+u+")$");if("log"!==n&&o.unshift(n.toUpperCase()+":"),o.unshift(e+":"),Ve){Ve.push([].concat(o));var c=Ve.length-1e3;Ve.splice(0,c>0?c:0)}if(s.a.console){var h=s.a.console[n];h||"debug"!==n||(h=s.a.console.info||s.a.console.log),h&&u&&l.test(n)&&h[Array.isArray(o)?"apply":"call"](s.a.console,o)}}}(e,a),a.createLogger=function(i){return createLogger(e+": "+i)},a.levels={"all":"debug|log|warn|error","off":"","debug":"debug|log|warn|error","info":"log|warn|error","warn":"warn|error","error":"error","DEFAULT":n},a.level=function(e){if("string"==typeof e){if(!a.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');n=e}return n},(a.history=function(){return Ve?[].concat(Ve):[]}).filter=function(e){return(Ve||[]).filter((function(i){return new RegExp(".*"+e+".*").test(i[0])}))},a.history.clear=function(){Ve&&(Ve.length=0)},a.history.disable=function(){null!==Ve&&(Ve.length=0,Ve=null)},a.history.enable=function(){null===Ve&&(Ve=[])},a.error=function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return i("error",n,a)},a.warn=function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return i("warn",n,a)},a.debug=function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return i("debug",n,a)},a}("VIDEOJS"),We=He.createLogger,qe=Object.prototype.toString,$e=function keys(e){return video_es_isObject(e)?Object.keys(e):[]};function each(e,i){$e(e).forEach((function(n){return i(e[n],n)}))}function video_es_assign(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return Object.assign?c.a.apply(void 0,[e].concat(n)):(n.forEach((function(i){i&&each(i,(function(i,n){e[n]=i}))})),e)}function video_es_isObject(e){return!!e&&"object"==typeof e}function isPlain(e){return video_es_isObject(e)&&"[object Object]"===qe.call(e)&&e.constructor===Object}function computedStyle(e,i){if(!e||!i)return"";if("function"==typeof s.a.getComputedStyle){var n=s.a.getComputedStyle(e);return n?n.getPropertyValue(i)||n[i]:""}return""}function isNonBlankString(e){return"string"==typeof e&&Boolean(e.trim())}function throwIfWhitespace(e){if(e.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function isReal(){return u.a===s.a.document}function isEl(e){return video_es_isObject(e)&&1===e.nodeType}function isInFrame(){try{return s.a.parent!==s.a.self}catch(e){return!0}}function createQuerier(e){return function(i,n){if(!isNonBlankString(i))return u.a[e](null);isNonBlankString(n)&&(n=u.a.querySelector(n));var a=isEl(n)?n:u.a;return a[e]&&a[e](i)}}function video_es_createEl(e,i,n,a){void 0===e&&(e="div"),void 0===i&&(i={}),void 0===n&&(n={});var s=u.a.createElement(e);return Object.getOwnPropertyNames(i).forEach((function(e){var n=i[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(He.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+n+"."),s.setAttribute(e,n)):"textContent"===e?textContent(s,n):s[e]===n&&"tabIndex"!==e||(s[e]=n)})),Object.getOwnPropertyNames(n).forEach((function(e){s.setAttribute(e,n[e])})),a&&appendContent(s,a),s}function textContent(e,i){return void 0===e.textContent?e.innerText=i:e.textContent=i,e}function prependTo(e,i){i.firstChild?i.insertBefore(e,i.firstChild):i.appendChild(e)}function hasClass(e,i){return throwIfWhitespace(i),e.classList?e.classList.contains(i):function classRegExp(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}(i).test(e.className)}function addClass(e,i){return e.classList?e.classList.add(i):hasClass(e,i)||(e.className=(e.className+" "+i).trim()),e}function removeClass(e,i){return e.classList?e.classList.remove(i):(throwIfWhitespace(i),e.className=e.className.split(/\s+/).filter((function(e){return e!==i})).join(" ")),e}function toggleClass(e,i,n){var a=hasClass(e,i);if("function"==typeof n&&(n=n(e,i)),"boolean"!=typeof n&&(n=!a),n!==a)return n?addClass(e,i):removeClass(e,i),e}function setAttributes(e,i){Object.getOwnPropertyNames(i).forEach((function(n){var a=i[n];null==a||!1===a?e.removeAttribute(n):e.setAttribute(n,!0===a?"":a)}))}function getAttributes(e){var i={},n=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&e.attributes.length>0)for(var a=e.attributes,s=a.length-1;s>=0;s--){var o=a[s].name,u=a[s].value;"boolean"!=typeof e[o]&&-1===n.indexOf(","+o+",")||(u=null!==u),i[o]=u}return i}function getAttribute(e,i){return e.getAttribute(i)}function setAttribute(e,i,n){e.setAttribute(i,n)}function removeAttribute(e,i){e.removeAttribute(i)}function blockTextSelection(){u.a.body.focus(),u.a.onselectstart=function(){return!1}}function unblockTextSelection(){u.a.onselectstart=function(){return!0}}function getBoundingClientRect(e){if(e&&e.getBoundingClientRect&&e.parentNode){var i=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach((function(e){void 0!==i[e]&&(n[e]=i[e])})),n.height||(n.height=parseFloat(computedStyle(e,"height"))),n.width||(n.width=parseFloat(computedStyle(e,"width"))),n}}function findPosition(e){if(!e||e&&!e.offsetParent)return{"left":0,"top":0,"width":0,"height":0};var i=e.offsetWidth,n=e.offsetHeight,a=0,s=0;do{a+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent}while(e);return{"left":a,"top":s,"width":i,"height":n}}function getPointerPosition(e,i){var n={},a=findPosition(i.target),s=findPosition(e),o=s.width,u=s.height,l=i.offsetY-(s.top-a.top),c=i.offsetX-(s.left-a.left);return i.changedTouches&&(c=i.changedTouches[0].pageX-s.left,l=i.changedTouches[0].pageY+s.top),n.y=1-Math.max(0,Math.min(1,l/u)),n.x=Math.max(0,Math.min(1,c/o)),n}function isTextNode(e){return video_es_isObject(e)&&3===e.nodeType}function emptyEl(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function normalizeContent(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map((function(e){return"function"==typeof e&&(e=e()),isEl(e)||isTextNode(e)?e:"string"==typeof e&&/\S/.test(e)?u.a.createTextNode(e):void 0})).filter((function(e){return e}))}function appendContent(e,i){return normalizeContent(i).forEach((function(i){return e.appendChild(i)})),e}function insertContent(e,i){return appendContent(emptyEl(e),i)}function isSingleLeftClick(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons))}var ze,Ge=createQuerier("querySelector"),Xe=createQuerier("querySelectorAll"),Ke=Object.freeze({"__proto__":null,"isReal":isReal,"isEl":isEl,"isInFrame":isInFrame,"createEl":video_es_createEl,"textContent":textContent,"prependTo":prependTo,"hasClass":hasClass,"addClass":addClass,"removeClass":removeClass,"toggleClass":toggleClass,"setAttributes":setAttributes,"getAttributes":getAttributes,"getAttribute":getAttribute,"setAttribute":setAttribute,"removeAttribute":removeAttribute,"blockTextSelection":blockTextSelection,"unblockTextSelection":unblockTextSelection,"getBoundingClientRect":getBoundingClientRect,"findPosition":findPosition,"getPointerPosition":getPointerPosition,"isTextNode":isTextNode,"emptyEl":emptyEl,"normalizeContent":normalizeContent,"appendContent":appendContent,"insertContent":insertContent,"isSingleLeftClick":isSingleLeftClick,"$":Ge,"$$":Xe}),Ye=!1,Qe=function autoSetup(){if(isReal()&&!1!==ze.options.autoSetup){var e=Array.prototype.slice.call(u.a.getElementsByTagName("video")),i=Array.prototype.slice.call(u.a.getElementsByTagName("audio")),n=Array.prototype.slice.call(u.a.getElementsByTagName("video-js")),a=e.concat(i,n);if(a&&a.length>0)for(var s=0,o=a.length;s<o;s++){var l=a[s];if(!l||!l.getAttribute){autoSetupTimeout(1);break}void 0===l.player&&null!==l.getAttribute("data-setup")&&ze(l)}else Ye||autoSetupTimeout(1)}};function autoSetupTimeout(e,i){i&&(ze=i),s.a.setTimeout(Qe,e)}function setWindowLoaded(){Ye=!0,s.a.removeEventListener("load",setWindowLoaded)}isReal()&&("complete"===u.a.readyState?setWindowLoaded():s.a.addEventListener("load",setWindowLoaded));var Je,Ze=function createStyleElement(e){var i=u.a.createElement("style");return i.className=e,i},et=function setTextContent(e,i){e.styleSheet?e.styleSheet.cssText=i:e.textContent=i},tt=3;function newGUID(){return tt++}s.a.WeakMap||(Je=function(){function FakeWeakMap(){this.vdata="vdata"+Math.floor(s.a.performance&&s.a.performance.now()||Date.now()),this.data={}}var e=FakeWeakMap.prototype;return e.set=function set(e,i){var n=e[this.vdata]||newGUID();return e[this.vdata]||(e[this.vdata]=n),this.data[n]=i,this},e.get=function get(e){var i=e[this.vdata];if(i)return this.data[i];He("We have no data for this element",e)},e.has=function has(e){return e[this.vdata]in this.data},e.delete=function _delete(e){var i=e[this.vdata];i&&(delete this.data[i],delete e[this.vdata])},FakeWeakMap}());var it,nt=s.a.WeakMap?new WeakMap:new Je;function _cleanUpEvents(e,i){if(nt.has(e)){var n=nt.get(e);0===n.handlers[i].length&&(delete n.handlers[i],e.removeEventListener?e.removeEventListener(i,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+i,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&nt.delete(e)}}function _handleMultipleEvents(e,i,n,a){n.forEach((function(n){e(i,n,a)}))}function fixEvent(e){if(e.fixed_)return e;function returnTrue(){return!0}function returnFalse(){return!1}if(!e||!e.isPropagationStopped){var i=e||s.a.event;for(var n in e={},i)"layerX"!==n&&"layerY"!==n&&"keyLocation"!==n&&"webkitMovementX"!==n&&"webkitMovementY"!==n&&("returnValue"===n&&i.preventDefault||(e[n]=i[n]));if(e.target||(e.target=e.srcElement||u.a),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){i.preventDefault&&i.preventDefault(),e.returnValue=!1,i.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),e.cancelBubble=!0,i.cancelBubble=!0,e.isPropagationStopped=returnTrue},e.isPropagationStopped=returnFalse,e.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),e.isImmediatePropagationStopped=returnTrue,e.stopPropagation()},e.isImmediatePropagationStopped=returnFalse,null!==e.clientX&&void 0!==e.clientX){var a=u.a.documentElement,o=u.a.body;e.pageX=e.clientX+(a&&a.scrollLeft||o&&o.scrollLeft||0)-(a&&a.clientLeft||o&&o.clientLeft||0),e.pageY=e.clientY+(a&&a.scrollTop||o&&o.scrollTop||0)-(a&&a.clientTop||o&&o.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e.fixed_=!0,e}var rt=["touchstart","touchmove"];function on(e,i,n){if(Array.isArray(i))return _handleMultipleEvents(on,e,i,n);nt.has(e)||nt.set(e,{});var a=nt.get(e);if(a.handlers||(a.handlers={}),a.handlers[i]||(a.handlers[i]=[]),n.guid||(n.guid=newGUID()),a.handlers[i].push(n),a.dispatcher||(a.disabled=!1,a.dispatcher=function(i,n){if(!a.disabled){i=fixEvent(i);var s=a.handlers[i.type];if(s)for(var o=s.slice(0),u=0,l=o.length;u<l&&!i.isImmediatePropagationStopped();u++)try{o[u].call(e,i,n)}catch(e){He.error(e)}}}),1===a.handlers[i].length)if(e.addEventListener){var o=!1;(function supportsPassive(){if("boolean"!=typeof it){it=!1;try{var e=Object.defineProperty({},"passive",{"get":function get(){it=!0}});s.a.addEventListener("test",null,e),s.a.removeEventListener("test",null,e)}catch(e){}}return it})()&&rt.indexOf(i)>-1&&(o={"passive":!0}),e.addEventListener(i,a.dispatcher,o)}else e.attachEvent&&e.attachEvent("on"+i,a.dispatcher)}function off(e,i,n){if(nt.has(e)){var a=nt.get(e);if(a.handlers){if(Array.isArray(i))return _handleMultipleEvents(off,e,i,n);var s=function removeType(e,i){a.handlers[i]=[],_cleanUpEvents(e,i)};if(void 0!==i){var o=a.handlers[i];if(o)if(n){if(n.guid)for(var u=0;u<o.length;u++)o[u].guid===n.guid&&o.splice(u--,1);_cleanUpEvents(e,i)}else s(e,i)}else for(var l in a.handlers)Object.prototype.hasOwnProperty.call(a.handlers||{},l)&&s(e,l)}}}function trigger(e,i,n){var a=nt.has(e)?nt.get(e):{},s=e.parentNode||e.ownerDocument;if("string"==typeof i?i={"type":i,"target":e}:i.target||(i.target=e),i=fixEvent(i),a.dispatcher&&a.dispatcher.call(e,i,n),s&&!i.isPropagationStopped()&&!0===i.bubbles)trigger.call(null,s,i,n);else if(!s&&!i.defaultPrevented&&i.target&&i.target[i.type]){nt.has(i.target)||nt.set(i.target,{});var o=nt.get(i.target);i.target[i.type]&&(o.disabled=!0,"function"==typeof i.target[i.type]&&i.target[i.type](),o.disabled=!1)}return!i.defaultPrevented}function one(e,i,n){if(Array.isArray(i))return _handleMultipleEvents(one,e,i,n);var a=function func(){off(e,i,func),n.apply(this,arguments)};a.guid=n.guid=n.guid||newGUID(),on(e,i,a)}function any(e,i,n){var a=function func(){off(e,i,func),n.apply(this,arguments)};a.guid=n.guid=n.guid||newGUID(),on(e,i,a)}var at,st=Object.freeze({"__proto__":null,"fixEvent":fixEvent,"on":on,"off":off,"trigger":trigger,"one":one,"any":any}),ot=function bind(e,i,n){i.guid||(i.guid=newGUID());var a=i.bind(e);return a.guid=n?n+"_"+i.guid:i.guid,a},ut=function throttle(e,i){var n=s.a.performance.now();return function throttled(){var a=s.a.performance.now();a-n>=i&&(e.apply(void 0,arguments),n=a)}},lt=function EventTarget(){};lt.prototype.allowedEvents_={},lt.prototype.on=function(e,i){var n=this.addEventListener;this.addEventListener=function(){},on(this,e,i),this.addEventListener=n},lt.prototype.addEventListener=lt.prototype.on,lt.prototype.off=function(e,i){off(this,e,i)},lt.prototype.removeEventListener=lt.prototype.off,lt.prototype.one=function(e,i){var n=this.addEventListener;this.addEventListener=function(){},one(this,e,i),this.addEventListener=n},lt.prototype.any=function(e,i){var n=this.addEventListener;this.addEventListener=function(){},any(this,e,i),this.addEventListener=n},lt.prototype.trigger=function(e){var i=e.type||e;"string"==typeof e&&(e={"type":i}),e=fixEvent(e),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](e),trigger(this,e)},lt.prototype.dispatchEvent=lt.prototype.trigger,lt.prototype.queueTrigger=function(e){var i=this;at||(at=new Map);var n=e.type||e,a=at.get(this);a||(a=new Map,at.set(this,a));var o=a.get(n);a.delete(n),s.a.clearTimeout(o);var u=s.a.setTimeout((function(){0===a.size&&(a=null,at.delete(i)),i.trigger(e)}),0);a.set(n,u)};var ct=function objName(e){return"function"==typeof e.name?e.name():"string"==typeof e.name?e.name:e.name_?e.name_:e.constructor&&e.constructor.name?e.constructor.name:typeof e},dt=function isEvented(e){return e instanceof lt||!!e.eventBusEl_&&["on","one","off","trigger"].every((function(i){return"function"==typeof e[i]}))},ht=function isValidEventType(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},pt=function validateTarget(e,i,n){if(!e||!e.nodeName&&!dt(e))throw new Error("Invalid target for "+ct(i)+"#"+n+"; must be a DOM node or evented object.")},ft=function validateEventType(e,i,n){if(!ht(e))throw new Error("Invalid event type for "+ct(i)+"#"+n+"; must be a non-empty string or array.")},mt=function validateListener(e,i,n){if("function"!=typeof e)throw new Error("Invalid listener for "+ct(i)+"#"+n+"; must be a function.")},gt=function normalizeListenArgs(e,i,n){var a,s,o,u=i.length<3||i[0]===e||i[0]===e.eventBusEl_;return u?(a=e.eventBusEl_,i.length>=3&&i.shift(),s=i[0],o=i[1]):(a=i[0],s=i[1],o=i[2]),pt(a,e,n),ft(s,e,n),mt(o,e,n),{"isTargetingSelf":u,"target":a,"type":s,"listener":o=ot(e,o)}},vt=function listen(e,i,n,a){pt(e,e,i),e.nodeName?st[i](e,n,a):e[i](n,a)},yt={"on":function on(){for(var e=this,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];var s=gt(this,n,"on"),o=s.isTargetingSelf,u=s.target,l=s.type,c=s.listener;if(vt(u,"on",l,c),!o){var h=function removeListenerOnDispose(){return e.off(u,l,c)};h.guid=c.guid;var f=function removeRemoverOnTargetDispose(){return e.off("dispose",h)};f.guid=c.guid,vt(this,"on","dispose",h),vt(u,"on","dispose",f)}},"one":function one(){for(var e=this,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];var s=gt(this,n,"one"),o=s.isTargetingSelf,u=s.target,l=s.type,c=s.listener;if(o)vt(u,"one",l,c);else{var h=function wrapper(){e.off(u,l,wrapper);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];c.apply(null,n)};h.guid=c.guid,vt(u,"one",l,h)}},"any":function any(){for(var e=this,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];var s=gt(this,n,"any"),o=s.isTargetingSelf,u=s.target,l=s.type,c=s.listener;if(o)vt(u,"any",l,c);else{var h=function wrapper(){e.off(u,l,wrapper);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];c.apply(null,n)};h.guid=c.guid,vt(u,"any",l,h)}},"off":function off$1(e,i,n){if(!e||ht(e))off(this.eventBusEl_,e,i);else{var a=e,s=i;pt(a,this,"off"),ft(s,this,"off"),mt(n,this,"off"),n=ot(this,n),this.off("dispose",n),a.nodeName?(off(a,s,n),off(a,"dispose",n)):dt(a)&&(a.off(s,n),a.off("dispose",n))}},"trigger":function trigger$1(e,i){pt(this.eventBusEl_,this,"trigger");var n=e&&"string"!=typeof e?e.type:e;if(!ht(n)){var a="Invalid event type for "+ct(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(!e)throw new Error(a);(this.log||He).error(a)}return trigger(this.eventBusEl_,e,i)}};function evented(e,i){void 0===i&&(i={});var n=i.eventBusKey;if(n){if(!e[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');e.eventBusEl_=e[n]}else e.eventBusEl_=video_es_createEl("span",{"className":"vjs-event-bus"});return video_es_assign(e,yt),e.eventedCallbacks&&e.eventedCallbacks.forEach((function(e){e()})),e.on("dispose",(function(){e.off(),s.a.setTimeout((function(){e.eventBusEl_=null}),0)})),e}var _t={"state":{},"setState":function setState(e){var i,n=this;return"function"==typeof e&&(e=e()),each(e,(function(e,a){n.state[a]!==e&&((i=i||{})[a]={"from":n.state[a],"to":e}),n.state[a]=e})),i&&dt(this)&&this.trigger({"changes":i,"type":"statechanged"}),i}};function stateful(e,i){return video_es_assign(e,_t),e.state=video_es_assign({},e.state,i),"function"==typeof e.handleStateChanged&&dt(e)&&e.on("statechanged",e.handleStateChanged),e}var Tt=function toLowerCase(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toLowerCase()}))},bt=function toTitleCase(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toUpperCase()}))};function mergeOptions(){for(var e={},i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return n.forEach((function(i){i&&each(i,(function(i,n){isPlain(i)?(isPlain(e[n])||(e[n]={}),e[n]=mergeOptions(e[n],i)):e[n]=i}))})),e}var St=function(){function MapSham(){this.map_={}}var e=MapSham.prototype;return e.has=function has(e){return e in this.map_},e.delete=function _delete(e){var i=this.has(e);return delete this.map_[e],i},e.set=function set(e,i){return this.map_[e]=i,this},e.forEach=function forEach(e,i){for(var n in this.map_)e.call(i,this.map_[n],n,this)},MapSham}(),Ct=s.a.Map?s.a.Map:St,kt=function(){function SetSham(){this.set_={}}var e=SetSham.prototype;return e.has=function has(e){return e in this.set_},e.delete=function _delete(e){var i=this.has(e);return delete this.set_[e],i},e.add=function add(e){return this.set_[e]=1,this},e.forEach=function forEach(e,i){for(var n in this.set_)e.call(i,n,n,this)},SetSham}(),Et=s.a.Set?s.a.Set:kt,wt=function(){function Component(e,i,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=mergeOptions({},this.options_),i=this.options_=mergeOptions(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){var a=e&&e.id&&e.id()||"no_player";this.id_=a+"_component_"+newGUID()}this.name_=i.name||null,i.el?this.el_=i.el:!1!==i.createEl&&(this.el_=this.createEl()),!1!==i.evented&&(evented(this,{"eventBusKey":this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),stateful(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Et,this.setIntervalIds_=new Et,this.rafIds_=new Et,this.namedRafs_=new Ct,this.clearingTimersOnDispose_=!1,!1!==i.initChildren&&this.initChildren(),this.ready(n),!1!==i.reportTouchActivity&&this.enableTouchActivity()}var e=Component.prototype;return e.dispose=function dispose(){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({"type":"dispose","bubbles":!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),nt.has(this.el_)&&nt.delete(this.el_),this.el_=null),this.player_=null}},e.isDisposed=function isDisposed(){return Boolean(this.isDisposed_)},e.player=function player(){return this.player_},e.options=function options(e){return e?(this.options_=mergeOptions(this.options_,e),this.options_):this.options_},e.el=function el(){return this.el_},e.createEl=function createEl$1(e,i,n){return video_es_createEl(e,i,n)},e.localize=function localize(e,i,n){void 0===n&&(n=e);var a=this.player_.language&&this.player_.language(),s=this.player_.languages&&this.player_.languages(),o=s&&s[a],u=a&&a.split("-")[0],l=s&&s[u],c=n;return o&&o[e]?c=o[e]:l&&l[e]&&(c=l[e]),i&&(c=c.replace(/\{(\d+)\}/g,(function(e,n){var a=i[n-1],s=a;return void 0===a&&(s=e),s}))),c},e.handleLanguagechange=function handleLanguagechange(){},e.contentEl=function contentEl(){return this.contentEl_||this.el_},e.id=function id(){return this.id_},e.name=function name(){return this.name_},e.children=function children(){return this.children_},e.getChildById=function getChildById(e){return this.childIndex_[e]},e.getChild=function getChild(e){if(e)return this.childNameIndex_[e]},e.getDescendant=function getDescendant(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i=i.reduce((function(e,i){return e.concat(i)}),[]);for(var a=this,s=0;s<i.length;s++)if(!(a=a.getChild(i[s]))||!a.getChild)return;return a},e.addChild=function addChild(e,i,n){var a,s;if(void 0===i&&(i={}),void 0===n&&(n=this.children_.length),"string"==typeof e){s=bt(e);var o=i.componentClass||s;i.name=s;var u=Component.getComponent(o);if(!u)throw new Error("Component "+o+" does not exist");if("function"!=typeof u)return null;a=new u(this.player_||this,i)}else a=e;if(a.parentComponent_&&a.parentComponent_.removeChild(a),this.children_.splice(n,0,a),a.parentComponent_=this,"function"==typeof a.id&&(this.childIndex_[a.id()]=a),(s=s||a.name&&bt(a.name()))&&(this.childNameIndex_[s]=a,this.childNameIndex_[Tt(s)]=a),"function"==typeof a.el&&a.el()){var l=null;this.children_[n+1]&&(this.children_[n+1].el_?l=this.children_[n+1].el_:isEl(this.children_[n+1])&&(l=this.children_[n+1])),this.contentEl().insertBefore(a.el(),l)}return a},e.removeChild=function removeChild(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var i=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){i=!0,this.children_.splice(n,1);break}if(i){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[bt(e.name())]=null,this.childNameIndex_[Tt(e.name())]=null;var a=e.el();a&&a.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},e.initChildren=function initChildren(){var e=this,i=this.options_.children;if(i){var n,a=this.options_,s=Component.getComponent("Tech");(n=Array.isArray(i)?i:Object.keys(i)).concat(Object.keys(this.options_).filter((function(e){return!n.some((function(i){return"string"==typeof i?e===i:e===i.name}))}))).map((function(n){var a,s;return"string"==typeof n?s=i[a=n]||e.options_[a]||{}:(a=n.name,s=n),{"name":a,"opts":s}})).filter((function(e){var i=Component.getComponent(e.opts.componentClass||bt(e.name));return i&&!s.isTech(i)})).forEach((function handleAdd(i){var n=i.name,s=i.opts;if(void 0!==a[n]&&(s=a[n]),!1!==s){!0===s&&(s={}),s.playerOptions=e.options_.playerOptions;var o=e.addChild(n,s);o&&(e[n]=o)}}))}},e.buildCSSClass=function buildCSSClass(){return""},e.ready=function ready(e,i){if(void 0===i&&(i=!1),e)return this.isReady_?void(i?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},e.triggerReady=function triggerReady(){this.isReady_=!0,this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach((function(e){e.call(this)}),this),this.trigger("ready")}),1)},e.$=function $$1(e,i){return Ge(e,i||this.contentEl())},e.$$=function $$$1(e,i){return Xe(e,i||this.contentEl())},e.hasClass=function hasClass$1(e){return hasClass(this.el_,e)},e.addClass=function addClass$1(e){addClass(this.el_,e)},e.removeClass=function removeClass$1(e){removeClass(this.el_,e)},e.toggleClass=function toggleClass$1(e,i){toggleClass(this.el_,e,i)},e.show=function show(){this.removeClass("vjs-hidden")},e.hide=function hide(){this.addClass("vjs-hidden")},e.lockShowing=function lockShowing(){this.addClass("vjs-lock-showing")},e.unlockShowing=function unlockShowing(){this.removeClass("vjs-lock-showing")},e.getAttribute=function getAttribute$1(e){return getAttribute(this.el_,e)},e.setAttribute=function setAttribute$1(e,i){setAttribute(this.el_,e,i)},e.removeAttribute=function removeAttribute$1(e){removeAttribute(this.el_,e)},e.width=function width(e,i){return this.dimension("width",e,i)},e.height=function height(e,i){return this.dimension("height",e,i)},e.dimensions=function dimensions(e,i){this.width(e,!0),this.height(i)},e.dimension=function dimension(e,i,n){if(void 0!==i)return null!==i&&i==i||(i=0),-1!==(""+i).indexOf("%")||-1!==(""+i).indexOf("px")?this.el_.style[e]=i:this.el_.style[e]="auto"===i?"":i+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var a=this.el_.style[e],s=a.indexOf("px");return-1!==s?parseInt(a.slice(0,s),10):parseInt(this.el_["offset"+bt(e)],10)},e.currentDimension=function currentDimension(e){var i=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(i=computedStyle(this.el_,e),0===(i=parseFloat(i))||isNaN(i)){var n="offset"+bt(e);i=this.el_[n]}return i},e.currentDimensions=function currentDimensions(){return{"width":this.currentDimension("width"),"height":this.currentDimension("height")}},e.currentWidth=function currentWidth(){return this.currentDimension("width")},e.currentHeight=function currentHeight(){return this.currentDimension("height")},e.focus=function focus(){this.el_.focus()},e.blur=function blur(){this.el_.blur()},e.handleKeyDown=function handleKeyDown(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},e.handleKeyPress=function handleKeyPress(e){this.handleKeyDown(e)},e.emitTapEvents=function emitTapEvents(){var e,i=0,n=null;this.on("touchstart",(function(a){1===a.touches.length&&(n={"pageX":a.touches[0].pageX,"pageY":a.touches[0].pageY},i=s.a.performance.now(),e=!0)})),this.on("touchmove",(function(i){if(i.touches.length>1)e=!1;else if(n){var a=i.touches[0].pageX-n.pageX,s=i.touches[0].pageY-n.pageY;Math.sqrt(a*a+s*s)>10&&(e=!1)}}));var a=function noTap(){e=!1};this.on("touchleave",a),this.on("touchcancel",a),this.on("touchend",(function(a){(n=null,!0===e)&&(s.a.performance.now()-i<200&&(a.preventDefault(),this.trigger("tap")))}))},e.enableTouchActivity=function enableTouchActivity(){if(this.player()&&this.player().reportUserActivity){var e,i=ot(this.player(),this.player().reportUserActivity);this.on("touchstart",(function(){i(),this.clearInterval(e),e=this.setInterval(i,250)}));var n=function touchEnd(n){i(),this.clearInterval(e)};this.on("touchmove",i),this.on("touchend",n),this.on("touchcancel",n)}},e.setTimeout=function setTimeout(e,i){var n,a=this;return e=ot(this,e),this.clearTimersOnDispose_(),n=s.a.setTimeout((function(){a.setTimeoutIds_.has(n)&&a.setTimeoutIds_.delete(n),e()}),i),this.setTimeoutIds_.add(n),n},e.clearTimeout=function clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),s.a.clearTimeout(e)),e},e.setInterval=function setInterval(e,i){e=ot(this,e),this.clearTimersOnDispose_();var n=s.a.setInterval(e,i);return this.setIntervalIds_.add(n),n},e.clearInterval=function clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),s.a.clearInterval(e)),e},e.requestAnimationFrame=function requestAnimationFrame(e){var i,n=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),e=ot(this,e),i=s.a.requestAnimationFrame((function(){n.rafIds_.has(i)&&n.rafIds_.delete(i),e()})),this.rafIds_.add(i),i):this.setTimeout(e,1e3/60)},e.requestNamedAnimationFrame=function requestNamedAnimationFrame(e,i){var n=this;if(!this.namedRafs_.has(e)){this.clearTimersOnDispose_(),i=ot(this,i);var a=this.requestAnimationFrame((function(){i(),n.namedRafs_.has(e)&&n.namedRafs_.delete(e)}));return this.namedRafs_.set(e,a),e}},e.cancelNamedAnimationFrame=function cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))},e.cancelAnimationFrame=function cancelAnimationFrame(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_.delete(e),s.a.cancelAnimationFrame(e)),e):this.clearTimeout(e)},e.clearTimersOnDispose_=function clearTimersOnDispose_(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(i){var n=i[0],a=i[1];e[n].forEach((function(i,n){return e[a](n)}))})),e.clearingTimersOnDispose_=!1})))},Component.registerComponent=function registerComponent(e,i){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var n,a=Component.getComponent("Tech"),s=a&&a.isTech(i),o=Component===i||Component.prototype.isPrototypeOf(i.prototype);if(s||!o)throw n=s?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+e+'"; '+n+".");e=bt(e),Component.components_||(Component.components_={});var u=Component.getComponent("Player");if("Player"===e&&u&&u.players){var l=u.players,c=Object.keys(l);if(l&&c.length>0&&c.map((function(e){return l[e]})).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return Component.components_[e]=i,Component.components_[Tt(e)]=i,i},Component.getComponent=function getComponent(e){if(e&&Component.components_)return Component.components_[e]},Component}();wt.prototype.supportsRaf_="function"==typeof s.a.requestAnimationFrame&&"function"==typeof s.a.cancelAnimationFrame,wt.registerComponent("Component",wt);var Pt,It=s.a.navigator&&s.a.navigator.userAgent||"",xt=/AppleWebKit\/([\d.]+)/i.exec(It),At=xt?parseFloat(xt.pop()):null,Lt=/iPod/i.test(It),Dt=(Pt=It.match(/OS (\d+)_/i))&&Pt[1]?Pt[1]:null,Ot=/Android/i.test(It),Mt=function(){var e=It.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var i=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return i&&n?parseFloat(e[1]+"."+e[2]):i||null}(),Rt=Ot&&Mt<5&&At<537,Bt=/Firefox/i.test(It),Nt=/Edg/i.test(It),Ut=!Nt&&(/Chrome/i.test(It)||/CriOS/i.test(It)),jt=function(){var e=It.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),Ft=function(){var e=/MSIE\s(\d+)\.\d/.exec(It),i=e&&parseFloat(e[1]);return!i&&/Trident\/7.0/i.test(It)&&/rv:11.0/.test(It)&&(i=11),i}(),Vt=/Safari/i.test(It)&&!Ut&&!Ot&&!Nt,Ht=/Windows/i.test(It),Wt=Boolean(isReal()&&("ontouchstart"in s.a||s.a.navigator.maxTouchPoints||s.a.DocumentTouch&&s.a.document instanceof s.a.DocumentTouch)),qt=/iPad/i.test(It)||Vt&&Wt&&!/iPhone/i.test(It),$t=/iPhone/i.test(It)&&!qt,zt=$t||qt||Lt,Gt=(Vt||zt)&&!Ut,Xt=Object.freeze({"__proto__":null,"IS_IPOD":Lt,"IOS_VERSION":Dt,"IS_ANDROID":Ot,"ANDROID_VERSION":Mt,"IS_NATIVE_ANDROID":Rt,"IS_FIREFOX":Bt,"IS_EDGE":Nt,"IS_CHROME":Ut,"CHROME_VERSION":jt,"IE_VERSION":Ft,"IS_SAFARI":Vt,"IS_WINDOWS":Ht,"TOUCH_ENABLED":Wt,"IS_IPAD":qt,"IS_IPHONE":$t,"IS_IOS":zt,"IS_ANY_SAFARI":Gt});function getRange(e,i,n,a){return function rangeCheck(e,i,n){if("number"!=typeof i||i<0||i>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+i+") is non-numeric or out of bounds (0-"+n+").")}(e,a,n.length-1),n[a][i]}function createTimeRangesObj(e){return void 0===e||0===e.length?{"length":0,"start":function start(){throw new Error("This TimeRanges object is empty")},"end":function end(){throw new Error("This TimeRanges object is empty")}}:{"length":e.length,"start":getRange.bind(null,"start",0,e),"end":getRange.bind(null,"end",1,e)}}function createTimeRanges(e,i){return Array.isArray(e)?createTimeRangesObj(e):void 0===e||void 0===i?createTimeRangesObj():createTimeRangesObj([[e,i]])}function bufferedPercent(e,i){var n,a,s=0;if(!i)return 0;e&&e.length||(e=createTimeRanges(0,0));for(var o=0;o<e.length;o++)n=e.start(o),(a=e.end(o))>i&&(a=i),s+=a-n;return s/i}for(var Kt,Yt={"prefixed":!0},Qt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Jt=Qt[0],Zt=0;Zt<Qt.length;Zt++)if(Qt[Zt][1]in u.a){Kt=Qt[Zt];break}if(Kt){for(var ei=0;ei<Kt.length;ei++)Yt[Jt[ei]]=Kt[ei];Yt.prefixed=Kt[0]!==Jt[0]}function MediaError(e){if(e instanceof MediaError)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:video_es_isObject(e)&&("number"==typeof e.code&&(this.code=e.code),video_es_assign(this,e)),this.message||(this.message=MediaError.defaultMessages[this.code]||"")}MediaError.prototype.code=0,MediaError.prototype.message="",MediaError.prototype.status=null,MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],MediaError.defaultMessages={"1":"You aborted the media playback","2":"A network error caused the media download to fail part-way.","3":"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.","4":"The media could not be loaded, either because the server or network failed or because the format is not supported.","5":"The media is encrypted and we do not have the keys to decrypt it."};for(var ti=0;ti<MediaError.errorTypes.length;ti++)MediaError[MediaError.errorTypes[ti]]=ti,MediaError.prototype[MediaError.errorTypes[ti]]=ti;function isPromise(e){return null!=e&&"function"==typeof e.then}function silencePromise(e){isPromise(e)&&e.then(null,(function(e){}))}var ii=function trackToJson_(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(i,n,a){return e[n]&&(i[n]=e[n]),i}),{"cues":e.cues&&Array.prototype.map.call(e.cues,(function(e){return{"startTime":e.startTime,"endTime":e.endTime,"text":e.text,"id":e.id}}))})},ni=function textTracksToJson(e){var i=e.$$("track"),n=Array.prototype.map.call(i,(function(e){return e.track}));return Array.prototype.map.call(i,(function(e){var i=ii(e.track);return e.src&&(i.src=e.src),i})).concat(Array.prototype.filter.call(e.textTracks(),(function(e){return-1===n.indexOf(e)})).map(ii))},ri=function jsonToTextTracks(e,i){return e.forEach((function(e){var n=i.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach((function(e){return n.addCue(e)}))})),i.textTracks()},ai=function(e){function ModalDialog(i,n){var a;return(a=e.call(this,i,n)||this).opened_=a.hasBeenOpened_=a.hasBeenFilled_=!1,a.closeable(!a.options_.uncloseable),a.content(a.options_.content),a.contentEl_=video_es_createEl("div",{"className":"vjs-modal-dialog-content"},{"role":"document"}),a.descEl_=video_es_createEl("p",{"className":"vjs-modal-dialog-description vjs-control-text","id":a.el().getAttribute("aria-describedby")}),textContent(a.descEl_,a.description()),a.el_.appendChild(a.descEl_),a.el_.appendChild(a.contentEl_),a}g()(ModalDialog,e);var i=ModalDialog.prototype;return i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":this.buildCSSClass(),"tabIndex":-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),"role":"dialog"})},i.dispose=function dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,e.prototype.dispose.call(this)},i.buildCSSClass=function buildCSSClass(){return"vjs-modal-dialog vjs-hidden "+e.prototype.buildCSSClass.call(this)},i.label=function label(){return this.localize(this.options_.label||"Modal Window")},i.description=function description(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},i.open=function open(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},i.opened=function opened(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},i.close=function close(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},i.closeable=function closeable(e){if("boolean"==typeof e){var closeable=this.closeable_=!!e,i=this.getChild("closeButton");if(closeable&&!i){var n=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{"controlText":"Close Modal Dialog"}),this.contentEl_=n,this.on(i,"close",this.close)}!closeable&&i&&(this.off(i,"close",this.close),this.removeChild(i),i.dispose())}return this.closeable_},i.fill=function fill(){this.fillWith(this.content())},i.fillWith=function fillWith(e){var i=this.contentEl(),n=i.parentNode,a=i.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(i),this.empty(),insertContent(i,e),this.trigger("modalfill"),a?n.insertBefore(i,a):n.appendChild(i);var s=this.getChild("closeButton");s&&n.appendChild(s.el_)},i.empty=function empty(){this.trigger("beforemodalempty"),emptyEl(this.contentEl()),this.trigger("modalempty")},i.content=function content(e){return void 0!==e&&(this.content_=e),this.content_},i.conditionalFocus_=function conditionalFocus_(){var e=u.a.activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,(i.contains(e)||i===e)&&(this.previouslyActiveEl_=e,this.focus())},i.conditionalBlur_=function conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},i.handleKeyDown=function handleKeyDown(e){if(e.stopPropagation(),T.a.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(T.a.isEventKey(e,"Tab")){for(var i,n=this.focusableEls_(),a=this.el_.querySelector(":focus"),s=0;s<n.length;s++)if(a===n[s]){i=s;break}u.a.activeElement===this.el_&&(i=0),e.shiftKey&&0===i?(n[n.length-1].focus(),e.preventDefault()):e.shiftKey||i!==n.length-1||(n[0].focus(),e.preventDefault())}},i.focusableEls_=function focusableEls_(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,(function(e){return(e instanceof s.a.HTMLAnchorElement||e instanceof s.a.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof s.a.HTMLInputElement||e instanceof s.a.HTMLSelectElement||e instanceof s.a.HTMLTextAreaElement||e instanceof s.a.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof s.a.HTMLIFrameElement||e instanceof s.a.HTMLObjectElement||e instanceof s.a.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")}))},ModalDialog}(wt);ai.prototype.options_={"pauseOnOpen":!0,"temporary":!0},wt.registerComponent("ModalDialog",ai);var si=function(e){function TrackList(i){var n;void 0===i&&(i=[]),(n=e.call(this)||this).tracks_=[],Object.defineProperty(f()(n),"length",{"get":function get(){return this.tracks_.length}});for(var a=0;a<i.length;a++)n.addTrack(i[a]);return n}g()(TrackList,e);var i=TrackList.prototype;return i.addTrack=function addTrack(e){var i=this,n=this.tracks_.length;""+n in this||Object.defineProperty(this,n,{"get":function get(){return this.tracks_[n]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({"track":e,"type":"addtrack","target":this})),e.labelchange_=function(){i.trigger({"track":e,"type":"labelchange","target":i})},dt(e)&&e.addEventListener("labelchange",e.labelchange_)},i.removeTrack=function removeTrack(e){for(var i,n=0,a=this.length;n<a;n++)if(this[n]===e){(i=this[n]).off&&i.off(),this.tracks_.splice(n,1);break}i&&this.trigger({"track":i,"type":"removetrack","target":this})},i.getTrackById=function getTrackById(e){for(var i=null,n=0,a=this.length;n<a;n++){var s=this[n];if(s.id===e){i=s;break}}return i},TrackList}(lt);for(var oi in si.prototype.allowedEvents_={"change":"change","addtrack":"addtrack","removetrack":"removetrack","labelchange":"labelchange"},si.prototype.allowedEvents_)si.prototype["on"+oi]=null;var ui=function disableOthers(e,i){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&i.id!==e[n].id&&(e[n].enabled=!1)},li=function(e){function AudioTrackList(i){var n;void 0===i&&(i=[]);for(var a=i.length-1;a>=0;a--)if(i[a].enabled){ui(i,i[a]);break}return(n=e.call(this,i)||this).changing_=!1,n}g()(AudioTrackList,e);var i=AudioTrackList.prototype;return i.addTrack=function addTrack(i){var n=this;i.enabled&&ui(this,i),e.prototype.addTrack.call(this,i),i.addEventListener&&(i.enabledChange_=function(){n.changing_||(n.changing_=!0,ui(n,i),n.changing_=!1,n.trigger("change"))},i.addEventListener("enabledchange",i.enabledChange_))},i.removeTrack=function removeTrack(i){e.prototype.removeTrack.call(this,i),i.removeEventListener&&i.enabledChange_&&(i.removeEventListener("enabledchange",i.enabledChange_),i.enabledChange_=null)},AudioTrackList}(si),ci=function disableOthers(e,i){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&i.id!==e[n].id&&(e[n].selected=!1)},di=function(e){function VideoTrackList(i){var n;void 0===i&&(i=[]);for(var a=i.length-1;a>=0;a--)if(i[a].selected){ci(i,i[a]);break}return(n=e.call(this,i)||this).changing_=!1,Object.defineProperty(f()(n),"selectedIndex",{"get":function get(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},"set":function set(){}}),n}g()(VideoTrackList,e);var i=VideoTrackList.prototype;return i.addTrack=function addTrack(i){var n=this;i.selected&&ci(this,i),e.prototype.addTrack.call(this,i),i.addEventListener&&(i.selectedChange_=function(){n.changing_||(n.changing_=!0,ci(n,i),n.changing_=!1,n.trigger("change"))},i.addEventListener("selectedchange",i.selectedChange_))},i.removeTrack=function removeTrack(i){e.prototype.removeTrack.call(this,i),i.removeEventListener&&i.selectedChange_&&(i.removeEventListener("selectedchange",i.selectedChange_),i.selectedChange_=null)},VideoTrackList}(si),hi=function(e){function TextTrackList(){return e.apply(this,arguments)||this}g()(TextTrackList,e);var i=TextTrackList.prototype;return i.addTrack=function addTrack(i){var n=this;e.prototype.addTrack.call(this,i),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),i.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(i.kind)&&i.addEventListener("modechange",this.triggerSelectedlanguagechange_)},i.removeTrack=function removeTrack(i){e.prototype.removeTrack.call(this,i),i.removeEventListener&&(this.queueChange_&&i.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&i.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},TextTrackList}(si),pi=function(){function HtmlTrackElementList(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{"get":function get(){return this.trackElements_.length}});for(var i=0,n=e.length;i<n;i++)this.addTrackElement_(e[i])}var e=HtmlTrackElementList.prototype;return e.addTrackElement_=function addTrackElement_(e){var i=this.trackElements_.length;""+i in this||Object.defineProperty(this,i,{"get":function get(){return this.trackElements_[i]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},e.getTrackElementByTrack_=function getTrackElementByTrack_(e){for(var i,n=0,a=this.trackElements_.length;n<a;n++)if(e===this.trackElements_[n].track){i=this.trackElements_[n];break}return i},e.removeTrackElement_=function removeTrackElement_(e){for(var i=0,n=this.trackElements_.length;i<n;i++)if(e===this.trackElements_[i]){this.trackElements_[i].track&&"function"==typeof this.trackElements_[i].track.off&&this.trackElements_[i].track.off(),"function"==typeof this.trackElements_[i].off&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}},HtmlTrackElementList}(),fi=function(){function TextTrackCueList(e){TextTrackCueList.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{"get":function get(){return this.length_}})}var e=TextTrackCueList.prototype;return e.setCues_=function setCues_(e){var i=this.length||0,n=0,a=e.length;this.cues_=e,this.length_=e.length;var s=function defineProp(e){""+e in this||Object.defineProperty(this,""+e,{"get":function get(){return this.cues_[e]}})};if(i<a)for(n=i;n<a;n++)s.call(this,n)},e.getCueById=function getCueById(e){for(var i=null,n=0,a=this.length;n<a;n++){var s=this[n];if(s.id===e){i=s;break}}return i},TextTrackCueList}(),mi={"alternative":"alternative","captions":"captions","main":"main","sign":"sign","subtitles":"subtitles","commentary":"commentary"},gi={"alternative":"alternative","descriptions":"descriptions","main":"main","main-desc":"main-desc","translation":"translation","commentary":"commentary"},vi={"subtitles":"subtitles","captions":"captions","descriptions":"descriptions","chapters":"chapters","metadata":"metadata"},yi={"disabled":"disabled","hidden":"hidden","showing":"showing"},_i=function(e){function Track(i){var n;void 0===i&&(i={}),n=e.call(this)||this;var a={"id":i.id||"vjs_track_"+newGUID(),"kind":i.kind||"","language":i.language||""},s=i.label||"",o=function _loop(e){Object.defineProperty(f()(n),e,{"get":function get(){return a[e]},"set":function set(){}})};for(var u in a)o(u);return Object.defineProperty(f()(n),"label",{"get":function get(){return s},"set":function set(e){e!==s&&(s=e,this.trigger("labelchange"))}}),n}return g()(Track,e),Track}(lt),Ti=function parseUrl(e){var i=["protocol","hostname","port","pathname","search","hash","host"],n=u.a.createElement("a");n.href=e;var a,o=""===n.host&&"file:"!==n.protocol;o&&((a=u.a.createElement("div")).innerHTML='<a href="'+e+'"></a>',n=a.firstChild,a.setAttribute("style","display:none; position:absolute;"),u.a.body.appendChild(a));for(var l={},c=0;c<i.length;c++)l[i[c]]=n[i[c]];return"http:"===l.protocol&&(l.host=l.host.replace(/:80$/,"")),"https:"===l.protocol&&(l.host=l.host.replace(/:443$/,"")),l.protocol||(l.protocol=s.a.location.protocol),o&&u.a.body.removeChild(a),l},bi=function getAbsoluteURL(e){if(!e.match(/^https?:\/\//)){var i=u.a.createElement("div");i.innerHTML='<a href="'+e+'">x</a>',e=i.firstChild.href}return e},Si=function getFileExtension(e){if("string"==typeof e){var i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(i)return i.pop().toLowerCase()}return""},Ci=function isCrossOrigin(e,i){void 0===i&&(i=s.a.location);var n=Ti(e);return(":"===n.protocol?i.protocol:n.protocol)+n.host!==i.protocol+i.host},ki=Object.freeze({"__proto__":null,"parseUrl":Ti,"getAbsoluteURL":bi,"getFileExtension":Si,"isCrossOrigin":Ci}),Ei=function parseCues(e,i){var n=new s.a.WebVTT.Parser(s.a,s.a.vttjs,s.a.WebVTT.StringDecoder()),a=[];n.oncue=function(e){i.addCue(e)},n.onparsingerror=function(e){a.push(e)},n.onflush=function(){i.trigger({"type":"loadeddata","target":i})},n.parse(e),a.length>0&&(s.a.console&&s.a.console.groupCollapsed&&s.a.console.groupCollapsed("Text Track parsing errors for "+i.src),a.forEach((function(e){return He.error(e)})),s.a.console&&s.a.console.groupEnd&&s.a.console.groupEnd()),n.flush()},wi=function loadTrack(e,i){var n={"uri":e},a=Ci(e);a&&(n.cors=a);var o="use-credentials"===i.tech_.crossOrigin();o&&(n.withCredentials=o),S()(n,ot(this,(function(e,n,a){if(e)return He.error(e,n);i.loaded_=!0,"function"!=typeof s.a.WebVTT?i.tech_&&i.tech_.any(["vttjsloaded","vttjserror"],(function(e){if("vttjserror"!==e.type)return Ei(a,i);He.error("vttjs failed to load, stopping trying to process "+i.src)})):Ei(a,i)})))},Pi=function(e){function TextTrack(i){var n;if(void 0===i&&(i={}),!i.tech)throw new Error("A tech was not provided.");var a=mergeOptions(i,{"kind":vi[i.kind]||"subtitles","language":i.language||i.srclang||""}),s=yi[a.mode]||"disabled",o=a.default;"metadata"!==a.kind&&"chapters"!==a.kind||(s="hidden"),(n=e.call(this,a)||this).tech_=a.tech,n.cues_=[],n.activeCues_=[],n.preload_=!1!==n.tech_.preloadTextTracks;var u=new fi(n.cues_),l=new fi(n.activeCues_),c=!1,h=ot(f()(n),(function(){this.tech_.isReady_&&!this.tech_.isDisposed()&&(this.activeCues=this.activeCues,c&&(this.trigger("cuechange"),c=!1))}));return n.tech_.one("dispose",(function disposeHandler(){n.tech_.off("timeupdate",h)})),"disabled"!==s&&n.tech_.on("timeupdate",h),Object.defineProperties(f()(n),{"default":{"get":function get(){return o},"set":function set(){}},"mode":{"get":function get(){return s},"set":function set(e){yi[e]&&s!==e&&(s=e,this.preload_||"disabled"===s||0!==this.cues.length||wi(this.src,this),this.tech_.off("timeupdate",h),"disabled"!==s&&this.tech_.on("timeupdate",h),this.trigger("modechange"))}},"cues":{"get":function get(){return this.loaded_?u:null},"set":function set(){}},"activeCues":{"get":function get(){if(!this.loaded_)return null;if(0===this.cues.length)return l;for(var e=this.tech_.currentTime(),i=[],n=0,a=this.cues.length;n<a;n++){var s=this.cues[n];(s.startTime<=e&&s.endTime>=e||s.startTime===s.endTime&&s.startTime<=e&&s.startTime+.5>=e)&&i.push(s)}if(c=!1,i.length!==this.activeCues_.length)c=!0;else for(var o=0;o<i.length;o++)-1===this.activeCues_.indexOf(i[o])&&(c=!0);return this.activeCues_=i,l.setCues_(this.activeCues_),l},"set":function set(){}}}),a.src?(n.src=a.src,n.preload_||(n.loaded_=!0),(n.preload_||o||"subtitles"!==a.kind&&"captions"!==a.kind)&&wi(n.src,f()(n))):n.loaded_=!0,n}g()(TextTrack,e);var i=TextTrack.prototype;return i.addCue=function addCue(e){var i=e;if(s.a.vttjs&&!(e instanceof s.a.vttjs.VTTCue)){for(var n in i=new s.a.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)n in i||(i[n]=e[n]);i.id=e.id,i.originalCue_=e}for(var a=this.tech_.textTracks(),o=0;o<a.length;o++)a[o]!==this&&a[o].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)},i.removeCue=function removeCue(e){for(var i=this.cues_.length;i--;){var n=this.cues_[i];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}},TextTrack}(_i);Pi.prototype.allowedEvents_={"cuechange":"cuechange"};var Ii=function(e){function AudioTrack(i){var n;void 0===i&&(i={});var a=mergeOptions(i,{"kind":gi[i.kind]||""});n=e.call(this,a)||this;var s=!1;return Object.defineProperty(f()(n),"enabled",{"get":function get(){return s},"set":function set(e){"boolean"==typeof e&&e!==s&&(s=e,this.trigger("enabledchange"))}}),a.enabled&&(n.enabled=a.enabled),n.loaded_=!0,n}return g()(AudioTrack,e),AudioTrack}(_i),xi=function(e){function VideoTrack(i){var n;void 0===i&&(i={});var a=mergeOptions(i,{"kind":mi[i.kind]||""});n=e.call(this,a)||this;var s=!1;return Object.defineProperty(f()(n),"selected",{"get":function get(){return s},"set":function set(e){"boolean"==typeof e&&e!==s&&(s=e,this.trigger("selectedchange"))}}),a.selected&&(n.selected=a.selected),n}return g()(VideoTrack,e),VideoTrack}(_i),Ai=function(e){function HTMLTrackElement(i){var n,a;void 0===i&&(i={}),n=e.call(this)||this;var s=new Pi(i);return n.kind=s.kind,n.src=s.src,n.srclang=s.language,n.label=s.label,n.default=s.default,Object.defineProperties(f()(n),{"readyState":{"get":function get(){return a}},"track":{"get":function get(){return s}}}),a=0,s.addEventListener("loadeddata",(function(){a=2,n.trigger({"type":"load","target":f()(n)})})),n}return g()(HTMLTrackElement,e),HTMLTrackElement}(lt);Ai.prototype.allowedEvents_={"load":"load"},Ai.NONE=0,Ai.LOADING=1,Ai.LOADED=2,Ai.ERROR=3;var Li={"audio":{"ListClass":li,"TrackClass":Ii,"capitalName":"Audio"},"video":{"ListClass":di,"TrackClass":xi,"capitalName":"Video"},"text":{"ListClass":hi,"TrackClass":Pi,"capitalName":"Text"}};Object.keys(Li).forEach((function(e){Li[e].getterName=e+"Tracks",Li[e].privateName=e+"Tracks_"}));var Di={"remoteText":{"ListClass":hi,"TrackClass":Pi,"capitalName":"RemoteText","getterName":"remoteTextTracks","privateName":"remoteTextTracks_"},"remoteTextEl":{"ListClass":pi,"TrackClass":Ai,"capitalName":"RemoteTextTrackEls","getterName":"remoteTextTrackEls","privateName":"remoteTextTrackEls_"}},Oi=c()({},Li,Di);Di.names=Object.keys(Di),Li.names=Object.keys(Li),Oi.names=[].concat(Di.names).concat(Li.names);var Mi=function(e){function Tech(i,n){var a;return void 0===i&&(i={}),void 0===n&&(n=function ready(){}),i.reportTouchActivity=!1,(a=e.call(this,null,i,n)||this).hasStarted_=!1,a.on("playing",(function(){this.hasStarted_=!0})),a.on("loadstart",(function(){this.hasStarted_=!1})),Oi.names.forEach((function(e){var n=Oi[e];i&&i[n.getterName]&&(a[n.privateName]=i[n.getterName])})),a.featuresProgressEvents||a.manualProgressOn(),a.featuresTimeupdateEvents||a.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((function(e){!1===i["native"+e+"Tracks"]&&(a["featuresNative"+e+"Tracks"]=!1)})),!1===i.nativeCaptions||!1===i.nativeTextTracks?a.featuresNativeTextTracks=!1:!0!==i.nativeCaptions&&!0!==i.nativeTextTracks||(a.featuresNativeTextTracks=!0),a.featuresNativeTextTracks||a.emulateTextTracks(),a.preloadTextTracks=!1!==i.preloadTextTracks,a.autoRemoteTextTracks_=new Oi.text.ListClass,a.initTrackListeners(),i.nativeControlsForTouch||a.emitTapEvents(),a.constructor&&(a.name_=a.constructor.name||"Unknown Tech"),a}g()(Tech,e);var i=Tech.prototype;return i.triggerSourceset=function triggerSourceset(e){var i=this;this.isReady_||this.one("ready",(function(){return i.setTimeout((function(){return i.triggerSourceset(e)}),1)})),this.trigger({"src":e,"type":"sourceset"})},i.manualProgressOn=function manualProgressOn(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},i.manualProgressOff=function manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},i.trackProgress=function trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ot(this,(function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()})),500)},i.onDurationChange=function onDurationChange(e){this.duration_=this.duration()},i.buffered=function buffered(){return createTimeRanges(0,0)},i.bufferedPercent=function bufferedPercent$1(){return bufferedPercent(this.buffered(),this.duration_)},i.stopTrackingProgress=function stopTrackingProgress(){this.clearInterval(this.progressInterval)},i.manualTimeUpdatesOn=function manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},i.manualTimeUpdatesOff=function manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},i.trackCurrentTime=function trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({"type":"timeupdate","target":this,"manuallyTriggered":!0})}),250)},i.stopTrackingCurrentTime=function stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({"type":"timeupdate","target":this,"manuallyTriggered":!0})},i.dispose=function dispose(){this.clearTracks(Li.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),e.prototype.dispose.call(this)},i.clearTracks=function clearTracks(e){var i=this;(e=[].concat(e)).forEach((function(e){for(var n=i[e+"Tracks"]()||[],a=n.length;a--;){var s=n[a];"text"===e&&i.removeRemoteTextTrack(s),n.removeTrack(s)}}))},i.cleanupAutoTextTracks=function cleanupAutoTextTracks(){for(var e=this.autoRemoteTextTracks_||[],i=e.length;i--;){var n=e[i];this.removeRemoteTextTrack(n)}},i.reset=function reset(){},i.crossOrigin=function crossOrigin(){},i.setCrossOrigin=function setCrossOrigin(){},i.error=function error(e){return void 0!==e&&(this.error_=new MediaError(e),this.trigger("error")),this.error_},i.played=function played(){return this.hasStarted_?createTimeRanges(0,0):createTimeRanges()},i.play=function play(){},i.setScrubbing=function setScrubbing(){},i.scrubbing=function scrubbing(){},i.setCurrentTime=function setCurrentTime(){this.manualTimeUpdates&&this.trigger({"type":"timeupdate","target":this,"manuallyTriggered":!0})},i.initTrackListeners=function initTrackListeners(){var e=this;Li.names.forEach((function(i){var n=Li[i],a=function trackListChanges(){e.trigger(i+"trackchange")},s=e[n.getterName]();s.addEventListener("removetrack",a),s.addEventListener("addtrack",a),e.on("dispose",(function(){s.removeEventListener("removetrack",a),s.removeEventListener("addtrack",a)}))}))},i.addWebVttScript_=function addWebVttScript_(){var e=this;if(!s.a.WebVTT)if(u.a.body.contains(this.el())){if(!this.options_["vtt.js"]&&isPlain(k.a)&&Object.keys(k.a).length>0)return void this.trigger("vttjsloaded");var i=u.a.createElement("script");i.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",i.onload=function(){e.trigger("vttjsloaded")},i.onerror=function(){e.trigger("vttjserror")},this.on("dispose",(function(){i.onload=null,i.onerror=null})),s.a.WebVTT=!0,this.el().parentNode.appendChild(i)}else this.ready(this.addWebVttScript_)},i.emulateTextTracks=function emulateTextTracks(){var e=this,i=this.textTracks(),n=this.remoteTextTracks(),a=function handleAddTrack(e){return i.addTrack(e.track)},s=function handleRemoveTrack(e){return i.removeTrack(e.track)};n.on("addtrack",a),n.on("removetrack",s),this.addWebVttScript_();var o=function updateDisplay(){return e.trigger("texttrackchange")},u=function textTracksChanges(){o();for(var e=0;e<i.length;e++){var n=i[e];n.removeEventListener("cuechange",o),"showing"===n.mode&&n.addEventListener("cuechange",o)}};u(),i.addEventListener("change",u),i.addEventListener("addtrack",u),i.addEventListener("removetrack",u),this.on("dispose",(function(){n.off("addtrack",a),n.off("removetrack",s),i.removeEventListener("change",u),i.removeEventListener("addtrack",u),i.removeEventListener("removetrack",u);for(var e=0;e<i.length;e++){i[e].removeEventListener("cuechange",o)}}))},i.addTextTrack=function addTextTrack(e,i,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function createTrackHelper(e,i,n,a,s){void 0===s&&(s={});var o=e.textTracks();s.kind=i,n&&(s.label=n),a&&(s.language=a),s.tech=e;var u=new Oi.text.TrackClass(s);return o.addTrack(u),u}(this,e,i,n)},i.createRemoteTextTrack=function createRemoteTextTrack(e){var i=mergeOptions(e,{"tech":this});return new Di.remoteTextEl.TrackClass(i)},i.addRemoteTextTrack=function addRemoteTextTrack(e,i){var n=this;void 0===e&&(e={});var a=this.createRemoteTextTrack(e);return!0!==i&&!1!==i&&(He.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),i=!0),this.remoteTextTrackEls().addTrackElement_(a),this.remoteTextTracks().addTrack(a.track),!0!==i&&this.ready((function(){return n.autoRemoteTextTracks_.addTrack(a.track)})),a},i.removeRemoteTextTrack=function removeRemoteTextTrack(e){var i=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(i),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},i.getVideoPlaybackQuality=function getVideoPlaybackQuality(){return{}},i.requestPictureInPicture=function requestPictureInPicture(){var e=this.options_.Promise||s.a.Promise;if(e)return e.reject()},i.disablePictureInPicture=function disablePictureInPicture(){return!0},i.setDisablePictureInPicture=function setDisablePictureInPicture(){},i.setPoster=function setPoster(){},i.playsinline=function playsinline(){},i.setPlaysinline=function setPlaysinline(){},i.overrideNativeAudioTracks=function overrideNativeAudioTracks(){},i.overrideNativeVideoTracks=function overrideNativeVideoTracks(){},i.canPlayType=function canPlayType(){return""},Tech.canPlayType=function canPlayType(){return""},Tech.canPlaySource=function canPlaySource(e,i){return Tech.canPlayType(e.type)},Tech.isTech=function isTech(e){return e.prototype instanceof Tech||e instanceof Tech||e===Tech},Tech.registerTech=function registerTech(e,i){if(Tech.techs_||(Tech.techs_={}),!Tech.isTech(i))throw new Error("Tech "+e+" must be a Tech");if(!Tech.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Tech.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=bt(e),Tech.techs_[e]=i,Tech.techs_[Tt(e)]=i,"Tech"!==e&&Tech.defaultTechOrder_.push(e),i},Tech.getTech=function getTech(e){if(e)return Tech.techs_&&Tech.techs_[e]?Tech.techs_[e]:(e=bt(e),s.a&&s.a.videojs&&s.a.videojs[e]?(He.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),s.a.videojs[e]):void 0)},Tech}(wt);Oi.names.forEach((function(e){var i=Oi[e];Mi.prototype[i.getterName]=function(){return this[i.privateName]=this[i.privateName]||new i.ListClass,this[i.privateName]}})),Mi.prototype.featuresVolumeControl=!0,Mi.prototype.featuresMuteControl=!0,Mi.prototype.featuresFullscreenResize=!1,Mi.prototype.featuresPlaybackRate=!1,Mi.prototype.featuresProgressEvents=!1,Mi.prototype.featuresSourceset=!1,Mi.prototype.featuresTimeupdateEvents=!1,Mi.prototype.featuresNativeTextTracks=!1,Mi.withSourceHandlers=function(e){e.registerSourceHandler=function(i,n){var a=e.sourceHandlers;a||(a=e.sourceHandlers=[]),void 0===n&&(n=a.length),a.splice(n,0,i)},e.canPlayType=function(i){for(var n,a=e.sourceHandlers||[],s=0;s<a.length;s++)if(n=a[s].canPlayType(i))return n;return""},e.selectSourceHandler=function(i,n){for(var a=e.sourceHandlers||[],s=0;s<a.length;s++)if(a[s].canHandleSource(i,n))return a[s];return null},e.canPlaySource=function(i,n){var a=e.selectSourceHandler(i,n);return a?a.canHandleSource(i,n):""};["seekable","seeking","duration"].forEach((function(e){var i=this[e];"function"==typeof i&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})}),e.prototype),e.prototype.setSource=function(i){var n=e.selectSourceHandler(i,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:He.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==e.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=n.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},wt.registerComponent("Tech",Mi),Mi.registerTech("Tech",Mi),Mi.defaultTechOrder_=[];var Ri={},Bi={},Ni={};function setSource(e,i,n){e.setTimeout((function(){return function setSourceHelper(e,i,n,a,s,o){void 0===e&&(e={});void 0===i&&(i=[]);void 0===s&&(s=[]);void 0===o&&(o=!1);var u=i,l=u[0],c=u.slice(1);if("string"==typeof l)setSourceHelper(e,Ri[l],n,a,s,o);else if(l){var h=function getOrCreateFactory(e,i){var n=Bi[e.id()],a=null;if(null==n)return a=i(e),Bi[e.id()]=[[i,a]],a;for(var s=0;s<n.length;s++){var o=n[s],u=o[0],l=o[1];u===i&&(a=l)}null===a&&(a=i(e),n.push([i,a]));return a}(a,l);if(!h.setSource)return s.push(h),setSourceHelper(e,c,n,a,s,o);h.setSource(video_es_assign({},e),(function(i,u){if(i)return setSourceHelper(e,c,n,a,s,o);s.push(h),setSourceHelper(u,e.type===u.type?c:Ri[u.type],n,a,s,o)}))}else c.length?setSourceHelper(e,c,n,a,s,o):o?n(e,s):setSourceHelper(e,Ri["*"],n,a,s,!0)}(i,Ri[i.type],n,e)}),1)}function mediate(e,i,n,a){void 0===a&&(a=null);var s="call"+bt(n),o=e.reduce(middlewareIterator(s),a),u=o===Ni,l=u?null:i[n](o);return function executeRight(e,i,n,a){for(var s=e.length-1;s>=0;s--){var o=e[s];o[i]&&o[i](a,n)}}(e,n,l,u),l}var Ui={"buffered":1,"currentTime":1,"duration":1,"muted":1,"played":1,"paused":1,"seekable":1,"volume":1},ji={"setCurrentTime":1,"setMuted":1,"setVolume":1},Fi={"play":1,"pause":1};function middlewareIterator(e){return function(i,n){return i===Ni?Ni:n[e]?n[e](i):i}}var Vi={"opus":"video/ogg","ogv":"video/ogg","mp4":"video/mp4","mov":"video/mp4","m4v":"video/mp4","mkv":"video/x-matroska","m4a":"audio/mp4","mp3":"audio/mpeg","aac":"audio/aac","caf":"audio/x-caf","flac":"audio/flac","oga":"audio/ogg","wav":"audio/wav","m3u8":"application/x-mpegURL","jpg":"image/jpeg","jpeg":"image/jpeg","gif":"image/gif","png":"image/png","svg":"image/svg+xml","webp":"image/webp"},Hi=function getMimetype(e){void 0===e&&(e="");var i=Si(e);return Vi[i.toLowerCase()]||""};function fixSource(e){if(!e.type){var i=Hi(e.src);i&&(e.type=i)}return e}var Wi=function(e){function MediaLoader(i,n,a){var s,o=mergeOptions({"createEl":!1},n);if(s=e.call(this,i,o,a)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)i.src(n.playerOptions.sources);else for(var u=0,l=n.playerOptions.techOrder;u<l.length;u++){var c=bt(l[u]),h=Mi.getTech(c);if(c||(h=wt.getComponent(c)),h&&h.isSupported()){i.loadTech_(c);break}}return s}return g()(MediaLoader,e),MediaLoader}(wt);wt.registerComponent("MediaLoader",Wi);var qi=function(e){function ClickableComponent(i,n){var a;return(a=e.call(this,i,n)||this).emitTapEvents(),a.enable(),a}g()(ClickableComponent,e);var i=ClickableComponent.prototype;return i.createEl=function createEl(i,n,a){void 0===i&&(i="div"),void 0===n&&(n={}),void 0===a&&(a={}),n=video_es_assign({"innerHTML":'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',"className":this.buildCSSClass(),"tabIndex":0},n),"button"===i&&He.error("Creating a ClickableComponent with an HTML element of "+i+" is not supported; use a Button instead."),a=video_es_assign({"role":"button"},a),this.tabIndex_=n.tabIndex;var s=e.prototype.createEl.call(this,i,n,a);return this.createControlTextEl(s),s},i.dispose=function dispose(){this.controlTextEl_=null,e.prototype.dispose.call(this)},i.createControlTextEl=function createControlTextEl(e){return this.controlTextEl_=video_es_createEl("span",{"className":"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},i.controlText=function controlText(e,i){if(void 0===i&&(i=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,textContent(this.controlTextEl_,n),this.nonIconControl||i.setAttribute("title",n)},i.buildCSSClass=function buildCSSClass(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},i.enable=function enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},i.disable=function disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},i.handleLanguagechange=function handleLanguagechange(){this.controlText(this.controlText_)},i.handleClick=function handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},i.handleKeyDown=function handleKeyDown(i){T.a.isEventKey(i,"Space")||T.a.isEventKey(i,"Enter")?(i.preventDefault(),i.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,i)},ClickableComponent}(wt);wt.registerComponent("ClickableComponent",qi);var $i=function(e){function PosterImage(i,n){var a;return(a=e.call(this,i,n)||this).update(),i.on("posterchange",ot(f()(a),a.update)),a}g()(PosterImage,e);var i=PosterImage.prototype;return i.dispose=function dispose(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},i.createEl=function createEl$1(){return video_es_createEl("div",{"className":"vjs-poster","tabIndex":-1})},i.update=function update(e){var i=this.player().poster();this.setSrc(i),i?this.show():this.hide()},i.setSrc=function setSrc(e){var i="";e&&(i='url("'+e+'")'),this.el_.style.backgroundImage=i},i.handleClick=function handleClick(e){if(this.player_.controls()){var i=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;!this.player_.tech(!0)||(Ft||Nt)&&i||this.player_.tech(!0).focus(),this.player_.paused()?silencePromise(this.player_.play()):this.player_.pause()}},PosterImage}(qi);wt.registerComponent("PosterImage",$i);var zi={"monospace":"monospace","sansSerif":"sans-serif","serif":"serif","monospaceSansSerif":'"Andale Mono", "Lucida Console", monospace',"monospaceSerif":'"Courier New", monospace',"proportionalSansSerif":"sans-serif","proportionalSerif":"serif","casual":'"Comic Sans MS", Impact, fantasy',"script":'"Monotype Corsiva", cursive',"smallcaps":'"Andale Mono", "Lucida Console", monospace, sans-serif'};function constructColor(e,i){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+i+")"}function tryUpdateStyle(e,i,n){try{e.style[i]=n}catch(e){return}}var Gi=function(e){function TextTrackDisplay(i,n,a){var o;o=e.call(this,i,n,a)||this;var u=ot(f()(o),o.updateDisplay);return i.on("loadstart",ot(f()(o),o.toggleDisplay)),i.on("texttrackchange",u),i.on("loadedmetadata",ot(f()(o),o.preselectTrack)),i.ready(ot(f()(o),(function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else{i.on("fullscreenchange",u),i.on("playerresize",u),s.a.addEventListener("orientationchange",u),i.on("dispose",(function(){return s.a.removeEventListener("orientationchange",u)}));for(var e=this.options_.playerOptions.tracks||[],n=0;n<e.length;n++)this.player_.addRemoteTextTrack(e[n],!0);this.preselectTrack()}}))),o}g()(TextTrackDisplay,e);var i=TextTrackDisplay.prototype;return i.preselectTrack=function preselectTrack(){for(var e,i,n,a={"captions":1,"subtitles":1},s=this.player_.textTracks(),o=this.player_.cache_.selectedLanguage,u=0;u<s.length;u++){var l=s[u];o&&o.enabled&&o.language&&o.language===l.language&&l.kind in a?l.kind===o.kind?n=l:n||(n=l):o&&!o.enabled?(n=null,e=null,i=null):l.default&&("descriptions"!==l.kind||e?l.kind in a&&!i&&(i=l):e=l)}n?n.mode="showing":i?i.mode="showing":e&&(e.mode="showing")},i.toggleDisplay=function toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},i.clearDisplay=function clearDisplay(){"function"==typeof s.a.WebVTT&&s.a.WebVTT.processCues(s.a,[],this.el_)},i.updateDisplay=function updateDisplay(){var e=this.player_.textTracks(),i=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),i){for(var n=[],a=0;a<e.length;++a){var s=e[a];"showing"===s.mode&&n.push(s)}this.updateForTrack(n)}else{for(var o=null,u=null,l=e.length;l--;){var c=e[l];"showing"===c.mode&&("descriptions"===c.kind?o=c:u=c)}u?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(u)):o&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(o))}},i.updateDisplayState=function updateDisplayState(e){for(var i=this.player_.textTrackSettings.getValues(),n=e.activeCues,a=n.length;a--;){var o=n[a];if(o){var u=o.displayState;if(i.color&&(u.firstChild.style.color=i.color),i.textOpacity&&tryUpdateStyle(u.firstChild,"color",constructColor(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(u.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&tryUpdateStyle(u.firstChild,"backgroundColor",constructColor(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?tryUpdateStyle(u,"backgroundColor",constructColor(i.windowColor,i.windowOpacity)):u.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?u.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===i.edgeStyle?u.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===i.edgeStyle?u.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===i.edgeStyle&&(u.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),i.fontPercent&&1!==i.fontPercent){var l=s.a.parseFloat(u.style.fontSize);u.style.fontSize=l*i.fontPercent+"px",u.style.height="auto",u.style.top="auto"}i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?u.firstChild.style.fontVariant="small-caps":u.firstChild.style.fontFamily=zi[i.fontFamily])}}},i.updateForTrack=function updateForTrack(e){if(Array.isArray(e)||(e=[e]),"function"==typeof s.a.WebVTT&&!e.every((function(e){return!e.activeCues}))){for(var i=[],n=0;n<e.length;++n)for(var a=e[n],o=0;o<a.activeCues.length;++o)i.push(a.activeCues[o]);s.a.WebVTT.processCues(s.a,i,this.el_);for(var u=0;u<e.length;++u){for(var l=e[u],c=0;c<l.activeCues.length;++c){var h=l.activeCues[c].displayState;addClass(h,"vjs-text-track-cue"),addClass(h,"vjs-text-track-cue-"+(l.language?l.language:u))}this.player_.textTrackSettings&&this.updateDisplayState(l)}}},TextTrackDisplay}(wt);wt.registerComponent("TextTrackDisplay",Gi);var Xi=function(e){function LoadingSpinner(){return e.apply(this,arguments)||this}return g()(LoadingSpinner,e),LoadingSpinner.prototype.createEl=function createEl$1(){var i=this.player_.isAudio(),n=this.localize(i?"Audio Player":"Video Player"),a=video_es_createEl("span",{"className":"vjs-control-text","innerHTML":this.localize("{1} is loading.",[n])}),s=e.prototype.createEl.call(this,"div",{"className":"vjs-loading-spinner","dir":"ltr"});return s.appendChild(a),s},LoadingSpinner}(wt);wt.registerComponent("LoadingSpinner",Xi);var Ki=function(e){function Button(){return e.apply(this,arguments)||this}g()(Button,e);var i=Button.prototype;return i.createEl=function createEl(e,i,n){void 0===i&&(i={}),void 0===n&&(n={}),i=video_es_assign({"innerHTML":'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',"className":this.buildCSSClass()},i),n=video_es_assign({"type":"button"},n);var a=wt.prototype.createEl.call(this,"button",i,n);return this.createControlTextEl(a),a},i.addChild=function addChild(e,i){void 0===i&&(i={});var n=this.constructor.name;return He.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),wt.prototype.addChild.call(this,e,i)},i.enable=function enable(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},i.disable=function disable(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},i.handleKeyDown=function handleKeyDown(i){T.a.isEventKey(i,"Space")||T.a.isEventKey(i,"Enter")?i.stopPropagation():e.prototype.handleKeyDown.call(this,i)},Button}(qi);wt.registerComponent("Button",Ki);var Yi=function(e){function BigPlayButton(i,n){var a;return(a=e.call(this,i,n)||this).mouseused_=!1,a.on("mousedown",a.handleMouseDown),a}g()(BigPlayButton,e);var i=BigPlayButton.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-big-play-button"},i.handleClick=function handleClick(e){var i=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var n=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;return silencePromise(i),void(!this.player_.tech(!0)||(Ft||Nt)&&n||this.player_.tech(!0).focus())}var a=this.player_.getChild("controlBar"),s=a&&a.getChild("playToggle");if(s){var o=function playFocus(){return s.focus()};isPromise(i)?i.then(o,(function(){})):this.setTimeout(o,1)}else this.player_.tech(!0).focus()},i.handleKeyDown=function handleKeyDown(i){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,i)},i.handleMouseDown=function handleMouseDown(e){this.mouseused_=!0},BigPlayButton}(Ki);Yi.prototype.controlText_="Play Video",wt.registerComponent("BigPlayButton",Yi);var Qi=function(e){function CloseButton(i,n){var a;return(a=e.call(this,i,n)||this).controlText(n&&n.controlText||a.localize("Close")),a}g()(CloseButton,e);var i=CloseButton.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},i.handleClick=function handleClick(e){this.trigger({"type":"close","bubbles":!1})},i.handleKeyDown=function handleKeyDown(i){T.a.isEventKey(i,"Esc")?(i.preventDefault(),i.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,i)},CloseButton}(Ki);wt.registerComponent("CloseButton",Qi);var Ji=function(e){function PlayToggle(i,n){var a;return void 0===n&&(n={}),a=e.call(this,i,n)||this,n.replay=void 0===n.replay||n.replay,a.on(i,"play",a.handlePlay),a.on(i,"pause",a.handlePause),n.replay&&a.on(i,"ended",a.handleEnded),a}g()(PlayToggle,e);var i=PlayToggle.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},i.handleClick=function handleClick(e){this.player_.paused()?this.player_.play():this.player_.pause()},i.handleSeeked=function handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},i.handlePlay=function handlePlay(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},i.handlePause=function handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},i.handleEnded=function handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},PlayToggle}(Ki);Ji.prototype.controlText_="Play",wt.registerComponent("PlayToggle",Ji);var Zi=function defaultImplementation(e,i){e=e<0?0:e;var n=Math.floor(e%60),a=Math.floor(e/60%60),s=Math.floor(e/3600),o=Math.floor(i/60%60),u=Math.floor(i/3600);return(isNaN(e)||e===1/0)&&(s=a=n="-"),(s=s>0||u>0?s+":":"")+(a=((s||o>=10)&&a<10?"0"+a:a)+":")+(n=n<10?"0"+n:n)},en=Zi;function formatTime(e,i){return void 0===i&&(i=e),en(e,i)}var tn=function(e){function TimeDisplay(i,n){var a;return(a=e.call(this,i,n)||this).on(i,["timeupdate","ended"],a.updateContent),a.updateTextNode_(),a}g()(TimeDisplay,e);var i=TimeDisplay.prototype;return i.createEl=function createEl$1(){var i=this.buildCSSClass(),n=e.prototype.createEl.call(this,"div",{"className":i+" vjs-time-control vjs-control","innerHTML":'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=video_es_createEl("span",{"className":i+"-display"},{"aria-live":"off","role":"presentation"}),n.appendChild(this.contentEl_),n},i.dispose=function dispose(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},i.updateTextNode_=function updateTextNode_(e){var i=this;void 0===e&&(e=0),e=formatTime(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",(function(){if(i.contentEl_){var e=i.textNode_;e&&i.contentEl_.firstChild!==e&&(e=null,He.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),i.textNode_=u.a.createTextNode(i.formattedTime_),i.textNode_&&(e?i.contentEl_.replaceChild(i.textNode_,e):i.contentEl_.appendChild(i.textNode_))}})))},i.updateContent=function updateContent(e){},TimeDisplay}(wt);tn.prototype.labelText_="Time",tn.prototype.controlText_="Time",wt.registerComponent("TimeDisplay",tn);var nn=function(e){function CurrentTimeDisplay(){return e.apply(this,arguments)||this}g()(CurrentTimeDisplay,e);var i=CurrentTimeDisplay.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-current-time"},i.updateContent=function updateContent(e){var i;i=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(i)},CurrentTimeDisplay}(tn);nn.prototype.labelText_="Current Time",nn.prototype.controlText_="Current Time",wt.registerComponent("CurrentTimeDisplay",nn);var rn=function(e){function DurationDisplay(i,n){var a;return(a=e.call(this,i,n)||this).on(i,"durationchange",a.updateContent),a.on(i,"loadstart",a.updateContent),a.on(i,"loadedmetadata",a.updateContent),a}g()(DurationDisplay,e);var i=DurationDisplay.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-duration"},i.updateContent=function updateContent(e){var i=this.player_.duration();this.updateTextNode_(i)},DurationDisplay}(tn);rn.prototype.labelText_="Duration",rn.prototype.controlText_="Duration",wt.registerComponent("DurationDisplay",rn);var an=function(e){function TimeDivider(){return e.apply(this,arguments)||this}return g()(TimeDivider,e),TimeDivider.prototype.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-time-control vjs-time-divider","innerHTML":"<div><span>/</span></div>"},{"aria-hidden":!0})},TimeDivider}(wt);wt.registerComponent("TimeDivider",an);var sn=function(e){function RemainingTimeDisplay(i,n){var a;return(a=e.call(this,i,n)||this).on(i,"durationchange",a.updateContent),a}g()(RemainingTimeDisplay,e);var i=RemainingTimeDisplay.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-remaining-time"},i.createEl=function createEl$1(){var i=e.prototype.createEl.call(this);return i.insertBefore(video_es_createEl("span",{},{"aria-hidden":!0},"-"),this.contentEl_),i},i.updateContent=function updateContent(e){var i;"number"==typeof this.player_.duration()&&(i=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(i))},RemainingTimeDisplay}(tn);sn.prototype.labelText_="Remaining Time",sn.prototype.controlText_="Remaining Time",wt.registerComponent("RemainingTimeDisplay",sn);var un=function(e){function LiveDisplay(i,n){var a;return(a=e.call(this,i,n)||this).updateShowing(),a.on(a.player(),"durationchange",a.updateShowing),a}g()(LiveDisplay,e);var i=LiveDisplay.prototype;return i.createEl=function createEl$1(){var i=e.prototype.createEl.call(this,"div",{"className":"vjs-live-control vjs-control"});return this.contentEl_=video_es_createEl("div",{"className":"vjs-live-display","innerHTML":'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),i.appendChild(this.contentEl_),i},i.dispose=function dispose(){this.contentEl_=null,e.prototype.dispose.call(this)},i.updateShowing=function updateShowing(e){this.player().duration()===1/0?this.show():this.hide()},LiveDisplay}(wt);wt.registerComponent("LiveDisplay",un);var ln=function(e){function SeekToLive(i,n){var a;return(a=e.call(this,i,n)||this).updateLiveEdgeStatus(),a.player_.liveTracker&&a.on(a.player_.liveTracker,"liveedgechange",a.updateLiveEdgeStatus),a}g()(SeekToLive,e);var i=SeekToLive.prototype;return i.createEl=function createEl$1(){var i=e.prototype.createEl.call(this,"button",{"className":"vjs-seek-to-live-control vjs-control"});return this.textEl_=video_es_createEl("span",{"className":"vjs-seek-to-live-text","innerHTML":this.localize("LIVE")},{"aria-hidden":"true"}),i.appendChild(this.textEl_),i},i.updateLiveEdgeStatus=function updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},i.handleClick=function handleClick(){this.player_.liveTracker.seekToLiveEdge()},i.dispose=function dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},SeekToLive}(Ki);ln.prototype.controlText_="Seek to live, currently playing live",wt.registerComponent("SeekToLive",ln);var cn=function clamp(e,i,n){return e=Number(e),Math.min(n,Math.max(i,isNaN(e)?i:e))},dn=function(e){function Slider(i,n){var a;return(a=e.call(this,i,n)||this).bar=a.getChild(a.options_.barName),a.vertical(!!a.options_.vertical),a.enable(),a}g()(Slider,e);var i=Slider.prototype;return i.enabled=function enabled(){return this.enabled_},i.enable=function enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},i.disable=function disable(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},i.createEl=function createEl(i,n,a){return void 0===n&&(n={}),void 0===a&&(a={}),n.className=n.className+" vjs-slider",n=video_es_assign({"tabIndex":0},n),a=video_es_assign({"role":"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,"tabIndex":0},a),e.prototype.createEl.call(this,i,n,a)},i.handleMouseDown=function handleMouseDown(e){var i=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||Ut||e.preventDefault(),blockTextSelection(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(i,"mousemove",this.handleMouseMove),this.on(i,"mouseup",this.handleMouseUp),this.on(i,"touchmove",this.handleMouseMove),this.on(i,"touchend",this.handleMouseUp),this.handleMouseMove(e)},i.handleMouseMove=function handleMouseMove(e){},i.handleMouseUp=function handleMouseUp(){var e=this.bar.el_.ownerDocument;unblockTextSelection(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},i.update=function update(){var e=this;if(this.el_&&this.bar){var i=this.getProgress();return i===this.progress_||(this.progress_=i,this.requestNamedAnimationFrame("Slider#update",(function(){var n=e.vertical()?"height":"width";e.bar.el().style[n]=(100*i).toFixed(2)+"%"}))),i}},i.getProgress=function getProgress(){return Number(cn(this.getPercent(),0,1).toFixed(4))},i.calculateDistance=function calculateDistance(e){var i=getPointerPosition(this.el_,e);return this.vertical()?i.y:i.x},i.handleKeyDown=function handleKeyDown(i){T.a.isEventKey(i,"Left")||T.a.isEventKey(i,"Down")?(i.preventDefault(),i.stopPropagation(),this.stepBack()):T.a.isEventKey(i,"Right")||T.a.isEventKey(i,"Up")?(i.preventDefault(),i.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,i)},i.handleClick=function handleClick(e){e.stopPropagation(),e.preventDefault()},i.vertical=function vertical(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},Slider}(wt);wt.registerComponent("Slider",dn);var hn=function percentify(e,i){return cn(e/i*100,0,100).toFixed(2)+"%"},pn=function(e){function LoadProgressBar(i,n){var a;return(a=e.call(this,i,n)||this).partEls_=[],a.on(i,"progress",a.update),a}g()(LoadProgressBar,e);var i=LoadProgressBar.prototype;return i.createEl=function createEl$1(){var i=e.prototype.createEl.call(this,"div",{"className":"vjs-load-progress"}),n=video_es_createEl("span",{"className":"vjs-control-text"}),a=video_es_createEl("span",{"textContent":this.localize("Loaded")}),s=u.a.createTextNode(": ");return this.percentageEl_=video_es_createEl("span",{"className":"vjs-control-text-loaded-percentage","textContent":"0%"}),i.appendChild(n),n.appendChild(a),n.appendChild(s),n.appendChild(this.percentageEl_),i},i.dispose=function dispose(){this.partEls_=null,this.percentageEl_=null,e.prototype.dispose.call(this)},i.update=function update(e){var i=this;this.requestNamedAnimationFrame("LoadProgressBar#update",(function(){var e=i.player_.liveTracker,n=i.player_.buffered(),a=e&&e.isLive()?e.seekableEnd():i.player_.duration(),s=i.player_.bufferedEnd(),o=i.partEls_,u=hn(s,a);i.percent_!==u&&(i.el_.style.width=u,textContent(i.percentageEl_,u),i.percent_=u);for(var l=0;l<n.length;l++){var c=n.start(l),h=n.end(l),f=o[l];f||(f=i.el_.appendChild(video_es_createEl()),o[l]=f),f.dataset.start===c&&f.dataset.end===h||(f.dataset.start=c,f.dataset.end=h,f.style.left=hn(c,s),f.style.width=hn(h-c,s))}for(var m=o.length;m>n.length;m--)i.el_.removeChild(o[m-1]);o.length=n.length}))},LoadProgressBar}(wt);wt.registerComponent("LoadProgressBar",pn);var fn=function(e){function TimeTooltip(i,n){var a;return(a=e.call(this,i,n)||this).update=ut(ot(f()(a),a.update),30),a}g()(TimeTooltip,e);var i=TimeTooltip.prototype;return i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-time-tooltip"},{"aria-hidden":"true"})},i.update=function update(e,i,n){var a=findPosition(this.el_),s=getBoundingClientRect(this.player_.el()),o=e.width*i;if(s&&a){var u=e.left-s.left+o,l=e.width-o+(s.right-e.right),c=a.width/2;u<c?c+=c-u:l<c&&(c=l),c<0?c=0:c>a.width&&(c=a.width),c=Math.round(c),this.el_.style.right="-"+c+"px",this.write(n)}},i.write=function write(e){textContent(this.el_,e)},i.updateTime=function updateTime(e,i,n,a){var s=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",(function(){var o,u=s.player_.duration();if(s.player_.liveTracker&&s.player_.liveTracker.isLive()){var l=s.player_.liveTracker.liveWindow(),c=l-i*l;o=(c<1?"":"-")+formatTime(c,l)}else o=formatTime(n,u);s.update(e,i,o),a&&a()}))},TimeTooltip}(wt);wt.registerComponent("TimeTooltip",fn);var mn=function(e){function PlayProgressBar(i,n){var a;return(a=e.call(this,i,n)||this).update=ut(ot(f()(a),a.update),30),a}g()(PlayProgressBar,e);var i=PlayProgressBar.prototype;return i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},i.update=function update(e,i){var n=this.getChild("timeTooltip");if(n){var a=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,i,a)}},PlayProgressBar}(wt);mn.prototype.options_={"children":[]},zt||Ot||mn.prototype.options_.children.push("timeTooltip"),wt.registerComponent("PlayProgressBar",mn);var gn=function(e){function MouseTimeDisplay(i,n){var a;return(a=e.call(this,i,n)||this).update=ut(ot(f()(a),a.update),30),a}g()(MouseTimeDisplay,e);var i=MouseTimeDisplay.prototype;return i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-mouse-display"})},i.update=function update(e,i){var n=this,a=i*this.player_.duration();this.getChild("timeTooltip").updateTime(e,i,a,(function(){n.el_.style.left=e.width*i+"px"}))},MouseTimeDisplay}(wt);gn.prototype.options_={"children":["timeTooltip"]},wt.registerComponent("MouseTimeDisplay",gn);var vn=function(e){function SeekBar(i,n){var a;return(a=e.call(this,i,n)||this).setEventHandlers_(),a}g()(SeekBar,e);var i=SeekBar.prototype;return i.setEventHandlers_=function setEventHandlers_(){this.update_=ot(this,this.update),this.update=ut(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in u.a&&"visibilityState"in u.a&&this.on(u.a,"visibilitychange",this.toggleVisibility_)},i.toggleVisibility_=function toggleVisibility_(e){u.a.hidden?this.disableInterval_(e):(this.enableInterval_(),this.update())},i.enableInterval_=function enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))},i.disableInterval_=function disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},i.update=function update(i){var n=this,a=e.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",(function(){var e=n.player_.ended()?n.player_.duration():n.getCurrentTime_(),i=n.player_.liveTracker,s=n.player_.duration();i&&i.isLive()&&(s=n.player_.liveTracker.liveCurrentTime()),n.percent_!==a&&(n.el_.setAttribute("aria-valuenow",(100*a).toFixed(2)),n.percent_=a),n.currentTime_===e&&n.duration_===s||(n.el_.setAttribute("aria-valuetext",n.localize("progress bar timing: currentTime={1} duration={2}",[formatTime(e,s),formatTime(s,s)],"{1} of {2}")),n.currentTime_=e,n.duration_=s),n.bar&&n.bar.update(getBoundingClientRect(n.el()),n.getProgress())})),a},i.getCurrentTime_=function getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},i.getPercent=function getPercent(){var e,i=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(i-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=i/this.player_.duration(),e},i.handleMouseDown=function handleMouseDown(i){isSingleLeftClick(i)&&(i.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,i))},i.handleMouseMove=function handleMouseMove(e){if(isSingleLeftClick(e)){var i,n=this.calculateDistance(e),a=this.player_.liveTracker;if(a&&a.isLive()){if(n>=.99)return void a.seekToLiveEdge();var s=a.seekableStart(),o=a.liveCurrentTime();if((i=s+n*a.liveWindow())>=o&&(i=o),i<=s&&(i=s+.1),i===1/0)return}else(i=n*this.player_.duration())===this.player_.duration()&&(i-=.1);this.player_.currentTime(i)}},i.enable=function enable(){e.prototype.enable.call(this);var i=this.getChild("mouseTimeDisplay");i&&i.show()},i.disable=function disable(){e.prototype.disable.call(this);var i=this.getChild("mouseTimeDisplay");i&&i.hide()},i.handleMouseUp=function handleMouseUp(i){e.prototype.handleMouseUp.call(this,i),i&&i.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({"type":"timeupdate","target":this,"manuallyTriggered":!0}),this.videoWasPlaying?silencePromise(this.player_.play()):this.update_()},i.stepForward=function stepForward(){this.player_.currentTime(this.player_.currentTime()+5)},i.stepBack=function stepBack(){this.player_.currentTime(this.player_.currentTime()-5)},i.handleAction=function handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()},i.handleKeyDown=function handleKeyDown(i){if(T.a.isEventKey(i,"Space")||T.a.isEventKey(i,"Enter"))i.preventDefault(),i.stopPropagation(),this.handleAction(i);else if(T.a.isEventKey(i,"Home"))i.preventDefault(),i.stopPropagation(),this.player_.currentTime(0);else if(T.a.isEventKey(i,"End"))i.preventDefault(),i.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(T()(i))){i.preventDefault(),i.stopPropagation();var n=10*(T.a.codes[T()(i)]-T.a.codes[0])/100;this.player_.currentTime(this.player_.duration()*n)}else T.a.isEventKey(i,"PgDn")?(i.preventDefault(),i.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):T.a.isEventKey(i,"PgUp")?(i.preventDefault(),i.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,i)},i.dispose=function dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableInterval_),this.off(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in u.a&&"visibilityState"in u.a&&this.off(u.a,"visibilitychange",this.toggleVisibility_),e.prototype.dispose.call(this)},SeekBar}(dn);vn.prototype.options_={"children":["loadProgressBar","playProgressBar"],"barName":"playProgressBar"},zt||Ot||vn.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),wt.registerComponent("SeekBar",vn);var yn=function(e){function ProgressControl(i,n){var a;return(a=e.call(this,i,n)||this).handleMouseMove=ut(ot(f()(a),a.handleMouseMove),30),a.throttledHandleMouseSeek=ut(ot(f()(a),a.handleMouseSeek),30),a.enable(),a}g()(ProgressControl,e);var i=ProgressControl.prototype;return i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-progress-control vjs-control"})},i.handleMouseMove=function handleMouseMove(e){var i=this.getChild("seekBar");if(i){var n=i.getChild("playProgressBar"),a=i.getChild("mouseTimeDisplay");if(n||a){var s=i.el(),o=findPosition(s),u=getPointerPosition(s,e).x;u=cn(u,0,1),a&&a.update(o,u),n&&n.update(o,i.getProgress())}}},i.handleMouseSeek=function handleMouseSeek(e){var i=this.getChild("seekBar");i&&i.handleMouseMove(e)},i.enabled=function enabled(){return this.enabled_},i.disable=function disable(){this.children().forEach((function(e){return e.disable&&e.disable()})),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},i.enable=function enable(){this.children().forEach((function(e){return e.enable&&e.enable()})),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},i.handleMouseDown=function handleMouseDown(e){var i=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(i,"mousemove",this.throttledHandleMouseSeek),this.on(i,"touchmove",this.throttledHandleMouseSeek),this.on(i,"mouseup",this.handleMouseUp),this.on(i,"touchend",this.handleMouseUp)},i.handleMouseUp=function handleMouseUp(e){var i=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(i,"mousemove",this.throttledHandleMouseSeek),this.off(i,"touchmove",this.throttledHandleMouseSeek),this.off(i,"mouseup",this.handleMouseUp),this.off(i,"touchend",this.handleMouseUp)},ProgressControl}(wt);yn.prototype.options_={"children":["seekBar"]},wt.registerComponent("ProgressControl",yn);var _n=function(e){function PictureInPictureToggle(i,n){var a;return(a=e.call(this,i,n)||this).on(i,["enterpictureinpicture","leavepictureinpicture"],a.handlePictureInPictureChange),a.on(i,["disablepictureinpicturechanged","loadedmetadata"],a.handlePictureInPictureEnabledChange),a.disable(),a}g()(PictureInPictureToggle,e);var i=PictureInPictureToggle.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},i.handlePictureInPictureEnabledChange=function handlePictureInPictureEnabledChange(){u.a.pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()?this.enable():this.disable()},i.handlePictureInPictureChange=function handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},i.handleClick=function handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},PictureInPictureToggle}(Ki);_n.prototype.controlText_="Picture-in-Picture",wt.registerComponent("PictureInPictureToggle",_n);var Tn=function(e){function FullscreenToggle(i,n){var a;return(a=e.call(this,i,n)||this).on(i,"fullscreenchange",a.handleFullscreenChange),!1===u.a[i.fsApi_.fullscreenEnabled]&&a.disable(),a}g()(FullscreenToggle,e);var i=FullscreenToggle.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},i.handleFullscreenChange=function handleFullscreenChange(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},i.handleClick=function handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},FullscreenToggle}(Ki);Tn.prototype.controlText_="Fullscreen",wt.registerComponent("FullscreenToggle",Tn);var bn=function(e){function VolumeLevel(){return e.apply(this,arguments)||this}return g()(VolumeLevel,e),VolumeLevel.prototype.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-volume-level","innerHTML":'<span class="vjs-control-text"></span>'})},VolumeLevel}(wt);wt.registerComponent("VolumeLevel",bn);var Sn=function(e){function VolumeBar(i,n){var a;return(a=e.call(this,i,n)||this).on("slideractive",a.updateLastVolume_),a.on(i,"volumechange",a.updateARIAAttributes),i.ready((function(){return a.updateARIAAttributes()})),a}g()(VolumeBar,e);var i=VolumeBar.prototype;return i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},i.handleMouseDown=function handleMouseDown(i){isSingleLeftClick(i)&&e.prototype.handleMouseDown.call(this,i)},i.handleMouseMove=function handleMouseMove(e){isSingleLeftClick(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},i.checkMuted=function checkMuted(){this.player_.muted()&&this.player_.muted(!1)},i.getPercent=function getPercent(){return this.player_.muted()?0:this.player_.volume()},i.stepForward=function stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},i.stepBack=function stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},i.updateARIAAttributes=function updateARIAAttributes(e){var i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i),this.el_.setAttribute("aria-valuetext",i+"%")},i.volumeAsPercentage_=function volumeAsPercentage_(){return Math.round(100*this.player_.volume())},i.updateLastVolume_=function updateLastVolume_(){var e=this,i=this.player_.volume();this.one("sliderinactive",(function(){0===e.player_.volume()&&e.player_.lastVolume_(i)}))},VolumeBar}(dn);Sn.prototype.options_={"children":["volumeLevel"],"barName":"volumeLevel"},Sn.prototype.playerEvent="volumechange",wt.registerComponent("VolumeBar",Sn);var Cn=function(e){function VolumeControl(i,n){var a;return void 0===n&&(n={}),n.vertical=n.vertical||!1,(void 0===n.volumeBar||isPlain(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),a=e.call(this,i,n)||this,function checkVolumeSupport(e,i){i.tech_&&!i.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(i,"loadstart",(function(){i.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(f()(a),i),a.throttledHandleMouseMove=ut(ot(f()(a),a.handleMouseMove),30),a.on("mousedown",a.handleMouseDown),a.on("touchstart",a.handleMouseDown),a.on(a.volumeBar,["focus","slideractive"],(function(){a.volumeBar.addClass("vjs-slider-active"),a.addClass("vjs-slider-active"),a.trigger("slideractive")})),a.on(a.volumeBar,["blur","sliderinactive"],(function(){a.volumeBar.removeClass("vjs-slider-active"),a.removeClass("vjs-slider-active"),a.trigger("sliderinactive")})),a}g()(VolumeControl,e);var i=VolumeControl.prototype;return i.createEl=function createEl(){var i="vjs-volume-horizontal";return this.options_.vertical&&(i="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{"className":"vjs-volume-control vjs-control "+i})},i.handleMouseDown=function handleMouseDown(e){var i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove),this.on(i,"touchmove",this.throttledHandleMouseMove),this.on(i,"mouseup",this.handleMouseUp),this.on(i,"touchend",this.handleMouseUp)},i.handleMouseUp=function handleMouseUp(e){var i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove),this.off(i,"touchmove",this.throttledHandleMouseMove),this.off(i,"mouseup",this.handleMouseUp),this.off(i,"touchend",this.handleMouseUp)},i.handleMouseMove=function handleMouseMove(e){this.volumeBar.handleMouseMove(e)},VolumeControl}(wt);Cn.prototype.options_={"children":["volumeBar"]},wt.registerComponent("VolumeControl",Cn);var kn=function(e){function MuteToggle(i,n){var a;return a=e.call(this,i,n)||this,function checkMuteSupport(e,i){i.tech_&&!i.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(i,"loadstart",(function(){i.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(f()(a),i),a.on(i,["loadstart","volumechange"],a.update),a}g()(MuteToggle,e);var i=MuteToggle.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},i.handleClick=function handleClick(e){var i=this.player_.volume(),n=this.player_.lastVolume_();if(0===i){var a=n<.1?.1:n;this.player_.volume(a),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},i.update=function update(e){this.updateIcon_(),this.updateControlText_()},i.updateIcon_=function updateIcon_(){var e=this.player_.volume(),i=3;zt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?i=0:e<.33?i=1:e<.67&&(i=2);for(var n=0;n<4;n++)removeClass(this.el_,"vjs-vol-"+n);addClass(this.el_,"vjs-vol-"+i)},i.updateControlText_=function updateControlText_(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},MuteToggle}(Ki);kn.prototype.controlText_="Mute",wt.registerComponent("MuteToggle",kn);var En=function(e){function VolumePanel(i,n){var a;return void 0===n&&(n={}),void 0!==n.inline?n.inline=n.inline:n.inline=!0,(void 0===n.volumeControl||isPlain(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(a=e.call(this,i,n)||this).on(i,["loadstart"],a.volumePanelState_),a.on(a.muteToggle,"keyup",a.handleKeyPress),a.on(a.volumeControl,"keyup",a.handleVolumeControlKeyUp),a.on("keydown",a.handleKeyPress),a.on("mouseover",a.handleMouseOver),a.on("mouseout",a.handleMouseOut),a.on(a.volumeControl,["slideractive"],a.sliderActive_),a.on(a.volumeControl,["sliderinactive"],a.sliderInactive_),a}g()(VolumePanel,e);var i=VolumePanel.prototype;return i.sliderActive_=function sliderActive_(){this.addClass("vjs-slider-active")},i.sliderInactive_=function sliderInactive_(){this.removeClass("vjs-slider-active")},i.volumePanelState_=function volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},i.createEl=function createEl(){var i="vjs-volume-panel-horizontal";return this.options_.inline||(i="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{"className":"vjs-volume-panel vjs-control "+i})},i.dispose=function dispose(){this.handleMouseOut(),e.prototype.dispose.call(this)},i.handleVolumeControlKeyUp=function handleVolumeControlKeyUp(e){T.a.isEventKey(e,"Esc")&&this.muteToggle.focus()},i.handleMouseOver=function handleMouseOver(e){this.addClass("vjs-hover"),on(u.a,"keyup",ot(this,this.handleKeyPress))},i.handleMouseOut=function handleMouseOut(e){this.removeClass("vjs-hover"),off(u.a,"keyup",ot(this,this.handleKeyPress))},i.handleKeyPress=function handleKeyPress(e){T.a.isEventKey(e,"Esc")&&this.handleMouseOut()},VolumePanel}(wt);En.prototype.options_={"children":["muteToggle","volumeControl"]},wt.registerComponent("VolumePanel",En);var wn=function(e){function Menu(i,n){var a;return a=e.call(this,i,n)||this,n&&(a.menuButton_=n.menuButton),a.focusedChild_=-1,a.on("keydown",a.handleKeyDown),a.boundHandleBlur_=ot(f()(a),a.handleBlur),a.boundHandleTapClick_=ot(f()(a),a.handleTapClick),a}g()(Menu,e);var i=Menu.prototype;return i.addEventListenerForItem=function addEventListenerForItem(e){e instanceof wt&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},i.removeEventListenerForItem=function removeEventListenerForItem(e){e instanceof wt&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},i.removeChild=function removeChild(i){"string"==typeof i&&(i=this.getChild(i)),this.removeEventListenerForItem(i),e.prototype.removeChild.call(this,i)},i.addItem=function addItem(e){var i=this.addChild(e);i&&this.addEventListenerForItem(i)},i.createEl=function createEl$1(){var i=this.options_.contentElType||"ul";this.contentEl_=video_es_createEl(i,{"className":"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{"append":this.contentEl_,"className":"vjs-menu"});return n.appendChild(this.contentEl_),on(n,"click",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),n},i.dispose=function dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},i.handleBlur=function handleBlur(e){var i=e.relatedTarget||u.a.activeElement;if(!this.children().some((function(e){return e.el()===i}))){var n=this.menuButton_;n&&n.buttonPressed_&&i!==n.el().firstChild&&n.unpressButton()}},i.handleTapClick=function handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();var i=this.children();if(!Array.isArray(i))return;var n=i.filter((function(i){return i.el()===e.target}))[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},i.handleKeyDown=function handleKeyDown(e){T.a.isEventKey(e,"Left")||T.a.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(T.a.isEventKey(e,"Right")||T.a.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},i.stepForward=function stepForward(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},i.stepBack=function stepBack(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},i.focus=function focus(e){void 0===e&&(e=0);var i=this.children().slice();i.length&&i[0].hasClass("vjs-menu-title")&&i.shift(),i.length>0&&(e<0?e=0:e>=i.length&&(e=i.length-1),this.focusedChild_=e,i[e].el_.focus())},Menu}(wt);wt.registerComponent("Menu",wn);var Pn=function(e){function MenuButton(i,n){var a;void 0===n&&(n={}),(a=e.call(this,i,n)||this).menuButton_=new Ki(i,n),a.menuButton_.controlText(a.controlText_),a.menuButton_.el_.setAttribute("aria-haspopup","true");var s=Ki.prototype.buildCSSClass();return a.menuButton_.el_.className=a.buildCSSClass()+" "+s,a.menuButton_.removeClass("vjs-control"),a.addChild(a.menuButton_),a.update(),a.enabled_=!0,a.on(a.menuButton_,"tap",a.handleClick),a.on(a.menuButton_,"click",a.handleClick),a.on(a.menuButton_,"keydown",a.handleKeyDown),a.on(a.menuButton_,"mouseenter",(function(){a.addClass("vjs-hover"),a.menu.show(),on(u.a,"keyup",ot(f()(a),a.handleMenuKeyUp))})),a.on("mouseleave",a.handleMouseLeave),a.on("keydown",a.handleSubmenuKeyDown),a}g()(MenuButton,e);var i=MenuButton.prototype;return i.update=function update(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},i.createMenu=function createMenu(){var e=new wn(this.player_,{"menuButton":this});if(this.hideThreshold_=0,this.options_.title){var i=video_es_createEl("li",{"className":"vjs-menu-title","innerHTML":bt(this.options_.title),"tabIndex":-1});this.hideThreshold_+=1;var n=new wt(this.player_,{"el":i});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var a=0;a<this.items.length;a++)e.addItem(this.items[a]);return e},i.createItems=function createItems(){},i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":this.buildWrapperCSSClass()},{})},i.buildWrapperCSSClass=function buildWrapperCSSClass(){var i="vjs-menu-button";return!0===this.options_.inline?i+="-inline":i+="-popup","vjs-menu-button "+i+" "+Ki.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},i.buildCSSClass=function buildCSSClass(){var i="vjs-menu-button";return!0===this.options_.inline?i+="-inline":i+="-popup","vjs-menu-button "+i+" "+e.prototype.buildCSSClass.call(this)},i.controlText=function controlText(e,i){return void 0===i&&(i=this.menuButton_.el()),this.menuButton_.controlText(e,i)},i.dispose=function dispose(){this.handleMouseLeave(),e.prototype.dispose.call(this)},i.handleClick=function handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()},i.handleMouseLeave=function handleMouseLeave(e){this.removeClass("vjs-hover"),off(u.a,"keyup",ot(this,this.handleMenuKeyUp))},i.focus=function focus(){this.menuButton_.focus()},i.blur=function blur(){this.menuButton_.blur()},i.handleKeyDown=function handleKeyDown(e){T.a.isEventKey(e,"Esc")||T.a.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),T.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(T.a.isEventKey(e,"Up")||T.a.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},i.handleMenuKeyUp=function handleMenuKeyUp(e){(T.a.isEventKey(e,"Esc")||T.a.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},i.handleSubmenuKeyPress=function handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)},i.handleSubmenuKeyDown=function handleSubmenuKeyDown(e){(T.a.isEventKey(e,"Esc")||T.a.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),T.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},i.pressButton=function pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),zt&&isInFrame())return;this.menu.focus()}},i.unpressButton=function unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},i.disable=function disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},i.enable=function enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},MenuButton}(wt);wt.registerComponent("MenuButton",Pn);var In=function(e){function TrackButton(i,n){var a,s=n.tracks;if((a=e.call(this,i,n)||this).items.length<=1&&a.hide(),!s)return f()(a);var o=ot(f()(a),a.update);return s.addEventListener("removetrack",o),s.addEventListener("addtrack",o),s.addEventListener("labelchange",o),a.player_.on("ready",o),a.player_.on("dispose",(function(){s.removeEventListener("removetrack",o),s.removeEventListener("addtrack",o),s.removeEventListener("labelchange",o)})),a}return g()(TrackButton,e),TrackButton}(Pn);wt.registerComponent("TrackButton",In);var xn=["Tab","Esc","Up","Down","Right","Left"],An=function(e){function MenuItem(i,n){var a;return(a=e.call(this,i,n)||this).selectable=n.selectable,a.isSelected_=n.selected||!1,a.multiSelectable=n.multiSelectable,a.selected(a.isSelected_),a.selectable?a.multiSelectable?a.el_.setAttribute("role","menuitemcheckbox"):a.el_.setAttribute("role","menuitemradio"):a.el_.setAttribute("role","menuitem"),a}g()(MenuItem,e);var i=MenuItem.prototype;return i.createEl=function createEl(i,n,a){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",video_es_assign({"className":"vjs-menu-item","innerHTML":'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>","tabIndex":-1},n),a)},i.handleKeyDown=function handleKeyDown(i){xn.some((function(e){return T.a.isEventKey(i,e)}))||e.prototype.handleKeyDown.call(this,i)},i.handleClick=function handleClick(e){this.selected(!0)},i.selected=function selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},MenuItem}(qi);wt.registerComponent("MenuItem",An);var Ln=function(e){function TextTrackMenuItem(i,n){var a,o=n.track,l=i.textTracks();n.label=o.label||o.language||"Unknown",n.selected="showing"===o.mode,(a=e.call(this,i,n)||this).track=o,a.kinds=(n.kinds||[n.kind||a.track.kind]).filter(Boolean);var c,h=function changeHandler(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];a.handleTracksChange.apply(f()(a),i)},m=function selectedLanguageChangeHandler(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];a.handleSelectedLanguageChange.apply(f()(a),i)};(i.on(["loadstart","texttrackchange"],h),l.addEventListener("change",h),l.addEventListener("selectedlanguagechange",m),a.on("dispose",(function(){i.off(["loadstart","texttrackchange"],h),l.removeEventListener("change",h),l.removeEventListener("selectedlanguagechange",m)})),void 0===l.onchange)&&a.on(["tap","click"],(function(){if("object"!=typeof s.a.Event)try{c=new s.a.Event("change")}catch(e){}c||(c=u.a.createEvent("Event")).initEvent("change",!0,!0),l.dispatchEvent(c)}));return a.handleTracksChange(),a}g()(TextTrackMenuItem,e);var i=TextTrackMenuItem.prototype;return i.handleClick=function handleClick(i){var n=this.track,a=this.player_.textTracks();if(e.prototype.handleClick.call(this,i),a)for(var s=0;s<a.length;s++){var o=a[s];-1!==this.kinds.indexOf(o.kind)&&(o===n?"showing"!==o.mode&&(o.mode="showing"):"disabled"!==o.mode&&(o.mode="disabled"))}},i.handleTracksChange=function handleTracksChange(e){var i="showing"===this.track.mode;i!==this.isSelected_&&this.selected(i)},i.handleSelectedLanguageChange=function handleSelectedLanguageChange(e){if("showing"===this.track.mode){var i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={"enabled":!0,"language":this.track.language,"kind":this.track.kind}}},i.dispose=function dispose(){this.track=null,e.prototype.dispose.call(this)},TextTrackMenuItem}(An);wt.registerComponent("TextTrackMenuItem",Ln);var Dn=function(e){function OffTextTrackMenuItem(i,n){return n.track={"player":i,"kind":n.kind,"kinds":n.kinds,"default":!1,"mode":"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,i,n)||this}g()(OffTextTrackMenuItem,e);var i=OffTextTrackMenuItem.prototype;return i.handleTracksChange=function handleTracksChange(e){for(var i=this.player().textTracks(),n=!0,a=0,s=i.length;a<s;a++){var o=i[a];if(this.options_.kinds.indexOf(o.kind)>-1&&"showing"===o.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},i.handleSelectedLanguageChange=function handleSelectedLanguageChange(e){for(var i=this.player().textTracks(),n=!0,a=0,s=i.length;a<s;a++){var o=i[a];if(["captions","descriptions","subtitles"].indexOf(o.kind)>-1&&"showing"===o.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={"enabled":!1})},OffTextTrackMenuItem}(Ln);wt.registerComponent("OffTextTrackMenuItem",Dn);var On=function(e){function TextTrackButton(i,n){return void 0===n&&(n={}),n.tracks=i.textTracks(),e.call(this,i,n)||this}return g()(TextTrackButton,e),TextTrackButton.prototype.createItems=function createItems(e,i){var n;void 0===e&&(e=[]),void 0===i&&(i=Ln),this.label_&&(n=this.label_+" off"),e.push(new Dn(this.player_,{"kinds":this.kinds_,"kind":this.kind_,"label":n})),this.hideThreshold_+=1;var a=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var s=0;s<a.length;s++){var o=a[s];if(this.kinds_.indexOf(o.kind)>-1){var u=new i(this.player_,{"track":o,"kinds":this.kinds_,"kind":this.kind_,"selectable":!0,"multiSelectable":!1});u.addClass("vjs-"+o.kind+"-menu-item"),e.push(u)}}return e},TextTrackButton}(In);wt.registerComponent("TextTrackButton",On);var Mn=function(e){function ChaptersTrackMenuItem(i,n){var a,s=n.track,o=n.cue,u=i.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=o.text,n.selected=o.startTime<=u&&u<o.endTime,(a=e.call(this,i,n)||this).track=s,a.cue=o,s.addEventListener("cuechange",ot(f()(a),a.update)),a}g()(ChaptersTrackMenuItem,e);var i=ChaptersTrackMenuItem.prototype;return i.handleClick=function handleClick(i){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},i.update=function update(e){var i=this.cue,n=this.player_.currentTime();this.selected(i.startTime<=n&&n<i.endTime)},ChaptersTrackMenuItem}(An);wt.registerComponent("ChaptersTrackMenuItem",Mn);var Rn=function(e){function ChaptersButton(i,n,a){return e.call(this,i,n,a)||this}g()(ChaptersButton,e);var i=ChaptersButton.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function buildWrapperCSSClass(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},i.update=function update(i){this.track_&&(!i||"addtrack"!==i.type&&"removetrack"!==i.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},i.setTrack=function setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},i.findChaptersTrack=function findChaptersTrack(){for(var e=this.player_.textTracks()||[],i=e.length-1;i>=0;i--){var n=e[i];if(n.kind===this.kind_)return n}},i.getMenuCaption=function getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(bt(this.kind_))},i.createMenu=function createMenu(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},i.createItems=function createItems(){var e=[];if(!this.track_)return e;var i=this.track_.cues;if(!i)return e;for(var n=0,a=i.length;n<a;n++){var s=i[n],o=new Mn(this.player_,{"track":this.track_,"cue":s});e.push(o)}return e},ChaptersButton}(On);Rn.prototype.kind_="chapters",Rn.prototype.controlText_="Chapters",wt.registerComponent("ChaptersButton",Rn);var Bn=function(e){function DescriptionsButton(i,n,a){var s;s=e.call(this,i,n,a)||this;var o=i.textTracks(),u=ot(f()(s),s.handleTracksChange);return o.addEventListener("change",u),s.on("dispose",(function(){o.removeEventListener("change",u)})),s}g()(DescriptionsButton,e);var i=DescriptionsButton.prototype;return i.handleTracksChange=function handleTracksChange(e){for(var i=this.player().textTracks(),n=!1,a=0,s=i.length;a<s;a++){var o=i[a];if(o.kind!==this.kind_&&"showing"===o.mode){n=!0;break}}n?this.disable():this.enable()},i.buildCSSClass=function buildCSSClass(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function buildWrapperCSSClass(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},DescriptionsButton}(On);Bn.prototype.kind_="descriptions",Bn.prototype.controlText_="Descriptions",wt.registerComponent("DescriptionsButton",Bn);var Nn=function(e){function SubtitlesButton(i,n,a){return e.call(this,i,n,a)||this}g()(SubtitlesButton,e);var i=SubtitlesButton.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function buildWrapperCSSClass(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},SubtitlesButton}(On);Nn.prototype.kind_="subtitles",Nn.prototype.controlText_="Subtitles",wt.registerComponent("SubtitlesButton",Nn);var Un=function(e){function CaptionSettingsMenuItem(i,n){var a;return n.track={"player":i,"kind":n.kind,"label":n.kind+" settings","selectable":!1,"default":!1,"mode":"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",(a=e.call(this,i,n)||this).addClass("vjs-texttrack-settings"),a.controlText(", opens "+n.kind+" settings dialog"),a}return g()(CaptionSettingsMenuItem,e),CaptionSettingsMenuItem.prototype.handleClick=function handleClick(e){this.player().getChild("textTrackSettings").open()},CaptionSettingsMenuItem}(Ln);wt.registerComponent("CaptionSettingsMenuItem",Un);var jn=function(e){function CaptionsButton(i,n,a){return e.call(this,i,n,a)||this}g()(CaptionsButton,e);var i=CaptionsButton.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function buildWrapperCSSClass(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function createItems(){var i=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(i.push(new Un(this.player_,{"kind":this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,i)},CaptionsButton}(On);jn.prototype.kind_="captions",jn.prototype.controlText_="Captions",wt.registerComponent("CaptionsButton",jn);var Fn=function(e){function SubsCapsMenuItem(){return e.apply(this,arguments)||this}return g()(SubsCapsMenuItem,e),SubsCapsMenuItem.prototype.createEl=function createEl(i,n,a){var s='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(s+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),s+="</span>",e.prototype.createEl.call(this,i,video_es_assign({"innerHTML":s},n),a)},SubsCapsMenuItem}(Ln);wt.registerComponent("SubsCapsMenuItem",Fn);var Vn=function(e){function SubsCapsButton(i,n){var a;return void 0===n&&(n={}),(a=e.call(this,i,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(a.player_.language_)>-1&&(a.label_="captions"),a.menuButton_.controlText(bt(a.label_)),a}g()(SubsCapsButton,e);var i=SubsCapsButton.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function buildWrapperCSSClass(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function createItems(){var i=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(i.push(new Un(this.player_,{"kind":this.label_})),this.hideThreshold_+=1),i=e.prototype.createItems.call(this,i,Fn)},SubsCapsButton}(On);Vn.prototype.kinds_=["captions","subtitles"],Vn.prototype.controlText_="Subtitles",wt.registerComponent("SubsCapsButton",Vn);var Hn=function(e){function AudioTrackMenuItem(i,n){var a,s=n.track,o=i.audioTracks();n.label=s.label||s.language||"Unknown",n.selected=s.enabled,(a=e.call(this,i,n)||this).track=s,a.addClass("vjs-"+s.kind+"-menu-item");var u=function changeHandler(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];a.handleTracksChange.apply(f()(a),i)};return o.addEventListener("change",u),a.on("dispose",(function(){o.removeEventListener("change",u)})),a}g()(AudioTrackMenuItem,e);var i=AudioTrackMenuItem.prototype;return i.createEl=function createEl(i,n,a){var s='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(s+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),s+="</span>",e.prototype.createEl.call(this,i,video_es_assign({"innerHTML":s},n),a)},i.handleClick=function handleClick(i){var n=this.player_.audioTracks();e.prototype.handleClick.call(this,i);for(var a=0;a<n.length;a++){var s=n[a];s.enabled=s===this.track}},i.handleTracksChange=function handleTracksChange(e){this.selected(this.track.enabled)},AudioTrackMenuItem}(An);wt.registerComponent("AudioTrackMenuItem",Hn);var Wn=function(e){function AudioTrackButton(i,n){return void 0===n&&(n={}),n.tracks=i.audioTracks(),e.call(this,i,n)||this}g()(AudioTrackButton,e);var i=AudioTrackButton.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function buildWrapperCSSClass(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function createItems(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var i=this.player_.audioTracks(),n=0;n<i.length;n++){var a=i[n];e.push(new Hn(this.player_,{"track":a,"selectable":!0,"multiSelectable":!1}))}return e},AudioTrackButton}(In);Wn.prototype.controlText_="Audio Track",wt.registerComponent("AudioTrackButton",Wn);var qn=function(e){function PlaybackRateMenuItem(i,n){var a,s=n.rate,o=parseFloat(s,10);return n.label=s,n.selected=1===o,n.selectable=!0,n.multiSelectable=!1,(a=e.call(this,i,n)||this).label=s,a.rate=o,a.on(i,"ratechange",a.update),a}g()(PlaybackRateMenuItem,e);var i=PlaybackRateMenuItem.prototype;return i.handleClick=function handleClick(i){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},i.update=function update(e){this.selected(this.player().playbackRate()===this.rate)},PlaybackRateMenuItem}(An);qn.prototype.contentElType="button",wt.registerComponent("PlaybackRateMenuItem",qn);var $n=function(e){function PlaybackRateMenuButton(i,n){var a;return(a=e.call(this,i,n)||this).updateVisibility(),a.updateLabel(),a.on(i,"loadstart",a.updateVisibility),a.on(i,"ratechange",a.updateLabel),a}g()(PlaybackRateMenuButton,e);var i=PlaybackRateMenuButton.prototype;return i.createEl=function createEl$1(){var i=e.prototype.createEl.call(this);return this.labelEl_=video_es_createEl("div",{"className":"vjs-playback-rate-value","innerHTML":"1x"}),i.appendChild(this.labelEl_),i},i.dispose=function dispose(){this.labelEl_=null,e.prototype.dispose.call(this)},i.buildCSSClass=function buildCSSClass(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function buildWrapperCSSClass(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},i.createMenu=function createMenu(){var e=new wn(this.player()),i=this.playbackRates();if(i)for(var n=i.length-1;n>=0;n--)e.addChild(new qn(this.player(),{"rate":i[n]+"x"}));return e},i.updateARIAAttributes=function updateARIAAttributes(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},i.handleClick=function handleClick(e){for(var i=this.player().playbackRate(),n=this.playbackRates(),a=n[0],s=0;s<n.length;s++)if(n[s]>i){a=n[s];break}this.player().playbackRate(a)},i.playbackRates=function playbackRates(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},i.playbackRateSupported=function playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},i.updateVisibility=function updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},i.updateLabel=function updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},PlaybackRateMenuButton}(Pn);$n.prototype.controlText_="Playback Rate",wt.registerComponent("PlaybackRateMenuButton",$n);var zn=function(e){function Spacer(){return e.apply(this,arguments)||this}g()(Spacer,e);var i=Spacer.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":this.buildCSSClass()})},Spacer}(wt);wt.registerComponent("Spacer",zn);var Gn=function(e){function CustomControlSpacer(){return e.apply(this,arguments)||this}g()(CustomControlSpacer,e);var i=CustomControlSpacer.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function createEl(){var i=e.prototype.createEl.call(this,{"className":this.buildCSSClass()});return i.innerHTML=" ",i},CustomControlSpacer}(zn);wt.registerComponent("CustomControlSpacer",Gn);var Xn=function(e){function ControlBar(){return e.apply(this,arguments)||this}return g()(ControlBar,e),ControlBar.prototype.createEl=function createEl(){return e.prototype.createEl.call(this,"div",{"className":"vjs-control-bar","dir":"ltr"})},ControlBar}(wt);Xn.prototype.options_={"children":["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in u.a&&Xn.prototype.options_.children.splice(Xn.prototype.options_.children.length-1,0,"pictureInPictureToggle"),wt.registerComponent("ControlBar",Xn);var Kn=function(e){function ErrorDisplay(i,n){var a;return(a=e.call(this,i,n)||this).on(i,"error",a.open),a}g()(ErrorDisplay,e);var i=ErrorDisplay.prototype;return i.buildCSSClass=function buildCSSClass(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},i.content=function content(){var e=this.player().error();return e?this.localize(e.message):""},ErrorDisplay}(ai);Kn.prototype.options_=c()({},ai.prototype.options_,{"pauseOnOpen":!1,"fillAlways":!0,"temporary":!1,"uncloseable":!0}),wt.registerComponent("ErrorDisplay",Kn);var Yn=["#000","Black"],Qn=["#00F","Blue"],Jn=["#0FF","Cyan"],Zn=["#0F0","Green"],er=["#F0F","Magenta"],tr=["#F00","Red"],ir=["#FFF","White"],nr=["#FF0","Yellow"],rr=["1","Opaque"],ar=["0.5","Semi-Transparent"],sr=["0","Transparent"],or={"backgroundColor":{"selector":".vjs-bg-color > select","id":"captions-background-color-%s","label":"Color","options":[Yn,ir,tr,Zn,Qn,nr,er,Jn]},"backgroundOpacity":{"selector":".vjs-bg-opacity > select","id":"captions-background-opacity-%s","label":"Transparency","options":[rr,ar,sr]},"color":{"selector":".vjs-fg-color > select","id":"captions-foreground-color-%s","label":"Color","options":[ir,Yn,tr,Zn,Qn,nr,er,Jn]},"edgeStyle":{"selector":".vjs-edge-style > select","id":"%s","label":"Text Edge Style","options":[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},"fontFamily":{"selector":".vjs-font-family > select","id":"captions-font-family-%s","label":"Font Family","options":[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},"fontPercent":{"selector":".vjs-font-percent > select","id":"captions-font-size-%s","label":"Font Size","options":[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],"default":2,"parser":function parser(e){return"1.00"===e?null:Number(e)}},"textOpacity":{"selector":".vjs-text-opacity > select","id":"captions-foreground-opacity-%s","label":"Transparency","options":[rr,ar]},"windowColor":{"selector":".vjs-window-color > select","id":"captions-window-color-%s","label":"Color"},"windowOpacity":{"selector":".vjs-window-opacity > select","id":"captions-window-opacity-%s","label":"Transparency","options":[sr,ar,rr]}};function parseOptionValue(e,i){if(i&&(e=i(e)),e&&"none"!==e)return e}or.windowColor.options=or.backgroundColor.options;var ur=function(e){function TextTrackSettings(i,n){var a;return n.temporary=!1,(a=e.call(this,i,n)||this).updateDisplay=ot(f()(a),a.updateDisplay),a.fill(),a.hasBeenOpened_=a.hasBeenFilled_=!0,a.endDialog=video_es_createEl("p",{"className":"vjs-control-text","textContent":a.localize("End of dialog window.")}),a.el().appendChild(a.endDialog),a.setDefaults(),void 0===n.persistTextTrackSettings&&(a.options_.persistTextTrackSettings=a.options_.playerOptions.persistTextTrackSettings),a.on(a.$(".vjs-done-button"),"click",(function(){a.saveSettings(),a.close()})),a.on(a.$(".vjs-default-button"),"click",(function(){a.setDefaults(),a.updateDisplay()})),each(or,(function(e){a.on(a.$(e.selector),"change",a.updateDisplay)})),a.options_.persistTextTrackSettings&&a.restoreSettings(),a}g()(TextTrackSettings,e);var i=TextTrackSettings.prototype;return i.dispose=function dispose(){this.endDialog=null,e.prototype.dispose.call(this)},i.createElSelect_=function createElSelect_(e,i,n){var a=this;void 0===i&&(i=""),void 0===n&&(n="label");var s=or[e],o=s.id.replace("%s",this.id_),u=[i,o].join(" ").trim();return["<"+n+' id="'+o+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(s.label),"</"+n+">",'<select aria-labelledby="'+u+'">'].concat(s.options.map((function(e){var i=o+"-"+e[1].replace(/\W+/g,"");return['<option id="'+i+'" value="'+e[0]+'" ','aria-labelledby="'+u+" "+i+'">',a.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")},i.createElFgColor_=function createElFgColor_(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},i.createElBgColor_=function createElBgColor_(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},i.createElWinColor_=function createElWinColor_(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},i.createElColors_=function createElColors_(){return video_es_createEl("div",{"className":"vjs-track-settings-colors","innerHTML":[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},i.createElFont_=function createElFont_(){return video_es_createEl("div",{"className":"vjs-track-settings-font","innerHTML":['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},i.createElControls_=function createElControls_(){var e=this.localize("restore all settings to the default values");return video_es_createEl("div",{"className":"vjs-track-settings-controls","innerHTML":['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},i.content=function content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},i.label=function label(){return this.localize("Caption Settings Dialog")},i.description=function description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},i.buildCSSClass=function buildCSSClass(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},i.getValues=function getValues(){var e=this;return function reduce(e,i,n){return void 0===n&&(n=0),$e(e).reduce((function(n,a){return i(n,e[a],a)}),n)}(or,(function(i,n,a){var s=function getSelectedOptionValue(e,i){return parseOptionValue(e.options[e.options.selectedIndex].value,i)}(e.$(n.selector),n.parser);return void 0!==s&&(i[a]=s),i}),{})},i.setValues=function setValues(e){var i=this;each(or,(function(n,a){!function setSelectedOption(e,i,n){if(i)for(var a=0;a<e.options.length;a++)if(parseOptionValue(e.options[a].value,n)===i){e.selectedIndex=a;break}}(i.$(n.selector),e[a],n.parser)}))},i.setDefaults=function setDefaults(){var e=this;each(or,(function(i){var n=i.hasOwnProperty("default")?i.default:0;e.$(i.selector).selectedIndex=n}))},i.restoreSettings=function restoreSettings(){var e;try{e=JSON.parse(s.a.localStorage.getItem("vjs-text-track-settings"))}catch(e){He.warn(e)}e&&this.setValues(e)},i.saveSettings=function saveSettings(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?s.a.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e)):s.a.localStorage.removeItem("vjs-text-track-settings")}catch(e){He.warn(e)}}},i.updateDisplay=function updateDisplay(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},i.conditionalBlur_=function conditionalBlur_(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,i=e&&e.subsCapsButton,n=e&&e.captionsButton;i?i.focus():n&&n.focus()},TextTrackSettings}(ai);wt.registerComponent("TextTrackSettings",ur);var lr=function(e){function ResizeManager(i,n){var a,o=n.ResizeObserver||s.a.ResizeObserver;null===n.ResizeObserver&&(o=!1);var u=mergeOptions({"createEl":!o,"reportTouchActivity":!1},n);return(a=e.call(this,i,u)||this).ResizeObserver=n.ResizeObserver||s.a.ResizeObserver,a.loadListener_=null,a.resizeObserver_=null,a.debouncedHandler_=function debounce(e,i,n,a){var o;void 0===a&&(a=s.a);var u=function debounced(){var s=this,u=arguments,l=function later(){o=null,l=null,n||e.apply(s,u)};!o&&n&&e.apply(s,u),a.clearTimeout(o),o=a.setTimeout(l,i)};return u.cancel=function cancel(){a.clearTimeout(o),o=null},u}((function(){a.resizeHandler()}),100,!1,f()(a)),o?(a.resizeObserver_=new a.ResizeObserver(a.debouncedHandler_),a.resizeObserver_.observe(i.el())):(a.loadListener_=function(){if(a.el_&&a.el_.contentWindow){var e=a.debouncedHandler_,i=a.unloadListener_=function(){off(this,"resize",e),off(this,"unload",i),i=null};on(a.el_.contentWindow,"unload",i),on(a.el_.contentWindow,"resize",e)}},a.one("load",a.loadListener_)),a}g()(ResizeManager,e);var i=ResizeManager.prototype;return i.createEl=function createEl(){return e.prototype.createEl.call(this,"iframe",{"className":"vjs-resize-manager","tabIndex":-1},{"aria-hidden":"true"})},i.resizeHandler=function resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},i.dispose=function dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,e.prototype.dispose.call(this)},ResizeManager}(wt);wt.registerComponent("ResizeManager",lr);var cr={"trackingThreshold":30,"liveTolerance":15},dr=function(e){function LiveTracker(i,n){var a,s=mergeOptions(cr,n,{"createEl":!1});return(a=e.call(this,i,s)||this).reset_(),a.on(a.player_,"durationchange",a.handleDurationchange),Ft&&"hidden"in u.a&&"visibilityState"in u.a&&a.on(u.a,"visibilitychange",a.handleVisibilityChange),a}g()(LiveTracker,e);var i=LiveTracker.prototype;return i.handleVisibilityChange=function handleVisibilityChange(){this.player_.duration()===1/0&&(u.a.hidden?this.stopTracking():this.startTracking())},i.trackLive_=function trackLive_(){var e=this.player_.seekable();if(e&&e.length){var i=Number(s.a.performance.now().toFixed(4)),n=-1===this.lastTime_?0:(i-this.lastTime_)/1e3;this.lastTime_=i,this.pastSeekEnd_=this.pastSeekEnd()+n;var a=this.liveCurrentTime(),o=this.player_.currentTime(),u=this.player_.paused()||this.seekedBehindLive_||Math.abs(a-o)>this.options_.liveTolerance;this.timeupdateSeen_&&a!==1/0||(u=!1),u!==this.behindLiveEdge_&&(this.behindLiveEdge_=u,this.trigger("liveedgechange"))}},i.handleDurationchange=function handleDurationchange(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},i.startTracking=function startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLive_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked):(this.one(this.player_,"play",this.handlePlay),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)))},i.handleFirstTimeupdate=function handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked)},i.handleSeeked=function handleSeeked(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=!this.skipNextSeeked_&&e>2,this.skipNextSeeked_=!1,this.trackLive_()},i.handlePlay=function handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},i.reset_=function reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.skipNextSeeked_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLive_),this.off(this.player_,"seeked",this.handleSeeked),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate),this.off(this.player_,"timeupdate",this.seekToLiveEdge)},i.stopTracking=function stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},i.seekableEnd=function seekableEnd(){for(var e=this.player_.seekable(),i=[],n=e?e.length:0;n--;)i.push(e.end(n));return i.length?i.sort()[i.length-1]:1/0},i.seekableStart=function seekableStart(){for(var e=this.player_.seekable(),i=[],n=e?e.length:0;n--;)i.push(e.start(n));return i.length?i.sort()[0]:0},i.liveWindow=function liveWindow(){var e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()},i.isLive=function isLive(){return this.isTracking()},i.atLiveEdge=function atLiveEdge(){return!this.behindLiveEdge()},i.liveCurrentTime=function liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()},i.pastSeekEnd=function pastSeekEnd(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},i.behindLiveEdge=function behindLiveEdge(){return this.behindLiveEdge_},i.isTracking=function isTracking(){return"number"==typeof this.trackingInterval_},i.seekToLiveEdge=function seekToLiveEdge(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},i.dispose=function dispose(){this.off(u.a,"visibilitychange",this.handleVisibilityChange),this.stopTracking(),e.prototype.dispose.call(this)},LiveTracker}(wt);wt.registerComponent("LiveTracker",dr);var hr,pr=function sourcesetLoad(e){var i=e.el();if(i.hasAttribute("src"))return e.triggerSourceset(i.src),!0;var n=e.$$("source"),a=[],s="";if(!n.length)return!1;for(var o=0;o<n.length;o++){var u=n[o].src;u&&-1===a.indexOf(u)&&a.push(u)}return!!a.length&&(1===a.length&&(s=a[0]),e.triggerSourceset(s),!0)},fr=Object.defineProperty({},"innerHTML",{"get":function get(){return this.cloneNode(!0).innerHTML},"set":function set(e){var i=u.a.createElement(this.nodeName.toLowerCase());i.innerHTML=e;for(var n=u.a.createDocumentFragment();i.childNodes.length;)n.appendChild(i.childNodes[0]);return this.innerText="",s.a.Element.prototype.appendChild.call(this,n),this.innerHTML}}),mr=function getDescriptor(e,i){for(var n={},a=0;a<e.length&&!((n=Object.getOwnPropertyDescriptor(e[a],i))&&n.set&&n.get);a++);return n.enumerable=!0,n.configurable=!0,n},gr=function firstSourceWatch(e){var i=e.el();if(!i.resetSourceWatch_){var n={},a=function getInnerHTMLDescriptor(e){return mr([e.el(),s.a.HTMLMediaElement.prototype,s.a.Element.prototype,fr],"innerHTML")}(e),o=function appendWrapper(n){return function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];var u=n.apply(i,s);return pr(e),u}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){i[e]&&(n[e]=i[e],i[e]=o(n[e]))})),Object.defineProperty(i,"innerHTML",mergeOptions(a,{"set":o(a.set)})),i.resetSourceWatch_=function(){i.resetSourceWatch_=null,Object.keys(n).forEach((function(e){i[e]=n[e]})),Object.defineProperty(i,"innerHTML",a)},e.one("sourceset",i.resetSourceWatch_)}},vr=Object.defineProperty({},"src",{"get":function get(){return this.hasAttribute("src")?bi(s.a.Element.prototype.getAttribute.call(this,"src")):""},"set":function set(e){return s.a.Element.prototype.setAttribute.call(this,"src",e),e}}),yr=function setupSourceset(e){if(e.featuresSourceset){var i=e.el();if(!i.resetSourceset_){var n=function getSrcDescriptor(e){return mr([e.el(),s.a.HTMLMediaElement.prototype,vr],"src")}(e),a=i.setAttribute,o=i.load;Object.defineProperty(i,"src",mergeOptions(n,{"set":function set(a){var s=n.set.call(i,a);return e.triggerSourceset(i.src),s}})),i.setAttribute=function(n,s){var o=a.call(i,n,s);return/src/i.test(n)&&e.triggerSourceset(i.src),o},i.load=function(){var n=o.call(i);return pr(e)||(e.triggerSourceset(""),gr(e)),n},i.currentSrc?e.triggerSourceset(i.currentSrc):pr(e)||gr(e),i.resetSourceset_=function(){i.resetSourceset_=null,i.load=o,i.setAttribute=a,Object.defineProperty(i,"src",n),i.resetSourceWatch_&&i.resetSourceWatch_()}}}},_r=function defineLazyProperty(e,i,n,a){void 0===a&&(a=!0);var s=function set(n){return Object.defineProperty(e,i,{"value":n,"enumerable":!0,"writable":!0})},o={"configurable":!0,"enumerable":!0,"get":function get(){var e=n();return s(e),e}};return a&&(o.set=s),Object.defineProperty(e,i,o)},Tr=function(e){function Html5(i,n){var a;a=e.call(this,i,n)||this;var s=i.source,o=!1;if(s&&(a.el_.currentSrc!==s.src||i.tag&&3===i.tag.initNetworkState_)?a.setSource(s):a.handleLateInit_(a.el_),i.enableSourceset&&a.setupSourcesetHandling_(),a.isScrubbing_=!1,a.el_.hasChildNodes()){for(var u=a.el_.childNodes,l=u.length,c=[];l--;){var h=u[l];"track"===h.nodeName.toLowerCase()&&(a.featuresNativeTextTracks?(a.remoteTextTrackEls().addTrackElement_(h),a.remoteTextTracks().addTrack(h.track),a.textTracks().addTrack(h.track),o||a.el_.hasAttribute("crossorigin")||!Ci(h.src)||(o=!0)):c.push(h))}for(var f=0;f<c.length;f++)a.el_.removeChild(c[f])}return a.proxyNativeTracks_(),a.featuresNativeTextTracks&&o&&He.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),a.restoreMetadataTracksInIOSNativePlayer_(),(Wt||$t||Rt)&&!0===i.nativeControlsForTouch&&a.setControls(!0),a.proxyWebkitFullscreen_(),a.triggerReady(),a}g()(Html5,e);var i=Html5.prototype;return i.dispose=function dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Html5.disposeMediaElement(this.el_),this.options_=null,e.prototype.dispose.call(this)},i.setupSourcesetHandling_=function setupSourcesetHandling_(){yr(this)},i.restoreMetadataTracksInIOSNativePlayer_=function restoreMetadataTracksInIOSNativePlayer_(){var e,i=this.textTracks(),n=function takeMetadataTrackSnapshot(){e=[];for(var n=0;n<i.length;n++){var a=i[n];"metadata"===a.kind&&e.push({"track":a,"storedMode":a.mode})}};n(),i.addEventListener("change",n),this.on("dispose",(function(){return i.removeEventListener("change",n)}));var a=function restoreTrackMode(){for(var n=0;n<e.length;n++){var a=e[n];"disabled"===a.track.mode&&a.track.mode!==a.storedMode&&(a.track.mode=a.storedMode)}i.removeEventListener("change",restoreTrackMode)};this.on("webkitbeginfullscreen",(function(){i.removeEventListener("change",n),i.removeEventListener("change",a),i.addEventListener("change",a)})),this.on("webkitendfullscreen",(function(){i.removeEventListener("change",n),i.addEventListener("change",n),i.removeEventListener("change",a)}))},i.overrideNative_=function overrideNative_(e,i){var n=this;if(i===this["featuresNative"+e+"Tracks"]){var a=e.toLowerCase();this[a+"TracksListeners_"]&&Object.keys(this[a+"TracksListeners_"]).forEach((function(e){n.el()[a+"Tracks"].removeEventListener(e,n[a+"TracksListeners_"][e])})),this["featuresNative"+e+"Tracks"]=!i,this[a+"TracksListeners_"]=null,this.proxyNativeTracksForType_(a)}},i.overrideNativeAudioTracks=function overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)},i.overrideNativeVideoTracks=function overrideNativeVideoTracks(e){this.overrideNative_("Video",e)},i.proxyNativeTracksForType_=function proxyNativeTracksForType_(e){var i=this,n=Li[e],a=this.el()[n.getterName],s=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&a&&a.addEventListener){var o={"change":function change(n){var a={"type":"change","target":s,"currentTarget":s,"srcElement":s};s.trigger(a),"text"===e&&i[Di.remoteText.getterName]().trigger(a)},"addtrack":function addtrack(e){s.addTrack(e.track)},"removetrack":function removetrack(e){s.removeTrack(e.track)}},u=function removeOldTracks(){for(var e=[],i=0;i<s.length;i++){for(var n=!1,o=0;o<a.length;o++)if(a[o]===s[i]){n=!0;break}n||e.push(s[i])}for(;e.length;)s.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=o,Object.keys(o).forEach((function(e){var n=o[e];a.addEventListener(e,n),i.on("dispose",(function(i){return a.removeEventListener(e,n)}))})),this.on("loadstart",u),this.on("dispose",(function(e){return i.off("loadstart",u)}))}},i.proxyNativeTracks_=function proxyNativeTracks_(){var e=this;Li.names.forEach((function(i){e.proxyNativeTracksForType_(i)}))},i.createEl=function createEl(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var i=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(i,e),Html5.disposeMediaElement(e),e=i}else{e=u.a.createElement("video");var n=mergeOptions({},this.options_.tag&&getAttributes(this.options_.tag));Wt&&!0===this.options_.nativeControlsForTouch||delete n.controls,setAttributes(e,video_es_assign(n,{"id":this.options_.techId,"class":"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&setAttribute(e,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);for(var a=["loop","muted","playsinline","autoplay"],s=0;s<a.length;s++){var o=a[s],l=this.options_[o];void 0!==l&&(l?setAttribute(e,o,o):removeAttribute(e,o),e[o]=l)}return e},i.handleLateInit_=function handleLateInit_(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var i=!1,n=function setLoadstartFired(){i=!0};this.on("loadstart",n);var a=function triggerLoadstart(){i||this.trigger("loadstart")};return this.on("loadedmetadata",a),void this.ready((function(){this.off("loadstart",n),this.off("loadedmetadata",a),i||this.trigger("loadstart")}))}var s=["loadstart"];s.push("loadedmetadata"),e.readyState>=2&&s.push("loadeddata"),e.readyState>=3&&s.push("canplay"),e.readyState>=4&&s.push("canplaythrough"),this.ready((function(){s.forEach((function(e){this.trigger(e)}),this)}))}},i.setScrubbing=function setScrubbing(e){this.isScrubbing_=e},i.scrubbing=function scrubbing(){return this.isScrubbing_},i.setCurrentTime=function setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&Gt?this.el_.fastSeek(e):this.el_.currentTime=e}catch(e){He(e,"Video is not ready. (Video.js)")}},i.duration=function duration(){var e=this;if(this.el_.duration===1/0&&Ot&&Ut&&0===this.el_.currentTime){return this.on("timeupdate",(function checkProgress(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",checkProgress))})),NaN}return this.el_.duration||NaN},i.width=function width(){return this.el_.offsetWidth},i.height=function height(){return this.el_.offsetHeight},i.proxyWebkitFullscreen_=function proxyWebkitFullscreen_(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var i=function endFn(){this.trigger("fullscreenchange",{"isFullscreen":!1})},n=function beginFn(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",i),this.trigger("fullscreenchange",{"isFullscreen":!0,"nativeIOSFullscreen":!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",(function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",i)}))}},i.supportsFullScreen=function supportsFullScreen(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=s.a.navigator&&s.a.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},i.enterFullScreen=function enterFullScreen(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)silencePromise(this.el_.play()),this.setTimeout((function(){e.pause();try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}}),0);else try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},i.exitFullScreen=function exitFullScreen(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},i.requestPictureInPicture=function requestPictureInPicture(){return this.el_.requestPictureInPicture()},i.src=function src(e){if(void 0===e)return this.el_.src;this.setSrc(e)},i.reset=function reset(){Html5.resetMediaElement(this.el_)},i.currentSrc=function currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},i.setControls=function setControls(e){this.el_.controls=!!e},i.addTextTrack=function addTextTrack(i,n,a){return this.featuresNativeTextTracks?this.el_.addTextTrack(i,n,a):e.prototype.addTextTrack.call(this,i,n,a)},i.createRemoteTextTrack=function createRemoteTextTrack(i){if(!this.featuresNativeTextTracks)return e.prototype.createRemoteTextTrack.call(this,i);var n=u.a.createElement("track");return i.kind&&(n.kind=i.kind),i.label&&(n.label=i.label),(i.language||i.srclang)&&(n.srclang=i.language||i.srclang),i.default&&(n.default=i.default),i.id&&(n.id=i.id),i.src&&(n.src=i.src),n},i.addRemoteTextTrack=function addRemoteTextTrack(i,n){var a=e.prototype.addRemoteTextTrack.call(this,i,n);return this.featuresNativeTextTracks&&this.el().appendChild(a),a},i.removeRemoteTextTrack=function removeRemoteTextTrack(i){if(e.prototype.removeRemoteTextTrack.call(this,i),this.featuresNativeTextTracks)for(var n=this.$$("track"),a=n.length;a--;)i!==n[a]&&i!==n[a].track||this.el().removeChild(n[a])},i.getVideoPlaybackQuality=function getVideoPlaybackQuality(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),s.a.performance&&"function"==typeof s.a.performance.now?e.creationTime=s.a.performance.now():s.a.performance&&s.a.performance.timing&&"number"==typeof s.a.performance.timing.navigationStart&&(e.creationTime=s.a.Date.now()-s.a.performance.timing.navigationStart),e},Html5}(Mi);_r(Tr,"TEST_VID",(function(){if(isReal()){var e=u.a.createElement("video"),i=u.a.createElement("track");return i.kind="captions",i.srclang="en",i.label="English",e.appendChild(i),e}})),Tr.isSupported=function(){try{Tr.TEST_VID.volume=.5}catch(e){return!1}return!(!Tr.TEST_VID||!Tr.TEST_VID.canPlayType)},Tr.canPlayType=function(e){return Tr.TEST_VID.canPlayType(e)},Tr.canPlaySource=function(e,i){return Tr.canPlayType(e.type)},Tr.canControlVolume=function(){try{var e=Tr.TEST_VID.volume;return Tr.TEST_VID.volume=e/2+.1,e!==Tr.TEST_VID.volume}catch(e){return!1}},Tr.canMuteVolume=function(){try{var e=Tr.TEST_VID.muted;return Tr.TEST_VID.muted=!e,Tr.TEST_VID.muted?setAttribute(Tr.TEST_VID,"muted","muted"):removeAttribute(Tr.TEST_VID,"muted"),e!==Tr.TEST_VID.muted}catch(e){return!1}},Tr.canControlPlaybackRate=function(){if(Ot&&Ut&&jt<58)return!1;try{var e=Tr.TEST_VID.playbackRate;return Tr.TEST_VID.playbackRate=e/2+.1,e!==Tr.TEST_VID.playbackRate}catch(e){return!1}},Tr.canOverrideAttributes=function(){try{var e=function noop(){};Object.defineProperty(u.a.createElement("video"),"src",{"get":e,"set":e}),Object.defineProperty(u.a.createElement("audio"),"src",{"get":e,"set":e}),Object.defineProperty(u.a.createElement("video"),"innerHTML",{"get":e,"set":e}),Object.defineProperty(u.a.createElement("audio"),"innerHTML",{"get":e,"set":e})}catch(e){return!1}return!0},Tr.supportsNativeTextTracks=function(){return Gt||zt&&Ut},Tr.supportsNativeVideoTracks=function(){return!(!Tr.TEST_VID||!Tr.TEST_VID.videoTracks)},Tr.supportsNativeAudioTracks=function(){return!(!Tr.TEST_VID||!Tr.TEST_VID.audioTracks)},Tr.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){var i=e[0],n=e[1];_r(Tr.prototype,i,(function(){return Tr[n]()}),!0)})),Tr.prototype.movingMediaElementInDOM=!zt,Tr.prototype.featuresFullscreenResize=!0,Tr.prototype.featuresProgressEvents=!0,Tr.prototype.featuresTimeupdateEvents=!0,Tr.patchCanPlayType=function(){Mt>=4&&!Bt&&!Ut&&(hr=Tr.TEST_VID&&Tr.TEST_VID.constructor.prototype.canPlayType,Tr.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(e)?"maybe":hr.call(this,e)})},Tr.unpatchCanPlayType=function(){var e=Tr.TEST_VID.constructor.prototype.canPlayType;return hr&&(Tr.TEST_VID.constructor.prototype.canPlayType=hr),e},Tr.patchCanPlayType(),Tr.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Tr.resetMediaElement=function(e){if(e){for(var i=e.querySelectorAll("source"),n=i.length;n--;)e.removeChild(i[n]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){Tr.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){Tr.prototype["set"+bt(e)]=function(i){this.el_[e]=i,i?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){Tr.prototype[e]=function(){return this.el_[e]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach((function(e){Tr.prototype["set"+bt(e)]=function(i){this.el_[e]=i}})),["pause","load","play"].forEach((function(e){Tr.prototype[e]=function(){return this.el_[e]()}})),Mi.withSourceHandlers(Tr),Tr.nativeSourceHandler={},Tr.nativeSourceHandler.canPlayType=function(e){try{return Tr.TEST_VID.canPlayType(e)}catch(e){return""}},Tr.nativeSourceHandler.canHandleSource=function(e,i){if(e.type)return Tr.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=Si(e.src);return Tr.nativeSourceHandler.canPlayType("video/"+n)}return""},Tr.nativeSourceHandler.handleSource=function(e,i,n){i.setSrc(e.src)},Tr.nativeSourceHandler.dispose=function(){},Tr.registerSourceHandler(Tr.nativeSourceHandler),Mi.registerTech("Html5",Tr);var br=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Sr={"canplay":"CanPlay","canplaythrough":"CanPlayThrough","playing":"Playing","seeked":"Seeked"},Cr=["tiny","xsmall","small","medium","large","xlarge","huge"],kr={};Cr.forEach((function(e){var i="x"===e.charAt(0)?"x-"+e.substring(1):e;kr[e]="vjs-layout-"+i}));var Er={"tiny":210,"xsmall":320,"small":425,"medium":768,"large":1440,"xlarge":2560,"huge":1/0},wr=function(e){function Player(i,n,a){var s;if(i.id=i.id||n.id||"vjs_video_"+newGUID(),(n=video_es_assign(Player.getTagSettings(i),n)).initChildren=!1,n.createEl=!1,n.evented=!1,n.reportTouchActivity=!1,!n.language)if("function"==typeof i.closest){var o=i.closest("[lang]");o&&o.getAttribute&&(n.language=o.getAttribute("lang"))}else for(var l=i;l&&1===l.nodeType;){if(getAttributes(l).hasOwnProperty("lang")){n.language=l.getAttribute("lang");break}l=l.parentNode}if((s=e.call(this,null,n,a)||this).boundDocumentFullscreenChange_=function(e){return s.documentFullscreenChange_(e)},s.boundFullWindowOnEscKey_=function(e){return s.fullWindowOnEscKey(e)},s.isFullscreen_=!1,s.log=We(s.id_),s.fsApi_=Yt,s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,s.debugEnabled_=!1,!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=i,s.tagAttributes=i&&getAttributes(i),s.language(s.options_.language),n.languages){var c={};Object.getOwnPropertyNames(n.languages).forEach((function(e){c[e.toLowerCase()]=n.languages[e]})),s.languages_=c}else s.languages_=Player.prototype.options_.languages;s.resetCache_(),s.poster_=n.poster||"",s.controls_=!!n.controls,i.controls=!1,i.removeAttribute("controls"),s.changingSrc_=!1,s.playCallbacks_=[],s.playTerminatedQueue_=[],i.hasAttribute("autoplay")?s.autoplay(!0):s.autoplay(s.options_.autoplay),n.plugins&&Object.keys(n.plugins).forEach((function(e){if("function"!=typeof s[e])throw new Error('plugin "'+e+'" does not exist')})),s.scrubbing_=!1,s.el_=s.createEl(),evented(f()(s),{"eventBusKey":"el_"}),s.fsApi_.requestFullscreen&&(on(u.a,s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_),s.on(s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_)),s.fluid_&&s.on(["playerreset","resize"],s.updateStyleEl_);var h=mergeOptions(s.options_);n.plugins&&Object.keys(n.plugins).forEach((function(e){s[e](n.plugins[e])})),n.debug&&s.debug(!0),s.options_.playerOptions=h,s.middleware_=[],s.initChildren(),s.isAudio("audio"===i.nodeName.toLowerCase()),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),Wt&&s.addClass("vjs-touch-enabled"),zt||s.addClass("vjs-workinghover"),Player.players[s.id_]=f()(s);var m="7.11.4".split(".")[0];return s.addClass("vjs-v"+m),s.userActive(!0),s.reportUserActivity(),s.one("play",s.listenForUserActivity_),s.on("stageclick",s.handleStageClick_),s.on("keydown",s.handleKeyDown),s.on("languagechange",s.handleLanguagechange),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s}g()(Player,e);var i=Player.prototype;return i.dispose=function dispose(){var i=this;this.trigger("dispose"),this.off("dispose"),off(u.a,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),off(u.a,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),Player.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),function clearCacheForPlayer(e){Bi[e.id()]=null}(this),Oi.names.forEach((function(e){var n=Oi[e],a=i[n.getterName]();a&&a.off&&a.off()})),e.prototype.dispose.call(this)},i.createEl=function createEl(){var i,n=this.tag,a=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),o="video-js"===this.tag.tagName.toLowerCase();a?i=this.el_=n.parentNode:o||(i=this.el_=e.prototype.createEl.call(this,"div"));var l=getAttributes(n);if(o){for(i=this.el_=n,n=this.tag=u.a.createElement("video");i.children.length;)n.appendChild(i.firstChild);hasClass(i,"video-js")||addClass(i,"video-js"),i.appendChild(n),a=this.playerElIngest_=i,Object.keys(i).forEach((function(e){try{n[e]=i[e]}catch(e){}}))}if(n.setAttribute("tabindex","-1"),l.tabindex="-1",(Ft||Ut&&Ht)&&(n.setAttribute("role","application"),l.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in l&&delete l.width,"height"in l&&delete l.height,Object.getOwnPropertyNames(l).forEach((function(e){o&&"class"===e||i.setAttribute(e,l[e]),o&&n.setAttribute(e,l[e])})),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=i.player=this,this.addClass("vjs-paused"),!0!==s.a.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Ze("vjs-styles-dimensions");var c=Ge(".vjs-styles-defaults"),h=Ge("head");h.insertBefore(this.styleEl_,c?c.nextSibling:h.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var f=n.getElementsByTagName("a"),m=0;m<f.length;m++){var g=f.item(m);addClass(g,"vjs-hidden"),g.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!a&&n.parentNode.insertBefore(i,n),prependTo(n,i),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=i,i},i.crossOrigin=function crossOrigin(e){if(!e)return this.techGet_("crossOrigin");"anonymous"===e||"use-credentials"===e?this.techCall_("setCrossOrigin",e):He.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"')},i.width=function width(e){return this.dimension("width",e)},i.height=function height(e){return this.dimension("height",e)},i.dimension=function dimension(e,i){var n=e+"_";if(void 0===i)return this[n]||0;if(""===i||"auto"===i)return this[n]=void 0,void this.updateStyleEl_();var a=parseFloat(i);isNaN(a)?He.error('Improper value "'+i+'" supplied for for '+e):(this[n]=a,this.updateStyleEl_())},i.fluid=function fluid(e){var i=this;if(void 0===e)return!!this.fluid_;this.fluid_=!!e,dt(this)&&this.off(["playerreset","resize"],this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),function addEventedCallback(e,i){dt(e)?i():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(i))}(this,(function(){i.on(["playerreset","resize"],i.updateStyleEl_)}))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},i.fill=function fill(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},i.aspectRatio=function aspectRatio(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},i.updateStyleEl_=function updateStyleEl_(){if(!0!==s.a.VIDEOJS_NO_DYNAMIC_STYLE){var e,i,n,a=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),o=a[1]/a[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/o:this.videoWidth()||300,i=void 0!==this.height_?this.height_:e*o,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),et(this.styleEl_,"\n      ."+n+" {\n        width: "+e+"px;\n        height: "+i+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*o+"%;\n      }\n    ")}else{var u="number"==typeof this.width_?this.width_:this.options_.width,l="number"==typeof this.height_?this.height_:this.options_.height,c=this.tech_&&this.tech_.el();c&&(u>=0&&(c.width=u),l>=0&&(c.height=l))}},i.loadTech_=function loadTech_(e,i){var n=this;this.tech_&&this.unloadTech_();var a=bt(e),s=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==a&&this.tag&&(Mi.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=a,this.isReady_=!1;var o={"source":i,"autoplay":"string"!=typeof this.autoplay()&&this.autoplay(),"nativeControlsForTouch":this.options_.nativeControlsForTouch,"playerId":this.id(),"techId":this.id()+"_"+s+"_api","playsinline":this.options_.playsinline,"preload":this.options_.preload,"loop":this.options_.loop,"disablePictureInPicture":this.options_.disablePictureInPicture,"muted":this.options_.muted,"poster":this.poster(),"language":this.language(),"playerElIngest":this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],"canOverridePoster":!!this.options_.techCanOverridePoster,"enableSourceset":this.options_.enableSourceset,"Promise":this.options_.Promise};Oi.names.forEach((function(e){var i=Oi[e];o[i.getterName]=n[i.privateName]})),video_es_assign(o,this.options_[a]),video_es_assign(o,this.options_[s]),video_es_assign(o,this.options_[e.toLowerCase()]),this.tag&&(o.tag=this.tag),i&&i.src===this.cache_.src&&this.cache_.currentTime>0&&(o.startTime=this.cache_.currentTime);var u=Mi.getTech(e);if(!u)throw new Error("No Tech named '"+a+"' exists! '"+a+"' should be registered using videojs.registerTech()'");this.tech_=new u(o),this.tech_.ready(ot(this,this.handleTechReady_),!0),ri(this.textTracksJson_||[],this.tech_),br.forEach((function(e){n.on(n.tech_,e,n["handleTech"+bt(e)+"_"])})),Object.keys(Sr).forEach((function(e){n.on(n.tech_,e,(function(i){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({"callback":n["handleTech"+Sr[e]+"_"].bind(n),"event":i}):n["handleTech"+Sr[e]+"_"](i)}))})),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===a&&this.tag||prependTo(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},i.unloadTech_=function unloadTech_(){var e=this;Oi.names.forEach((function(i){var n=Oi[i];e[n.privateName]=e[n.getterName]()})),this.textTracksJson_=ni(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},i.tech=function tech(e){return void 0===e&&He.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},i.addTechControlsListeners_=function addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},i.removeTechControlsListeners_=function removeTechControlsListeners_(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},i.handleTechReady_=function handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},i.handleTechLoadStart_=function handleTechLoadStart_(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},i.manualAutoplay_=function manualAutoplay_(e){var i=this;if(this.tech_&&"string"==typeof e){var n,a=function muted(){var e=i.muted();i.muted(!0);var n=function restoreMuted(){i.muted(e)};i.playTerminatedQueue_.push(n);var a=i.play();if(isPromise(a))return a.catch(n)};if("any"===e&&!0!==this.muted()?isPromise(n=this.play())&&(n=n.catch(a)):n="muted"===e&&!0!==this.muted()?a():this.play(),isPromise(n))return n.then((function(){i.trigger({"type":"autoplay-success","autoplay":e})})).catch((function(n){i.trigger({"type":"autoplay-failure","autoplay":e})}))}},i.updateSourceCaches_=function updateSourceCaches_(e){void 0===e&&(e="");var i=e,n="";"string"!=typeof i&&(i=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],i&&!n&&(n=function findMimetype(e,i){if(!i)return"";if(e.cache_.source.src===i&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter((function(e){return e.src===i}));if(n.length)return n[0].type;for(var a=e.$$("source"),s=0;s<a.length;s++){var o=a[s];if(o.type&&o.src&&o.src===i)return o.type}return Hi(i)}(this,i)),this.cache_.source=mergeOptions({},e,{"src":i,"type":n});for(var a=this.cache_.sources.filter((function(e){return e.src&&e.src===i})),s=[],o=this.$$("source"),u=[],l=0;l<o.length;l++){var c=getAttributes(o[l]);s.push(c),c.src&&c.src===i&&u.push(c.src)}u.length&&!a.length?this.cache_.sources=s:a.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=i},i.handleTechSourceset_=function handleTechSourceset_(e){var i=this;if(!this.changingSrc_){var n=function updateSourceCaches(e){return i.updateSourceCaches_(e)},a=this.currentSource().src,s=e.src;a&&!/^blob:/.test(a)&&/^blob:/.test(s)&&(!this.lastSource_||this.lastSource_.tech!==s&&this.lastSource_.player!==a)&&(n=function updateSourceCaches(){}),n(s),e.src||this.tech_.any(["sourceset","loadstart"],(function(e){if("sourceset"!==e.type){var n=i.techGet("currentSrc");i.lastSource_.tech=n,i.updateSourceCaches_(n)}}))}this.lastSource_={"player":this.currentSource().src,"tech":e.src},this.trigger({"src":e.src,"type":"sourceset"})},i.hasStarted=function hasStarted(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},i.handleTechPlay_=function handleTechPlay_(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},i.handleTechRateChange_=function handleTechRateChange_(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)})),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},i.handleTechWaiting_=function handleTechWaiting_(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var i=this.currentTime();this.on("timeupdate",(function timeUpdateListener(){i!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",timeUpdateListener))}))},i.handleTechCanPlay_=function handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")},i.handleTechCanPlayThrough_=function handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},i.handleTechPlaying_=function handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")},i.handleTechSeeking_=function handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")},i.handleTechSeeked_=function handleTechSeeked_(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},i.handleTechFirstPlay_=function handleTechFirstPlay_(){this.options_.starttime&&(He.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},i.handleTechPause_=function handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},i.handleTechEnded_=function handleTechEnded_(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},i.handleTechDurationChange_=function handleTechDurationChange_(){this.duration(this.techGet_("duration"))},i.handleTechClick_=function handleTechClick_(e){isSingleLeftClick(e)&&this.controls_&&(this.paused()?silencePromise(this.play()):this.pause())},i.handleTechDoubleClick_=function handleTechDoubleClick_(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(i){return i.contains(e.target)}))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},i.handleTechTap_=function handleTechTap_(){this.userActive(!this.userActive())},i.handleTechTouchStart_=function handleTechTouchStart_(){this.userWasActive=this.userActive()},i.handleTechTouchMove_=function handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()},i.handleTechTouchEnd_=function handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()},i.handleStageClick_=function handleStageClick_(){this.reportUserActivity()},i.toggleFullscreenClass_=function toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},i.documentFullscreenChange_=function documentFullscreenChange_(e){var i=e.target.player;if(!i||i===this){var n=this.el(),a=u.a[this.fsApi_.fullscreenElement]===n;!a&&n.matches?a=n.matches(":"+this.fsApi_.fullscreen):!a&&n.msMatchesSelector&&(a=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(a)}},i.handleTechFullscreenChange_=function handleTechFullscreenChange_(e,i){i&&(i.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(i.isFullscreen))},i.handleTechFullscreenError_=function handleTechFullscreenError_(e,i){this.trigger("fullscreenerror",i)},i.togglePictureInPictureClass_=function togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},i.handleTechEnterPictureInPicture_=function handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)},i.handleTechLeavePictureInPicture_=function handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)},i.handleTechError_=function handleTechError_(){var e=this.tech_.error();this.error(e)},i.handleTechTextData_=function handleTechTextData_(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},i.getCache=function getCache(){return this.cache_},i.resetCache_=function resetCache_(){this.cache_={"currentTime":0,"initTime":0,"inactivityTimeout":this.options_.inactivityTimeout,"duration":NaN,"lastVolume":1,"lastPlaybackRate":this.defaultPlaybackRate(),"media":null,"src":"","source":{},"sources":[],"volume":1}},i.techCall_=function techCall_(e,i){this.ready((function(){if(e in ji)return function video_es_set(e,i,n,a){return i[n](e.reduce(middlewareIterator(n),a))}(this.middleware_,this.tech_,e,i);if(e in Fi)return mediate(this.middleware_,this.tech_,e,i);try{this.tech_&&this.tech_[e](i)}catch(e){throw He(e),e}}),!0)},i.techGet_=function techGet_(e){if(this.tech_&&this.tech_.isReady_){if(e in Ui)return function video_es_get(e,i,n){return e.reduceRight(middlewareIterator(n),i[n]())}(this.middleware_,this.tech_,e);if(e in Fi)return mediate(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(i){if(void 0===this.tech_[e])throw He("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",i),i;if("TypeError"===i.name)throw He("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",i),this.tech_.isReady_=!1,i;throw He(i),i}}},i.play=function play(){var e=this,i=this.options_.Promise||s.a.Promise;return i?new i((function(i){e.play_(i)})):this.play_()},i.play_=function play_(e){var i=this;void 0===e&&(e=silencePromise),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){i.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!Gt&&!zt||this.load());var a=this.techGet_("play");null===a?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(a)},i.runPlayTerminatedQueue_=function runPlayTerminatedQueue_(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach((function(e){e()}))},i.runPlayCallbacks_=function runPlayCallbacks_(e){var i=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],i.forEach((function(i){i(e)}))},i.pause=function pause(){this.techCall_("pause")},i.paused=function paused(){return!1!==this.techGet_("paused")},i.played=function played(){return this.techGet_("played")||createTimeRanges(0,0)},i.scrubbing=function scrubbing(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},i.currentTime=function currentTime(e){return void 0!==e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.applyInitTime_),void this.one("canplay",this.applyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},i.applyInitTime_=function applyInitTime_(){this.currentTime(this.cache_.initTime)},i.duration=function duration(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},i.remainingTime=function remainingTime(){return this.duration()-this.currentTime()},i.remainingTimeDisplay=function remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())},i.buffered=function buffered(){var buffered=this.techGet_("buffered");return buffered&&buffered.length||(buffered=createTimeRanges(0,0)),buffered},i.bufferedPercent=function bufferedPercent$1(){return bufferedPercent(this.buffered(),this.duration())},i.bufferedEnd=function bufferedEnd(){var e=this.buffered(),i=this.duration(),n=e.end(e.length-1);return n>i&&(n=i),n},i.volume=function volume(e){var i;return void 0!==e?(i=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=i,this.techCall_("setVolume",i),void(i>0&&this.lastVolume_(i))):(i=parseFloat(this.techGet_("volume")),isNaN(i)?1:i)},i.muted=function muted(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},i.defaultMuted=function defaultMuted(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},i.lastVolume_=function lastVolume_(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},i.supportsFullScreen=function supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1},i.isFullscreen=function isFullscreen(e){if(void 0!==e){var i=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==i&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_},i.requestFullscreen=function requestFullscreen(e){var i=this.options_.Promise||s.a.Promise;if(i){var n=this;return new i((function(i,a){function offHandler(){n.off("fullscreenerror",errorHandler),n.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),i()}function errorHandler(e,i){offHandler(),a(i)}n.one("fullscreenchange",changeHandler),n.one("fullscreenerror",errorHandler);var s=n.requestFullscreenHelper_(e);if(s)return s.then(offHandler,offHandler),s}))}return this.requestFullscreenHelper_()},i.requestFullscreenHelper_=function requestFullscreenHelper_(e){var i,n=this;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(i=e)),this.fsApi_.requestFullscreen){var a=this.el_[this.fsApi_.requestFullscreen](i);return a&&a.then((function(){return n.isFullscreen(!0)}),(function(){return n.isFullscreen(!1)})),a}this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},i.exitFullscreen=function exitFullscreen(){var e=this.options_.Promise||s.a.Promise;if(e){var i=this;return new e((function(e,n){function offHandler(){i.off("fullscreenerror",errorHandler),i.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),e()}function errorHandler(e,i){offHandler(),n(i)}i.one("fullscreenchange",changeHandler),i.one("fullscreenerror",errorHandler);var a=i.exitFullscreenHelper_();if(a)return a.then(offHandler,offHandler),a}))}return this.exitFullscreenHelper_()},i.exitFullscreenHelper_=function exitFullscreenHelper_(){var e=this;if(this.fsApi_.requestFullscreen){var i=u.a[this.fsApi_.exitFullscreen]();return i&&i.then((function(){return e.isFullscreen(!1)})),i}this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},i.enterFullWindow=function enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=u.a.documentElement.style.overflow,on(u.a,"keydown",this.boundFullWindowOnEscKey_),u.a.documentElement.style.overflow="hidden",addClass(u.a.body,"vjs-full-window"),this.trigger("enterFullWindow")},i.fullWindowOnEscKey=function fullWindowOnEscKey(e){T.a.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},i.exitFullWindow=function exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,off(u.a,"keydown",this.boundFullWindowOnEscKey_),u.a.documentElement.style.overflow=this.docOrigOverflow,removeClass(u.a.body,"vjs-full-window"),this.trigger("exitFullWindow")},i.disablePictureInPicture=function disablePictureInPicture(e){if(void 0===e)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")},i.isInPictureInPicture=function isInPictureInPicture(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},i.requestPictureInPicture=function requestPictureInPicture(){if("pictureInPictureEnabled"in u.a&&!1===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")},i.exitPictureInPicture=function exitPictureInPicture(){if("pictureInPictureEnabled"in u.a)return u.a.exitPictureInPicture()},i.handleKeyDown=function handleKeyDown(e){var i=this.options_.userActions;if(i&&i.hotkeys){(function excludeElement(e){var i=e.tagName.toLowerCase();if(e.isContentEditable)return!0;if("input"===i)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type);return-1!==["textarea"].indexOf(i)})(this.el_.ownerDocument.activeElement)||("function"==typeof i.hotkeys?i.hotkeys.call(this,e):this.handleHotkeys(e))}},i.handleHotkeys=function handleHotkeys(e){var i=this.options_.userActions?this.options_.userActions.hotkeys:{},n=i.fullscreenKey,a=void 0===n?function(e){return T.a.isEventKey(e,"f")}:n,s=i.muteKey,o=void 0===s?function(e){return T.a.isEventKey(e,"m")}:s,l=i.playPauseKey,c=void 0===l?function(e){return T.a.isEventKey(e,"k")||T.a.isEventKey(e,"Space")}:l;if(a.call(this,e)){e.preventDefault(),e.stopPropagation();var h=wt.getComponent("FullscreenToggle");!1!==u.a[this.fsApi_.fullscreenEnabled]&&h.prototype.handleClick.call(this,e)}else if(o.call(this,e)){e.preventDefault(),e.stopPropagation(),wt.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(c.call(this,e)){e.preventDefault(),e.stopPropagation(),wt.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},i.canPlayType=function canPlayType(e){for(var i,n=0,a=this.options_.techOrder;n<a.length;n++){var s=a[n],o=Mi.getTech(s);if(o||(o=wt.getComponent(s)),o){if(o.isSupported()&&(i=o.canPlayType(e)))return i}else He.error('The "'+s+'" tech is undefined. Skipped browser support check for that tech.')}return""},i.selectSource=function selectSource(e){var i=this,n=this.options_.techOrder.map((function(e){return[e,Mi.getTech(e)]})).filter((function(e){var i=e[0],n=e[1];return n?n.isSupported():(He.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.'),!1)})),a=function findFirstPassingTechSourcePair(e,i,n){var a;return e.some((function(e){return i.some((function(i){if(a=n(e,i))return!0}))})),a},s=function finder(e,n){var a=e[0];if(e[1].canPlaySource(n,i.options_[a.toLowerCase()]))return{"source":n,"tech":a}};return(this.options_.sourceOrder?a(e,n,function flip(e){return function(i,n){return e(n,i)}}(s)):a(n,e,s))||!1},i.src=function src(e){var i=this;if(void 0===e)return this.cache_.src||"";var n=function filterSource(e){if(Array.isArray(e)){var i=[];e.forEach((function(e){e=filterSource(e),Array.isArray(e)?i=i.concat(e):video_es_isObject(e)&&i.push(e)})),e=i}else e="string"==typeof e&&e.trim()?[fixSource({"src":e})]:video_es_isObject(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[fixSource(e)]:[];return e}(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),setSource(this,n[0],(function(e,a){if(i.middleware_=a,i.cache_.sources=n,i.updateSourceCaches_(e),i.src_(e))return n.length>1?i.src(n.slice(1)):(i.changingSrc_=!1,i.setTimeout((function(){this.error({"code":4,"message":this.localize(this.options_.notSupportedMessage)})}),0),void i.triggerReady());!function setTech(e,i){e.forEach((function(e){return e.setTech&&e.setTech(i)}))}(a,i.tech_)}))):this.setTimeout((function(){this.error({"code":4,"message":this.localize(this.options_.notSupportedMessage)})}),0)},i.src_=function src_(e){var i=this,n=this.selectSource([e]);return!n||(function titleCaseEquals(e,i){return bt(e)===bt(i)}(n.tech,this.techName_)?(this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1}),!0),!1):(this.changingSrc_=!0,this.loadTech_(n.tech,n.source),this.tech_.ready((function(){i.changingSrc_=!1})),!1))},i.load=function load(){this.techCall_("load")},i.reset=function reset(){var e=this,i=this.options_.Promise||s.a.Promise;this.paused()||!i?this.doReset_():silencePromise(this.play().then((function(){return e.doReset_()})))},i.doReset_=function doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),dt(this)&&this.trigger("playerreset")},i.resetControlBarUI_=function resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},i.resetProgressBar_=function resetProgressBar_(){this.currentTime(0);var e=this.controlBar,i=e.durationDisplay,n=e.remainingTimeDisplay;i&&i.updateContent(),n&&n.updateContent()},i.resetPlaybackRate_=function resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},i.resetVolumeBar_=function resetVolumeBar_(){this.volume(1),this.trigger("volumechange")},i.currentSources=function currentSources(){var e=this.currentSource(),i=[];return 0!==Object.keys(e).length&&i.push(e),this.cache_.sources||i},i.currentSource=function currentSource(){return this.cache_.source||{}},i.currentSrc=function currentSrc(){return this.currentSource()&&this.currentSource().src||""},i.currentType=function currentType(){return this.currentSource()&&this.currentSource().type||""},i.preload=function preload(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},i.autoplay=function autoplay(e){if(void 0===e)return this.options_.autoplay||!1;var i;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),i=!1):this.options_.autoplay=!!e,i=void 0===i?this.options_.autoplay:i,this.tech_&&this.techCall_("setAutoplay",i)},i.playsinline=function playsinline(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},i.loop=function loop(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},i.poster=function poster(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},i.handleTechPosterChange_=function handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},i.controls=function controls(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},i.usingNativeControls=function usingNativeControls(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},i.error=function error(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&4===e.code){var i=function triggerSuppressedError(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],i),void this.one("loadstart",(function(){this.off(["click","touchstart"],i)}))}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new MediaError(e),this.addClass("vjs-error"),He.error("(CODE:"+this.error_.code+" "+MediaError.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},i.reportUserActivity=function reportUserActivity(e){this.userActivity_=!0},i.userActive=function userActive(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",(function(e){e.stopPropagation(),e.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},i.listenForUserActivity_=function listenForUserActivity_(){var e,i,n,a=ot(this,this.reportUserActivity),s=function handleMouseUpAndMouseLeave(i){a(),this.clearInterval(e)};this.on("mousedown",(function handleMouseDown(){a(),this.clearInterval(e),e=this.setInterval(a,250)})),this.on("mousemove",(function handleMouseMove(e){e.screenX===i&&e.screenY===n||(i=e.screenX,n=e.screenY,a())})),this.on("mouseup",s),this.on("mouseleave",s);var o,u=this.getChild("controlBar");!u||zt||Ot||(u.on("mouseenter",(function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0})),u.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",a),this.on("keyup",a),this.setInterval((function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(o);var e=this.options_.inactivityTimeout;e<=0||(o=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),e))}}),250)},i.playbackRate=function playbackRate(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},i.defaultPlaybackRate=function defaultPlaybackRate(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},i.isAudio=function isAudio(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},i.addTextTrack=function addTextTrack(e,i,n){if(this.tech_)return this.tech_.addTextTrack(e,i,n)},i.addRemoteTextTrack=function addRemoteTextTrack(e,i){if(this.tech_)return this.tech_.addRemoteTextTrack(e,i)},i.removeRemoteTextTrack=function removeRemoteTextTrack(e){void 0===e&&(e={});var i=e.track;if(i||(i=e),this.tech_)return this.tech_.removeRemoteTextTrack(i)},i.getVideoPlaybackQuality=function getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")},i.videoWidth=function videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},i.videoHeight=function videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},i.language=function language(e){if(void 0===e)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),dt(this)&&this.trigger("languagechange"))},i.languages=function languages(){return mergeOptions(Player.prototype.options_.languages,this.languages_)},i.toJSON=function toJSON(){var e=mergeOptions(this.options_),i=e.tracks;e.tracks=[];for(var n=0;n<i.length;n++){var a=i[n];(a=mergeOptions(a)).player=void 0,e.tracks[n]=a}return e},i.createModal=function createModal(e,i){var n=this;(i=i||{}).content=e||"";var a=new ai(this,i);return this.addChild(a),a.on("dispose",(function(){n.removeChild(a)})),a.open(),a},i.updateCurrentBreakpoint_=function updateCurrentBreakpoint_(){if(this.responsive())for(var e=this.currentBreakpoint(),i=this.currentWidth(),n=0;n<Cr.length;n++){var a=Cr[n];if(i<=this.breakpoints_[a]){if(e===a)return;e&&this.removeClass(kr[e]),this.addClass(kr[a]),this.breakpoint_=a;break}}},i.removeCurrentBreakpoint_=function removeCurrentBreakpoint_(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},i.breakpoints=function breakpoints(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=video_es_assign({},Er,e),this.updateCurrentBreakpoint_()),video_es_assign(this.breakpoints_)},i.responsive=function responsive(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},i.currentBreakpoint=function currentBreakpoint(){return this.breakpoint_},i.currentBreakpointClass=function currentBreakpointClass(){return kr[this.breakpoint_]||""},i.loadMedia=function loadMedia(e,i){var n=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=mergeOptions(e);var a=this.cache_.media,s=a.artwork,o=a.poster,u=a.src,l=a.textTracks;!s&&o&&(this.cache_.media.artwork=[{"src":o,"type":Hi(o)}]),u&&this.src(u),o&&this.poster(o),Array.isArray(l)&&l.forEach((function(e){return n.addRemoteTextTrack(e,!1)})),this.ready(i)}},i.getMedia=function getMedia(){if(!this.cache_.media){var e=this.poster(),i={"src":this.currentSources(),"textTracks":Array.prototype.map.call(this.remoteTextTracks(),(function(e){return{"kind":e.kind,"label":e.label,"language":e.language,"src":e.src}}))};return e&&(i.poster=e,i.artwork=[{"src":i.poster,"type":Hi(i.poster)}]),i}return mergeOptions(this.cache_.media)},Player.getTagSettings=function getTagSettings(e){var i={"sources":[],"tracks":[]},n=getAttributes(e),a=n["data-setup"];if(hasClass(e,"vjs-fill")&&(n.fill=!0),hasClass(e,"vjs-fluid")&&(n.fluid=!0),null!==a){var s=y()(a||"{}"),o=s[0],u=s[1];o&&He.error(o),video_es_assign(n,u)}if(video_es_assign(i,n),e.hasChildNodes())for(var l=e.childNodes,c=0,h=l.length;c<h;c++){var f=l[c],m=f.nodeName.toLowerCase();"source"===m?i.sources.push(getAttributes(f)):"track"===m&&i.tracks.push(getAttributes(f))}return i},i.flexNotSupported_=function flexNotSupported_(){var e=u.a.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},i.debug=function debug(e){if(void 0===e)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},Player}(wt);Oi.names.forEach((function(e){var i=Oi[e];wr.prototype[i.getterName]=function(){return this.tech_?this.tech_[i.getterName]():(this[i.privateName]=this[i.privateName]||new i.ListClass,this[i.privateName])}})),wr.prototype.crossorigin=wr.prototype.crossOrigin,wr.players={};var Pr=s.a.navigator;wr.prototype.options_={"techOrder":Mi.defaultTechOrder_,"html5":{},"inactivityTimeout":2e3,"playbackRates":[],"liveui":!1,"children":["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],"language":Pr&&(Pr.languages&&Pr.languages[0]||Pr.userLanguage||Pr.language)||"en","languages":{},"notSupportedMessage":"No compatible source was found for this media.","fullscreen":{"options":{"navigationUI":"hide"}},"breakpoints":{},"responsive":!1},["ended","seeking","seekable","networkState","readyState"].forEach((function(e){wr.prototype[e]=function(){return this.techGet_(e)}})),br.forEach((function(e){wr.prototype["handleTech"+bt(e)+"_"]=function(){return this.trigger(e)}})),wt.registerComponent("Player",wr);var Ir={},xr=function pluginExists(e){return Ir.hasOwnProperty(e)},Ar=function getPlugin(e){return xr(e)?Ir[e]:void 0},Lr=function markPluginAsActive(e,i){e.activePlugins_=e.activePlugins_||{},e.activePlugins_[i]=!0},Dr=function triggerSetupEvent(e,i,n){var a=(n?"before":"")+"pluginsetup";e.trigger(a,i),e.trigger(a+":"+i.name,i)},Or=function createPluginFactory(e,i){return i.prototype.name=e,function(){Dr(this,{"name":e,"plugin":i,"instance":null},!0);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];var o=w()(i,[this].concat(a));return this[e]=function(){return o},Dr(this,o.getEventHash()),o}},Mr=function(){function Plugin(e){if(this.constructor===Plugin)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),evented(this),delete this.trigger,stateful(this,this.constructor.defaultState),Lr(e,this.name),this.dispose=ot(this,this.dispose),e.on("dispose",this.dispose)}var e=Plugin.prototype;return e.version=function version(){return this.constructor.VERSION},e.getEventHash=function getEventHash(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},e.trigger=function trigger$1(e,i){return void 0===i&&(i={}),trigger(this.eventBusEl_,e,this.getEventHash(i))},e.handleStateChanged=function handleStateChanged(e){},e.dispose=function dispose(){var e=this.name,i=this.player;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i.activePlugins_[e]=!1,this.player=this.state=null,i[e]=Or(e,Ir[e])},Plugin.isBasic=function isBasic(e){var i="string"==typeof e?Ar(e):e;return"function"==typeof i&&!Plugin.prototype.isPrototypeOf(i.prototype)},Plugin.registerPlugin=function registerPlugin(e,i){if("string"!=typeof e)throw new Error('Illegal plugin name, "'+e+'", must be a string, was '+typeof e+".");if(xr(e))He.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(wr.prototype.hasOwnProperty(e))throw new Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if("function"!=typeof i)throw new Error('Illegal plugin for "'+e+'", must be a function, was '+typeof i+".");return Ir[e]=i,"plugin"!==e&&(Plugin.isBasic(i)?wr.prototype[e]=function createBasicPlugin(e,i){var n=function basicPluginWrapper(){Dr(this,{"name":e,"plugin":i,"instance":null},!0);var n=i.apply(this,arguments);return Lr(this,e),Dr(this,{"name":e,"plugin":i,"instance":n}),n};return Object.keys(i).forEach((function(e){n[e]=i[e]})),n}(e,i):wr.prototype[e]=Or(e,i)),i},Plugin.deregisterPlugin=function deregisterPlugin(e){if("plugin"===e)throw new Error("Cannot de-register base plugin.");xr(e)&&(delete Ir[e],delete wr.prototype[e])},Plugin.getPlugins=function getPlugins(e){var i;return void 0===e&&(e=Object.keys(Ir)),e.forEach((function(e){var n=Ar(e);n&&((i=i||{})[e]=n)})),i},Plugin.getPluginVersion=function getPluginVersion(e){var i=Ar(e);return i&&i.VERSION||""},Plugin}();Mr.getPlugin=Ar,Mr.BASE_PLUGIN_NAME="plugin",Mr.registerPlugin("plugin",Mr),wr.prototype.usingPlugin=function(e){return!!this.activePlugins_&&!0===this.activePlugins_[e]},wr.prototype.hasPlugin=function(e){return!!xr(e)};var Rr=function normalizeId(e){return 0===e.indexOf("#")?e.slice(1):e};function videojs$1(e,i,n){var a=videojs$1.getPlayer(e);if(a)return i&&He.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&a.ready(n),a;var s="string"==typeof e?Ge("#"+Rr(e)):e;if(!isEl(s))throw new TypeError("The element or ID supplied is not valid. (videojs)");s.ownerDocument.defaultView&&s.ownerDocument.body.contains(s)||He.warn("The element supplied is not included in the DOM"),i=i||{},videojs$1.hooks("beforesetup").forEach((function(e){var n=e(s,mergeOptions(i));video_es_isObject(n)&&!Array.isArray(n)?i=mergeOptions(i,n):He.error("please return an object in beforesetup hooks")}));var o=wt.getComponent("Player");return a=new o(s,i,n),videojs$1.hooks("setup").forEach((function(e){return e(a)})),a}if(videojs$1.hooks_={},videojs$1.hooks=function(e,i){return videojs$1.hooks_[e]=videojs$1.hooks_[e]||[],i&&(videojs$1.hooks_[e]=videojs$1.hooks_[e].concat(i)),videojs$1.hooks_[e]},videojs$1.hook=function(e,i){videojs$1.hooks(e,i)},videojs$1.hookOnce=function(e,i){videojs$1.hooks(e,[].concat(i).map((function(i){return function wrapper(){return videojs$1.removeHook(e,wrapper),i.apply(void 0,arguments)}})))},videojs$1.removeHook=function(e,i){var n=videojs$1.hooks(e).indexOf(i);return!(n<=-1)&&(videojs$1.hooks_[e]=videojs$1.hooks_[e].slice(),videojs$1.hooks_[e].splice(n,1),!0)},!0!==s.a.VIDEOJS_NO_DYNAMIC_STYLE&&isReal()){var Br=Ge(".vjs-styles-defaults");if(!Br){Br=Ze("vjs-styles-defaults");var Nr=Ge("head");Nr&&Nr.insertBefore(Br,Nr.firstChild),et(Br,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}autoSetupTimeout(1,videojs$1),videojs$1.VERSION="7.11.4",videojs$1.options=wr.prototype.options_,videojs$1.getPlayers=function(){return wr.players},videojs$1.getPlayer=function(e){var i,n=wr.players;if("string"==typeof e){var a=Rr(e),s=n[a];if(s)return s;i=Ge("#"+a)}else i=e;if(isEl(i)){var o=i,u=o.player,l=o.playerId;if(u||n[l])return u||n[l]}},videojs$1.getAllPlayers=function(){return Object.keys(wr.players).map((function(e){return wr.players[e]})).filter(Boolean)},videojs$1.players=wr.players,videojs$1.getComponent=wt.getComponent,videojs$1.registerComponent=function(e,i){Mi.isTech(i)&&He.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),wt.registerComponent.call(wt,e,i)},videojs$1.getTech=Mi.getTech,videojs$1.registerTech=Mi.registerTech,videojs$1.use=function use(e,i){Ri[e]=Ri[e]||[],Ri[e].push(i)},Object.defineProperty(videojs$1,"middleware",{"value":{},"writeable":!1,"enumerable":!0}),Object.defineProperty(videojs$1.middleware,"TERMINATOR",{"value":Ni,"writeable":!1,"enumerable":!0}),videojs$1.browser=Xt,videojs$1.TOUCH_ENABLED=Wt,videojs$1.extend=function extend(e,i){void 0===i&&(i={});var n=function subClass(){e.apply(this,arguments)},a={};for(var s in"object"==typeof i?(i.constructor!==Object.prototype.constructor&&(n=i.constructor),a=i):"function"==typeof i&&(n=i),I()(n,e),e&&(n.super_=e),a)a.hasOwnProperty(s)&&(n.prototype[s]=a[s]);return n},videojs$1.mergeOptions=mergeOptions,videojs$1.bind=ot,videojs$1.registerPlugin=Mr.registerPlugin,videojs$1.deregisterPlugin=Mr.deregisterPlugin,videojs$1.plugin=function(e,i){return He.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Mr.registerPlugin(e,i)},videojs$1.getPlugins=Mr.getPlugins,videojs$1.getPlugin=Mr.getPlugin,videojs$1.getPluginVersion=Mr.getPluginVersion,videojs$1.addLanguage=function(e,i){var n;return e=(""+e).toLowerCase(),videojs$1.options.languages=mergeOptions(videojs$1.options.languages,((n={})[e]=i,n)),videojs$1.options.languages[e]},videojs$1.log=He,videojs$1.createLogger=We,videojs$1.createTimeRange=videojs$1.createTimeRanges=createTimeRanges,videojs$1.formatTime=formatTime,videojs$1.setFormatTime=function setFormatTime(e){en=e},videojs$1.resetFormatTime=function resetFormatTime(){en=Zi},videojs$1.parseUrl=Ti,videojs$1.isCrossOrigin=Ci,videojs$1.EventTarget=lt,videojs$1.on=on,videojs$1.one=one,videojs$1.off=off,videojs$1.trigger=trigger,videojs$1.xhr=S.a,videojs$1.TextTrack=Pi,videojs$1.AudioTrack=Ii,videojs$1.VideoTrack=xi,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){videojs$1[e]=function(){return He.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Ke[e].apply(null,arguments)}})),videojs$1.computedStyle=computedStyle,videojs$1.dom=Ke,videojs$1.url=ki,videojs$1.defineLazyProperty=_r;var Ur,jr=A.a,Fr=function resolveManifestRedirect(e,i,n){return e&&n&&n.responseURL&&i!==n.responseURL?n.responseURL:i},Vr=videojs$1.log,Hr=function createPlaylistID(e,i){return e+"-"+i},Wr=function parseManifest(e){var i=e.manifestString,n=e.customTagParsers,a=void 0===n?[]:n,s=e.customTagMappers,o=void 0===s?[]:s,u=new U;return a.forEach((function(e){return u.addParser(e)})),o.forEach((function(e){return u.addTagMapper(e)})),u.push(i),u.end(),u.manifest},qr=function forEachMediaGroup(e,i){["AUDIO","SUBTITLES"].forEach((function(n){for(var a in e.mediaGroups[n])for(var s in e.mediaGroups[n][a]){var o=e.mediaGroups[n][a][s];i(o,n,a,s)}}))},$r=function setupMediaPlaylist(e){var i=e.playlist,n=e.uri,a=e.id;i.id=a,n&&(i.uri=n),i.attributes=i.attributes||{}},zr=function addPropertiesToMaster(e,i){e.uri=i;for(var n=0;n<e.playlists.length;n++)if(!e.playlists[n].uri){var a="placeholder-uri-"+n;e.playlists[n].uri=a}qr(e,(function(i,n,a,s){if(i.playlists&&i.playlists.length&&!i.playlists[0].uri){var o="placeholder-uri-"+n+"-"+a+"-"+s,u=Hr(0,o);i.playlists[0].uri=o,i.playlists[0].id=u,e.playlists[u]=i.playlists[0],e.playlists[o]=i.playlists[0]}})),function setupMediaPlaylists(e){for(var i=e.playlists.length;i--;){var n=e.playlists[i];$r({"playlist":n,"id":Hr(i,n.uri)}),n.resolvedUri=jr(e.uri,n.uri),e.playlists[n.id]=n,e.playlists[n.uri]=n,n.attributes.BANDWIDTH||Vr.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}(e),function resolveMediaGroupUris(e){qr(e,(function(i){i.uri&&(i.resolvedUri=jr(e.uri,i.uri))}))}(e)},Gr=videojs$1.mergeOptions,Xr=videojs$1.EventTarget,Kr=function resolveSegmentUris(e,i){e.resolvedUri||(e.resolvedUri=jr(i,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=jr(i,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=jr(i,e.map.uri))},Yr=function updateMaster(e,i){var n=Gr(e,{}),a=n.playlists[i.id];if(!a)return null;if(a.segments&&i.segments&&a.segments.length===i.segments.length&&a.endList===i.endList&&a.mediaSequence===i.mediaSequence)return null;var s=Gr(a,i);a.segments&&(s.segments=function updateSegments(e,i,n){var a=i.slice();n=n||0;for(var s=Math.min(e.length,i.length+n),o=n;o<s;o++)a[o-n]=Gr(e[o],a[o-n]);return a}(a.segments,i.segments,i.mediaSequence-a.mediaSequence)),s.segments.forEach((function(e){Kr(e,s.resolvedUri)}));for(var o=0;o<n.playlists.length;o++)n.playlists[o].id===i.id&&(n.playlists[o]=s);return n.playlists[i.id]=s,n.playlists[i.uri]=s,n},Qr=function refreshDelay(e,i){var n=e.segments[e.segments.length-1];return i&&n&&n.duration?1e3*n.duration:500*(e.targetDuration||10)},Jr=function(e){function PlaylistLoader(i,n,a){var s;if(void 0===a&&(a={}),s=e.call(this)||this,!i)throw new Error("A non-empty playlist URL or object is required");var o=a,u=o.withCredentials,l=void 0!==u&&u,c=o.handleManifestRedirects,h=void 0!==c&&c;s.src=i,s.vhs_=n,s.withCredentials=l,s.handleManifestRedirects=h;var f=n.options_;return s.customTagParsers=f&&f.customTagParsers||[],s.customTagMappers=f&&f.customTagMappers||[],s.state="HAVE_NOTHING",s.on("mediaupdatetimeout",(function(){"HAVE_METADATA"===s.state&&(s.state="HAVE_CURRENT_METADATA",s.request=s.vhs_.xhr({"uri":jr(s.master.uri,s.media().uri),"withCredentials":s.withCredentials},(function(e,i){if(s.request)return e?s.playlistRequestError(s.request,s.media(),"HAVE_METADATA"):void s.haveMetadata({"playlistString":s.request.responseText,"url":s.media().uri,"id":s.media().id})})))})),s}g()(PlaylistLoader,e);var i=PlaylistLoader.prototype;return i.playlistRequestError=function playlistRequestError(e,i,n){var a=i.uri,s=i.id;this.request=null,n&&(this.state=n),this.error={"playlist":this.master.playlists[s],"status":e.status,"message":"HLS playlist request error at URL: "+a+".","responseText":e.responseText,"code":e.status>=500?4:2},this.trigger("error")},i.haveMetadata=function haveMetadata(e){var i=this,n=e.playlistString,a=e.playlistObject,o=e.url,u=e.id;this.request=null,this.state="HAVE_METADATA";var l=a||Wr({"manifestString":n,"customTagParsers":this.customTagParsers,"customTagMappers":this.customTagMappers});l.lastRequest=Date.now(),$r({"playlist":l,"uri":o,"id":u});var c=Yr(this.master,l);this.targetDuration=l.targetDuration,c?(this.master=c,this.media_=this.master.playlists[u]):this.trigger("playlistunchanged"),this.media().endList||(s.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=s.a.setTimeout((function(){i.trigger("mediaupdatetimeout")}),Qr(this.media(),!!c))),this.trigger("loadedplaylist")},i.dispose=function dispose(){this.trigger("dispose"),this.stopRequest(),s.a.clearTimeout(this.mediaUpdateTimeout),s.a.clearTimeout(this.finalRenditionTimeout),this.off()},i.stopRequest=function stopRequest(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},i.media=function media(e,i){var n=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}if(s.a.clearTimeout(this.finalRenditionTimeout),i){var a=e.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=s.a.setTimeout(this.media.bind(this,e,!1),a)}else{var o=this.state,u=!this.media_||e.id!==this.media_.id;if(this.master.playlists[e.id].endList||e.endList&&e.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,void(u&&(this.trigger("mediachanging"),"HAVE_MASTER"===o?this.trigger("loadedmetadata"):this.trigger("mediachange")));if(u){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.vhs_.xhr({"uri":e.resolvedUri,"withCredentials":this.withCredentials},(function(i,a){if(n.request){if(e.lastRequest=Date.now(),e.resolvedUri=Fr(n.handleManifestRedirects,e.resolvedUri,a),i)return n.playlistRequestError(n.request,e,o);n.haveMetadata({"playlistString":a.responseText,"url":e.uri,"id":e.id}),"HAVE_MASTER"===o?n.trigger("loadedmetadata"):n.trigger("mediachange")}}))}}},i.pause=function pause(){this.stopRequest(),s.a.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")},i.load=function load(e){var i=this;s.a.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(e){var a=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=s.a.setTimeout((function(){return i.load()}),a)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()},i.start=function start(){var e=this;if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=s.a.location.href),this.src.resolvedUri=this.src.uri,void setTimeout((function(){e.setupInitialPlaylist(e.src)}),0);this.request=this.vhs_.xhr({"uri":this.src,"withCredentials":this.withCredentials},(function(i,n){if(e.request){if(e.request=null,i)return e.error={"status":n.status,"message":"HLS playlist request error at URL: "+e.src+".","responseText":n.responseText,"code":2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.src=Fr(e.handleManifestRedirects,e.src,n);var a=Wr({"manifestString":n.responseText,"customTagParsers":e.customTagParsers,"customTagMappers":e.customTagMappers});e.setupInitialPlaylist(a)}}))},i.srcUri=function srcUri(){return"string"==typeof this.src?this.src:this.src.uri},i.setupInitialPlaylist=function setupInitialPlaylist(e){if(this.state="HAVE_MASTER",e.playlists)return this.master=e,zr(this.master,this.srcUri()),e.playlists.forEach((function(e){e.segments&&e.segments.forEach((function(i){Kr(i,e.resolvedUri)}))})),this.trigger("loadedplaylist"),void(this.request||this.media(this.master.playlists[0]));var i=this.srcUri()||s.a.location.href;this.master=function masterForMedia(e,i){var n=Hr(0,i),a={"mediaGroups":{"AUDIO":{},"VIDEO":{},"CLOSED-CAPTIONS":{},"SUBTITLES":{}},"uri":s.a.location.href,"resolvedUri":s.a.location.href,"playlists":[{"uri":i,"id":n,"resolvedUri":i,"attributes":{}}]};return a.playlists[n]=a.playlists[0],a.playlists[i]=a.playlists[0],a}(0,i),this.haveMetadata({"playlistObject":e,"url":i,"id":this.master.playlists[0].id}),this.trigger("loadedmetadata")},PlaylistLoader}(Xr),Zr=function filterRanges(e,i){var n,a=[];if(e&&e.length)for(n=0;n<e.length;n++)i(e.start(n),e.end(n))&&a.push([e.start(n),e.end(n)]);return videojs$1.createTimeRanges(a)},ea=function findRange(e,i){return Zr(e,(function(e,n){return e-.1<=i&&n+.1>=i}))},ta=function findNextRange(e,i){return Zr(e,(function(e){return e-1/30>=i}))},ia=function printableRange(e){var i=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)i.push(e.start(n)+" => "+e.end(n));return i.join(", ")},na=function timeRangesToArray(e){for(var i=[],n=0;n<e.length;n++)i.push({"start":e.start(n),"end":e.end(n)});return i},ra=videojs$1.createTimeRange,aa=function intervalDuration(e,i,n){if(void 0===i&&(i=e.mediaSequence+e.segments.length),i<e.mediaSequence)return 0;var a=function backwardDuration(e,i){var n=0,a=i-e.mediaSequence,s=e.segments[a];if(s){if(void 0!==s.start)return{"result":s.start,"precise":!0};if(void 0!==s.end)return{"result":s.end-s.duration,"precise":!0}}for(;a--;){if(void 0!==(s=e.segments[a]).end)return{"result":n+s.end,"precise":!0};if(n+=s.duration,void 0!==s.start)return{"result":n+s.start,"precise":!0}}return{"result":n,"precise":!1}}(e,i);if(a.precise)return a.result;var s=function forwardDuration(e,i){for(var n,a=0,s=i-e.mediaSequence;s<e.segments.length;s++){if(void 0!==(n=e.segments[s]).start)return{"result":n.start-a,"precise":!0};if(a+=n.duration,void 0!==n.end)return{"result":n.end-a,"precise":!0}}return{"result":-1,"precise":!1}}(e,i);return s.precise?s.result:a.result+n},sa=function duration(e,i,n){if(!e)return 0;if("number"!=typeof n&&(n=0),void 0===i){if(e.totalDuration)return e.totalDuration;if(!e.endList)return s.a.Infinity}return aa(e,i,n)},oa=function sumDurations(e,i,n){var a=0;if(i>n){var s=[n,i];i=s[0],n=s[1]}if(i<0){for(var o=i;o<Math.min(0,n);o++)a+=e.targetDuration;i=0}for(var u=i;u<n;u++)a+=e.segments[u].duration;return a},ua=function safeLiveIndex(e,i){if(!e.segments.length)return 0;var n=e.segments.length,a=e.segments[n-1].duration||e.targetDuration,s="number"==typeof i?i:a+2*e.targetDuration;if(0===s)return n;for(var o=0;n--&&!((o+=e.segments[n].duration)>=s););return Math.max(0,n)},la=function playlistEnd(e,i,n,a){if(!e||!e.segments)return null;if(e.endList)return sa(e);if(null===i)return null;i=i||0;var s=n?ua(e,a):e.segments.length;return aa(e,e.mediaSequence+s,i)},ca=function isBlacklisted(e){return e.excludeUntil&&e.excludeUntil>Date.now()},da=function isIncompatible(e){return e.excludeUntil&&e.excludeUntil===1/0},ha=function isEnabled(e){var i=ca(e);return!e.disabled&&!i},pa=function hasAttribute(e,i){return i.attributes&&i.attributes[e]},fa=function isLowestEnabledRendition(e,i){if(1===e.playlists.length)return!0;var n=i.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter((function(e){return!!ha(e)&&(e.attributes.BANDWIDTH||0)<n})).length},ma={"duration":sa,"seekable":function seekable(e,i,n){var a=i||0,s=la(e,i,!0,n);return null===s?ra():ra(a,s)},"safeLiveIndex":ua,"getMediaInfoForTime":function getMediaInfoForTime(e,i,n,a){var s,o=e.segments.length,u=i-a;if(u<0){if(n>0)for(s=n-1;s>=0;s--)if((u+=e.segments[s].duration+1/30)>0)return{"mediaIndex":s,"startTime":a-oa(e,n,s)};return{"mediaIndex":0,"startTime":i}}if(n<0){for(s=n;s<0;s++)if((u-=e.targetDuration)<0)return{"mediaIndex":0,"startTime":i};n=0}for(s=n;s<o;s++)if((u-=e.segments[s].duration+1/30)<0)return{"mediaIndex":s,"startTime":a+oa(e,n,s)};return{"mediaIndex":o-1,"startTime":i}},"isEnabled":ha,"isDisabled":function isDisabled(e){return e.disabled},"isBlacklisted":ca,"isIncompatible":da,"playlistEnd":la,"isAes":function isAes(e){for(var i=0;i<e.segments.length;i++)if(e.segments[i].key)return!0;return!1},"hasAttribute":pa,"estimateSegmentRequestTime":function estimateSegmentRequestTime(e,i,n,a){return void 0===a&&(a=0),pa("BANDWIDTH",n)?(e*n.attributes.BANDWIDTH-8*a)/i:NaN},"isLowestEnabledRendition":fa},ga=videojs$1.xhr,va=videojs$1.mergeOptions,ya=function callbackWrapper(e,i,n,a){var s="arraybuffer"===e.responseType?e.response:e.responseText;!i&&s&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=s.byteLength||s.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),n.headers&&(e.responseHeaders=n.headers),i&&"ETIMEDOUT"===i.code&&(e.timedout=!0),i||e.aborted||200===n.statusCode||206===n.statusCode||0===n.statusCode||(i=new Error("XHR Failed with a response of: "+(e&&(s||e.responseText)))),a(i,e)},_a=function xhrFactory(){return function XhrFunction(e,i){e=va({"timeout":45e3},e);var n=XhrFunction.beforeRequest||videojs$1.Vhs.xhr.beforeRequest;if(n&&"function"==typeof n){var a=n(e);a&&(e=a)}var s=ga(e,(function(e,n){return ya(s,e,n,i)})),o=s.abort;return s.abort=function(){return s.aborted=!0,o.apply(s,arguments)},s.uri=e.uri,s.requestTime=Date.now(),s}},Ta=function segmentXhrHeaders(e){var i={};return e.byterange&&(i.Range=function byterangeStr(e){var i=e.offset+e.length-1;return"bytes="+e.offset+"-"+i}(e.byterange)),i},ba=function textRange(e,i){return e.start(i)+"-"+e.end(i)},Sa=function formatHexString(e,i){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(i%2?" ":"")},Ca=function formatAsciiString(e){return e>=32&&e<126?String.fromCharCode(e):"."},ka=function createTransferableMessage(e){var i={};return Object.keys(e).forEach((function(n){var a=e[n];ArrayBuffer.isView(a)?i[n]={"bytes":a.buffer,"byteOffset":a.byteOffset,"byteLength":a.byteLength}:i[n]=a})),i},Ea=function initSegmentId(e){var i=e.byterange||{"length":1/0,"offset":0};return[i.length,i.offset,e.resolvedUri].join(",")},wa=function segmentKeyId(e){return e.resolvedUri},Pa=function hexDump(e){for(var i=Array.prototype.slice.call(e),n="",a=0;a<i.length/16;a++)n+=i.slice(16*a,16*a+16).map(Sa).join("")+" "+i.slice(16*a,16*a+16).map(Ca).join("")+"\n";return n},Ia=Object.freeze({"__proto__":null,"createTransferableMessage":ka,"initSegmentId":Ea,"segmentKeyId":wa,"hexDump":Pa,"tagDump":function tagDump(e){var i=e.bytes;return Pa(i)},"textRanges":function textRanges(e){var i,n="";for(i=0;i<e.length;i++)n+=ba(e,i)+" ";return n}}),xa=function getProgramTime(e){var i=e.playlist,n=e.time,a=void 0===n?void 0:n,s=e.callback;if(!s)throw new Error("getProgramTime: callback must be provided");if(!i||void 0===a)return s({"message":"getProgramTime: playlist and time must be provided"});var o=function findSegmentForPlayerTime(e,i){if(!i||!i.segments||0===i.segments.length)return null;for(var n,a=0,s=0;s<i.segments.length&&!(e<=(a=(n=i.segments[s]).videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:a+n.duration));s++);var o=i.segments[i.segments.length-1];if(o.videoTimingInfo&&o.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>a){if(e>a+.25*o.duration)return null;n=o}return{"segment":n,"estimatedStart":n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:a-n.duration,"type":n.videoTimingInfo?"accurate":"estimate"}}(a,i);if(!o)return s({"message":"valid programTime was not found"});if("estimate"===o.type)return s({"message":"Accurate programTime could not be determined. Please seek to e.seekTime and try again","seekTime":o.estimatedStart});var u={"mediaSeconds":a},l=function playerTimeToProgramTime(e,i){if(!i.dateTimeObject)return null;var n=i.videoTimingInfo.transmuxerPrependedSeconds,a=e-(i.videoTimingInfo.transmuxedPresentationStart+n);return new Date(i.dateTimeObject.getTime()+1e3*a)}(a,o.segment);return l&&(u.programDateTime=l.toISOString()),s(null,u)},Aa=function seekToProgramTime(e){var i=e.programTime,n=e.playlist,a=e.retryCount,s=void 0===a?2:a,o=e.seekTo,u=e.pauseAfterSeek,l=void 0===u||u,c=e.tech,h=e.callback;if(!h)throw new Error("seekToProgramTime: callback must be provided");if(void 0===i||!n||!o)return h({"message":"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!n.endList&&!c.hasStarted_)return h({"message":"player must be playing a live stream to start buffering"});if(!function verifyProgramDateTimeTags(e){if(!e.segments||0===e.segments.length)return!1;for(var i=0;i<e.segments.length;i++){if(!e.segments[i].dateTimeObject)return!1}return!0}(n))return h({"message":"programDateTime tags must be provided in the manifest "+n.resolvedUri});var f=function findSegmentForProgramTime(e,i){var n;try{n=new Date(e)}catch(e){return null}if(!i||!i.segments||0===i.segments.length)return null;var a=i.segments[0];if(n<a.dateTimeObject)return null;for(var s=0;s<i.segments.length-1;s++){if(a=i.segments[s],n<i.segments[s+1].dateTimeObject)break}var o=i.segments[i.segments.length-1],u=o.dateTimeObject,l=o.videoTimingInfo?function originalSegmentVideoDuration(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds}(o.videoTimingInfo):o.duration+.25*o.duration;return n>new Date(u.getTime()+1e3*l)?null:(n>u&&(a=o),{"segment":a,"estimatedStart":a.videoTimingInfo?a.videoTimingInfo.transmuxedPresentationStart:ma.duration(i,i.mediaSequence+i.segments.indexOf(a)),"type":a.videoTimingInfo?"accurate":"estimate"})}(i,n);if(!f)return h({"message":i+" was not found in the stream"});var m=f.segment,g=function getOffsetFromTimestamp(e,i){var n,a;try{n=new Date(e),a=new Date(i)}catch(e){}var s=n.getTime();return(a.getTime()-s)/1e3}(m.dateTimeObject,i);if("estimate"===f.type)return 0===s?h({"message":i+" is not buffered yet. Try again"}):(o(f.estimatedStart+g),void c.one("seeked",(function(){seekToProgramTime({"programTime":i,"playlist":n,"retryCount":s-1,"seekTo":o,"pauseAfterSeek":l,"tech":c,"callback":h})})));var v=m.start+g;c.one("seeked",(function seekedCallback(){return h(null,c.currentTime())})),l&&c.pause(),o(v)},La=function callbackOnCompleted(e,i){if(4===e.readyState)return i()},Da=videojs$1.EventTarget,Oa=videojs$1.mergeOptions,Ma=function generateSidxKey(e){var i=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+i},Ra=function equivalentSidx(e,i){return(Boolean(!e.map&&!i.map)||Boolean(e.map&&i.map&&e.map.byterange.offset===i.map.byterange.offset&&e.map.byterange.length===i.map.byterange.length))&&e.uri===i.uri&&e.byterange.offset===i.byterange.offset&&e.byterange.length===i.byterange.length},Ba=function compareSidxEntry(e,i){var n={};for(var a in e){var s=e[a].sidx;if(s){var o=Ma(s);if(!i[o])break;var u=i[o].sidxInfo;Ra(u,s)&&(n[o]=i[o])}}return n},Na=function(e){function DashPlaylistLoader(i,n,a,s){var o;void 0===a&&(a={}),(o=e.call(this)||this).masterPlaylistLoader_=s||f()(o),s||(o.isMaster_=!0);var u=a,l=u.withCredentials,c=void 0!==l&&l,h=u.handleManifestRedirects,m=void 0!==h&&h;if(o.vhs_=n,o.withCredentials=c,o.handleManifestRedirects=m,!i)throw new Error("A non-empty playlist URL or object is required");return o.on("minimumUpdatePeriod",(function(){o.refreshXml_()})),o.on("mediaupdatetimeout",(function(){o.refreshMedia_(o.media().id)})),o.state="HAVE_NOTHING",o.loadedPlaylists_={},o.isMaster_?(o.masterPlaylistLoader_.srcUrl=i,o.masterPlaylistLoader_.sidxMapping_={}):o.childPlaylist_=i,o}g()(DashPlaylistLoader,e);var i=DashPlaylistLoader.prototype;return i.requestErrored_=function requestErrored_(e,i,n){return!this.request||(this.request=null,e?(this.error="object"!=typeof e||e instanceof Error?{"status":i.status,"message":"DASH request error at URL: "+i.uri,"response":i.response,"code":2}:e,n&&(this.state=n),this.trigger("error"),!0):void 0)},i.addSidxSegments_=function addSidxSegments_(e,i,n){var a=this,o=e.sidx&&Ma(e.sidx);if(e.sidx&&o&&!this.masterPlaylistLoader_.sidxMapping_[o]){var u=Fr(this.handleManifestRedirects,e.sidx.resolvedUri),l=this.masterPlaylistLoader_.sidxMapping_;l[o]={"sidxInfo":e.sidx};var c=function fin(s,u){if(!a.requestErrored_(s,u,i)){var c=De()(Object(Me.toUint8)(u.response).subarray(8));return l[o].sidx=c,Ae(e,c,e.sidx.resolvedUri),n(!0)}};this.request=function containerRequest(e,i,n){var a,s=[],o=!1,u=function endRequestAndCallback(e,i,a,s){return i.abort(),o=!0,n(e,i,a,s)},l=function progressListener(e,i){if(!o){if(e)return u(e,i,"",s);var n=i.responseText.substring(s&&s.byteLength||0,i.responseText.length);if(s=Object(Me.concatTypedArrays)(s,Object(Me.stringToBytes)(n,!0)),a=a||Object(Oe.getId3Offset)(s),s.length<10||a&&s.length<a+2)return La(i,(function(){return u(e,i,"",s)}));var l=Object(Oe.detectContainerForBytes)(s);return"ts"===l&&s.length<188||!l&&s.length<376?La(i,(function(){return u(e,i,"",s)})):u(null,i,l,s)}},c=i({"uri":e,"beforeSend":function beforeSend(e){e.overrideMimeType("text/plain; charset=x-user-defined"),e.addEventListener("progress",(function(i){i.total,i.loaded;return ya(e,null,{"statusCode":e.status},l)}))}},(function(e,i){return ya(c,e,i,l)}));return c}(u,this.vhs_.xhr,(function(i,n,s,o){if(i)return c(i,n);if(!s||"mp4"!==s)return c({"status":n.status,"message":"Unsupported "+(s||"unknown")+" container type for sidx segment at URL: "+u,"response":"","playlist":e,"internal":!0,"blacklistDuration":1/0,"code":2},n);var l=e.sidx.byterange,h=l.offset,f=l.length;if(o.length>=f+h)return c(i,{"response":o.subarray(h,h+f),"status":n.status,"uri":n.uri});a.request=a.vhs_.xhr({"uri":u,"responseType":"arraybuffer","headers":Ta({"byterange":e.sidx.byterange})},c)}))}else this.mediaRequest_=s.a.setTimeout((function(){return n(!1)}),0)},i.dispose=function dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},s.a.clearTimeout(this.minimumUpdatePeriodTimeout_),s.a.clearTimeout(this.mediaRequest_),s.a.clearTimeout(this.mediaUpdateTimeout),this.off()},i.hasPendingRequest=function hasPendingRequest(){return this.request||this.mediaRequest_},i.stopRequest=function stopRequest(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},i.media=function media(e){var i=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if("string"==typeof e){if(!this.masterPlaylistLoader_.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.masterPlaylistLoader_.master.playlists[e]}var a=!this.media_||e.id!==this.media_.id;if(a&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList)return this.state="HAVE_METADATA",this.media_=e,void(a&&(this.trigger("mediachanging"),this.trigger("mediachange")));a&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,n,(function(a){i.haveMetadata({"startingState":n,"playlist":e})})))},i.haveMetadata=function haveMetadata(e){var i=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.id]=n,this.mediaRequest_=null,this.refreshMedia_(n.id),"HAVE_MASTER"===i?this.trigger("loadedmetadata"):this.trigger("mediachange")},i.pause=function pause(){this.stopRequest(),s.a.clearTimeout(this.mediaUpdateTimeout),s.a.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)},i.load=function load(e){var i=this;s.a.clearTimeout(this.mediaUpdateTimeout),s.a.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();if(e){var a=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=s.a.setTimeout((function(){return i.load()}),a)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()},i.start=function start(){var e=this;this.started=!0,this.isMaster_?this.requestMaster_((function(i,n){e.haveMaster_(),e.hasPendingRequest()||e.media_||e.media(e.masterPlaylistLoader_.master.playlists[0])})):this.mediaRequest_=s.a.setTimeout((function(){return e.haveMaster_()}),0)},i.requestMaster_=function requestMaster_(e){var i=this;this.request=this.vhs_.xhr({"uri":this.masterPlaylistLoader_.srcUrl,"withCredentials":this.withCredentials},(function(n,a){if(!i.requestErrored_(n,a)){var s=a.responseText!==i.masterPlaylistLoader_.masterXml_;return i.masterPlaylistLoader_.masterXml_=a.responseText,a.responseHeaders&&a.responseHeaders.date?i.masterLoaded_=Date.parse(a.responseHeaders.date):i.masterLoaded_=Date.now(),i.masterPlaylistLoader_.srcUrl=Fr(i.handleManifestRedirects,i.masterPlaylistLoader_.srcUrl,a),s?(i.handleMaster_(),void i.syncClientServerClock_((function(){return e(a,s)}))):e(a,s)}"HAVE_NOTHING"===i.state&&(i.started=!1)}))},i.syncClientServerClock_=function syncClientServerClock_(e){var i=this,n=xe(this.masterPlaylistLoader_.masterXml_);return null===n?(this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===n.method?(this.masterPlaylistLoader_.clientOffset_=n.value-Date.now(),e()):void(this.request=this.vhs_.xhr({"uri":jr(this.masterPlaylistLoader_.srcUrl,n.value),"method":n.method,"withCredentials":this.withCredentials},(function(a,s){if(i.request){if(a)return i.masterPlaylistLoader_.clientOffset_=i.masterLoaded_-Date.now(),e();var o;o="HEAD"===n.method?s.responseHeaders&&s.responseHeaders.date?Date.parse(s.responseHeaders.date):i.masterLoaded_:Date.parse(s.responseText),i.masterPlaylistLoader_.clientOffset_=o-Date.now(),e()}})))},i.haveMaster_=function haveMaster_(){this.state="HAVE_MASTER",this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},i.handleMaster_=function handleMaster_(){this.mediaRequest_=null;var e=function parseMasterXml(e){var i=e.masterXml,n=e.srcUrl,a=e.clientOffset,s=e.sidxMapping,o=Ie(i,{"manifestUri":n,"clientOffset":a,"sidxMapping":s});return zr(o,n),o}({"masterXml":this.masterPlaylistLoader_.masterXml_,"srcUrl":this.masterPlaylistLoader_.srcUrl,"clientOffset":this.masterPlaylistLoader_.clientOffset_,"sidxMapping":this.masterPlaylistLoader_.sidxMapping_}),i=this.masterPlaylistLoader_.master;i&&(e=function updateMaster$1(e,i,n){for(var a=!0,s=Oa(e,{"duration":i.duration,"minimumUpdatePeriod":i.minimumUpdatePeriod}),o=0;o<i.playlists.length;o++){var u=i.playlists[o];if(u.sidx){var l=Ma(u.sidx);n&&n[l]&&Ae(u,n[l].sidx,u.sidx.resolvedUri)}var c=Yr(s,u);c&&(s=c,a=!1)}return qr(i,(function(e,i,n,o){if(e.playlists&&e.playlists.length){var u=e.playlists[0].id,l=Yr(s,e.playlists[0]);l&&((s=l).mediaGroups[i][n][o].playlists[0]=s.playlists[u],a=!1)}})),i.minimumUpdatePeriod!==e.minimumUpdatePeriod&&(a=!1),a?null:s}(i,e,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=e||i;var n=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];return n&&n!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=n),(!i||e&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(e)},i.updateMinimumUpdatePeriodTimeout_=function updateMinimumUpdatePeriodTimeout_(){var e=this;s.a.clearTimeout(this.minimumUpdatePeriodTimeout_);var i=function createMUPTimeout(i){e.minimumUpdatePeriodTimeout_=s.a.setTimeout((function(){e.trigger("minimumUpdatePeriod"),createMUPTimeout(i)}),i)},n=this.masterPlaylistLoader_.master&&this.masterPlaylistLoader_.master.minimumUpdatePeriod;n>0?i(n):0===n&&(this.media()?i(1e3*this.media().targetDuration):this.one("loadedplaylist",(function(){i(1e3*e.media().targetDuration)})))},i.refreshXml_=function refreshXml_(){var e=this;this.requestMaster_((function(i,n){n&&(e.media_&&(e.media_=e.masterPlaylistLoader_.master.playlists[e.media_.id]),e.masterPlaylistLoader_.sidxMapping_=function filterChangedSidxMappings(e,i){var n=Ba(e.playlists,i);return qr(e,(function(e,a,s,o){if(e.playlists&&e.playlists.length){var u=e.playlists;n=Oa(n,Ba(u,i))}})),n}(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.sidxMapping_),e.addSidxSegments_(e.media(),e.state,(function(i){e.refreshMedia_(e.media().id)})))}))},i.refreshMedia_=function refreshMedia_(e){var i=this;if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();var n=this.masterPlaylistLoader_.master.playlists,a=!this.media_||this.media_!==n[e];a?this.media_=n[e]:this.trigger("playlistunchanged"),this.media().endList||(this.mediaUpdateTimeout=s.a.setTimeout((function(){i.trigger("mediaupdatetimeout")}),Qr(this.media(),Boolean(a)))),this.trigger("loadedplaylist")},DashPlaylistLoader}(Da),Ua={"GOAL_BUFFER_LENGTH":30,"MAX_GOAL_BUFFER_LENGTH":60,"BACK_BUFFER_LENGTH":30,"GOAL_BUFFER_LENGTH_RATE":1,"INITIAL_BANDWIDTH":4194304,"BANDWIDTH_VARIANCE":1.2,"BUFFER_LOW_WATER_LINE":0,"MAX_BUFFER_LOW_WATER_LINE":30,"EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE":16,"BUFFER_LOW_WATER_LINE_RATE":1,"BUFFER_HIGH_WATER_LINE":30},ja=function stringToArrayBuffer(e){for(var i=new Uint8Array(new ArrayBuffer(e.length)),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i.buffer},Fa=[],Va=function processTransmux(e){var i=e.transmuxer,n=e.bytes,a=e.audioAppendStart,s=e.gopsToAlignWith,o=e.isPartial,u=e.remux,l=e.onData,c=e.onTrackInfo,h=e.onAudioTimingInfo,f=e.onVideoTimingInfo,m=e.onVideoSegmentTimingInfo,g=e.onAudioSegmentTimingInfo,v=e.onId3,y=e.onCaptions,_=e.onDone,T={"isPartial":o,"buffer":[]};if(i.onmessage=function handleMessage(e){Ur&&("data"===e.data.action&&function handleData_(e,i,n){var a=e.data.segment,s=a.type,o=a.initSegment,u=a.captions,l=a.captionStreams,c=a.metadata,h=a.videoFrameDtsTime,f=a.videoFramePtsTime;i.buffer.push({"captions":u,"captionStreams":l,"metadata":c});var m=e.data.segment.boxes||{"data":e.data.segment.data},g={"type":s,"data":new Uint8Array(m.data,m.data.byteOffset,m.data.byteLength),"initSegment":new Uint8Array(o.data,o.byteOffset,o.byteLength)};void 0!==h&&(g.videoFrameDtsTime=h),void 0!==f&&(g.videoFramePtsTime=f),n(g)}(e,T,l),"trackinfo"===e.data.action&&c(e.data.trackInfo),"gopInfo"===e.data.action&&function handleGopInfo_(e,i){i.gopInfo=e.data.gopInfo}(e,T),"audioTimingInfo"===e.data.action&&h(e.data.audioTimingInfo),"videoTimingInfo"===e.data.action&&f(e.data.videoTimingInfo),"videoSegmentTimingInfo"===e.data.action&&m(e.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===e.data.action&&g(e.data.audioSegmentTimingInfo),"id3Frame"===e.data.action&&v([e.data.id3Frame],e.data.id3Frame.dispatchType),"caption"===e.data.action&&y(e.data.caption),"transmuxed"===e.data.type&&(i.onmessage=null,function handleDone_(e){var i=e.transmuxedData,n=e.callback;i.buffer=[],n(i)}({"transmuxedData":T,"callback":_}),Ha()))},a&&i.postMessage({"action":"setAudioAppendStart","appendStart":a}),Array.isArray(s)&&i.postMessage({"action":"alignGopsWith","gopsToAlignWith":s}),void 0!==u&&i.postMessage({"action":"setRemux","remux":u}),n.byteLength){var b=n instanceof ArrayBuffer?n:n.buffer,S=n instanceof ArrayBuffer?0:n.byteOffset;i.postMessage({"action":"push","data":b,"byteOffset":S,"byteLength":n.byteLength},[b])}i.postMessage({"action":o?"partialFlush":"flush"})},Ha=function dequeue(){Ur=null,Fa.length&&("function"==typeof(Ur=Fa.shift())?Ur():Va(Ur))},Wa=function processAction(e,i){e.postMessage({"action":i}),Ha()},qa=function enqueueAction(e,i){if(!Ur)return Ur=e,void Wa(i,e);Fa.push(Wa.bind(null,i,e))},$a=function transmux(e){if(!Ur)return Ur=e,void Va(e);Fa.push(e)},za=function reset(e){qa("reset",e)},Ga=function dispose(){Ur=null,Fa.length=0},Xa=function endTimeline(e){qa("endTimeline",e)},Ka=2,Ya=-101,Qa=-102,Ja=function abortAll(e){e.forEach((function(e){e.abort()}))},Za=function handleErrors(e,i){return i.timedout?{"status":i.status,"message":"HLS request timed-out at URL: "+i.uri,"code":Ya,"xhr":i}:i.aborted?{"status":i.status,"message":"HLS request aborted at URL: "+i.uri,"code":Qa,"xhr":i}:e?{"status":i.status,"message":"HLS request errored at URL: "+i.uri,"code":Ka,"xhr":i}:null},es=function transmuxAndNotify(e){var i=e.segment,n=e.bytes,a=e.isPartial,s=e.trackInfoFn,o=e.timingInfoFn,u=e.videoSegmentTimingInfoFn,l=e.audioSegmentTimingInfoFn,c=e.id3Fn,h=e.captionsFn,f=e.dataFn,m=e.doneFn,g=i.map&&i.map.tracks||{},v=Boolean(g.audio&&g.video),y=o.bind(null,i,"audio","start"),_=o.bind(null,i,"audio","end"),T=o.bind(null,i,"video","start"),b=o.bind(null,i,"video","end");if(!a&&!i.lastReachedChar){var S=function probeTsSegment(e,i){var n=Be.a.inspect(e,i*Ne.ONE_SECOND_IN_TS);if(!n)return null;var a={"hasVideo":n.video&&2===n.video.length||!1,"hasAudio":n.audio&&2===n.audio.length||!1};return a.hasVideo&&(a.videoStart=n.video[0].ptsTime),a.hasAudio&&(a.audioStart=n.audio[0].ptsTime),a}(n,i.baseStartTime);S&&(s(i,{"hasAudio":S.hasAudio,"hasVideo":S.hasVideo,"isMuxed":v}),s=null,S.hasAudio&&!v&&y(S.audioStart),S.hasVideo&&T(S.videoStart),y=null,T=null)}$a({"bytes":n,"transmuxer":i.transmuxer,"audioAppendStart":i.audioAppendStart,"gopsToAlignWith":i.gopsToAlignWith,"isPartial":a,"remux":v,"onData":function onData(e){e.type="combined"===e.type?"video":e.type,f(i,e)},"onTrackInfo":function onTrackInfo(e){s&&(v&&(e.isMuxed=!0),s(i,e))},"onAudioTimingInfo":function onAudioTimingInfo(e){y&&void 0!==e.start&&(y(e.start),y=null),_&&void 0!==e.end&&_(e.end)},"onVideoTimingInfo":function onVideoTimingInfo(e){T&&void 0!==e.start&&(T(e.start),T=null),b&&void 0!==e.end&&b(e.end)},"onVideoSegmentTimingInfo":function onVideoSegmentTimingInfo(e){u(e)},"onAudioSegmentTimingInfo":function onAudioSegmentTimingInfo(e){l(e)},"onId3":function onId3(e,n){c(i,e,n)},"onCaptions":function onCaptions(e){h(i,[e])},"onDone":function onDone(e){m&&!a&&(e.type="combined"===e.type?"video":e.type,m(null,i,e))}})},is=function handleSegmentBytes(e){var i=e.segment,n=e.bytes,a=e.isPartial,s=e.trackInfoFn,o=e.timingInfoFn,u=e.videoSegmentTimingInfoFn,l=e.audioSegmentTimingInfoFn,c=e.id3Fn,h=e.captionsFn,f=e.dataFn,m=e.doneFn,g=new Uint8Array(n);if(Object(Oe.isLikelyFmp4MediaSegment)(g)){i.isFmp4=!0;var v=i.map.tracks,y={"isFmp4":!0,"hasVideo":!!v.video,"hasAudio":!!v.audio};v.audio&&v.audio.codec&&"enca"!==v.audio.codec&&(y.audioCodec=v.audio.codec),v.video&&v.video.codec&&"encv"!==v.video.codec&&(y.videoCodec=v.video.codec),v.video&&v.audio&&(y.isMuxed=!0),s(i,y);var _=je.a.startTime(i.map.timescales,g);y.hasAudio&&!y.isMuxed&&o(i,"audio","start",_),y.hasVideo&&o(i,"video","start",_);var T=function finishLoading(e){f(i,{"data":n,"type":y.hasAudio&&!y.isMuxed?"audio":"video"}),e&&e.length&&h(i,e),m(null,i,{})};if(!v.video||!n.byteLength||!i.transmuxer)return void T();var b=n instanceof ArrayBuffer?n:n.buffer,S=n instanceof ArrayBuffer?0:n.byteOffset;return i.transmuxer.addEventListener("message",(function listenForCaptions(e){if("mp4Captions"===e.data.action){i.transmuxer.removeEventListener("message",listenForCaptions);var a=e.data.data;i.bytes=n=new Uint8Array(a,a.byteOffset||0,a.byteLength),T(e.data.captions)}})),void i.transmuxer.postMessage({"action":"pushMp4Captions","timescales":i.map.timescales,"trackIds":[v.video.id],"data":b,"byteOffset":S,"byteLength":n.byteLength},[b])}if(i.transmuxer){if(void 0===i.container&&(i.container=Object(Oe.detectContainerForBytes)(g)),"ts"!==i.container&&"aac"!==i.container)return s(i,{"hasAudio":!1,"hasVideo":!1}),void m(null,i,{});es({"segment":i,"bytes":n,"isPartial":a,"trackInfoFn":s,"timingInfoFn":o,"videoSegmentTimingInfoFn":u,"audioSegmentTimingInfoFn":l,"id3Fn":c,"captionsFn":h,"dataFn":f,"doneFn":m})}else m(null,i,{})},ns=function waitForCompletion(e){var i=e.activeXhrs,n=e.decryptionWorker,a=e.trackInfoFn,s=e.timingInfoFn,o=e.videoSegmentTimingInfoFn,u=e.audioSegmentTimingInfoFn,l=e.id3Fn,c=e.captionsFn,h=e.dataFn,f=e.doneFn,m=0,g=!1;return function(e,v){if(!g){if(e)return g=!0,Ja(i),f(e,v);if((m+=1)===i.length){if(v.endOfAllRequests=Date.now(),v.encryptedBytes)return function decryptSegment(e){var i,n=e.decryptionWorker,a=e.segment,s=e.trackInfoFn,o=e.timingInfoFn,u=e.videoSegmentTimingInfoFn,l=e.audioSegmentTimingInfoFn,c=e.id3Fn,h=e.captionsFn,f=e.dataFn,m=e.doneFn;n.addEventListener("message",(function decryptionHandler(e){if(e.data.source===a.requestId){n.removeEventListener("message",decryptionHandler);var i=e.data.decrypted;a.bytes=new Uint8Array(i.bytes,i.byteOffset,i.byteLength),is({"segment":a,"bytes":a.bytes,"isPartial":!1,"trackInfoFn":s,"timingInfoFn":o,"videoSegmentTimingInfoFn":u,"audioSegmentTimingInfoFn":l,"id3Fn":c,"captionsFn":h,"dataFn":f,"doneFn":m})}})),i=a.key.bytes.slice?a.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(a.key.bytes)),n.postMessage(ka({"source":a.requestId,"encrypted":a.encryptedBytes,"key":i,"iv":a.key.iv}),[a.encryptedBytes.buffer,i.buffer])}({"decryptionWorker":n,"segment":v,"trackInfoFn":a,"timingInfoFn":s,"videoSegmentTimingInfoFn":o,"audioSegmentTimingInfoFn":u,"id3Fn":l,"captionsFn":c,"dataFn":h,"doneFn":f});is({"segment":v,"bytes":v.bytes,"isPartial":!1,"trackInfoFn":a,"timingInfoFn":s,"videoSegmentTimingInfoFn":o,"audioSegmentTimingInfoFn":u,"id3Fn":l,"captionsFn":c,"dataFn":h,"doneFn":f})}}}},rs=function handleProgress(e){var i=e.segment,n=e.progressFn,a=e.trackInfoFn,s=e.timingInfoFn,o=e.videoSegmentTimingInfoFn,u=e.audioSegmentTimingInfoFn,l=e.id3Fn,c=e.captionsFn,h=e.dataFn,f=e.handlePartialData;return function(e){var m=e.target;if(!m.aborted){if(f&&!i.key&&m.responseText&&m.responseText.length>=8){var g=ja(m.responseText.substring(i.lastReachedChar||0));!i.lastReachedChar&&Object(Oe.isLikelyFmp4MediaSegment)(new Uint8Array(g))||(i.lastReachedChar=m.responseText.length,is({"segment":i,"bytes":g,"isPartial":!0,"trackInfoFn":a,"timingInfoFn":s,"videoSegmentTimingInfoFn":o,"audioSegmentTimingInfoFn":u,"id3Fn":l,"captionsFn":c,"dataFn":h}))}return i.stats=videojs$1.mergeOptions(i.stats,function getProgressStats(e){var i=e.target,n={"bandwidth":1/0,"bytesReceived":0,"roundTripTime":Date.now()-i.requestTime||0};return n.bytesReceived=e.loaded,n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3),n}(e)),!i.stats.firstBytesReceivedAt&&i.stats.bytesReceived&&(i.stats.firstBytesReceivedAt=Date.now()),n(e,i)}}},as=function mediaSegmentRequest(e){var i=e.xhr,n=e.xhrOptions,a=e.decryptionWorker,s=e.segment,o=e.abortFn,u=e.progressFn,l=e.trackInfoFn,c=e.timingInfoFn,h=e.videoSegmentTimingInfoFn,f=e.audioSegmentTimingInfoFn,m=e.id3Fn,g=e.captionsFn,v=e.dataFn,y=e.doneFn,_=e.handlePartialData,T=[],b=ns({"activeXhrs":T,"decryptionWorker":a,"trackInfoFn":l,"timingInfoFn":c,"videoSegmentTimingInfoFn":h,"audioSegmentTimingInfoFn":f,"id3Fn":m,"captionsFn":g,"dataFn":v,"doneFn":y});if(s.key&&!s.key.bytes){var S=i(videojs$1.mergeOptions(n,{"uri":s.key.resolvedUri,"responseType":"arraybuffer"}),function handleKeyResponse(e,i){return function(n,a){var s=a.response,o=Za(n,a);if(o)return i(o,e);if(16!==s.byteLength)return i({"status":a.status,"message":"Invalid HLS key at URL: "+a.uri,"code":Ka,"xhr":a},e);var u=new DataView(s);return e.key.bytes=new Uint32Array([u.getUint32(0),u.getUint32(4),u.getUint32(8),u.getUint32(12)]),i(null,e)}}(s,b));T.push(S)}if(s.map&&!s.map.bytes){var C=i(videojs$1.mergeOptions(n,{"uri":s.map.resolvedUri,"responseType":"arraybuffer","headers":Ta(s.map)}),function handleInitSegmentResponse(e){var i=e.segment,n=e.finishProcessingFn;return function(e,a){var s=a.response,o=Za(e,a);if(o)return n(o,i);if(0===s.byteLength)return n({"status":a.status,"message":"Empty HLS segment content at URL: "+a.uri,"code":Ka,"xhr":a},i);i.map.bytes=new Uint8Array(a.response);var u=Object(Oe.detectContainerForBytes)(i.map.bytes);return"mp4"!==u?n({"status":a.status,"message":"Found unsupported "+(u||"unknown")+" container for initialization segment at URL: "+a.uri,"code":Ka,"internal":!0,"xhr":a},i):(je.a.tracks(i.map.bytes).forEach((function(e){i.map.tracks=i.map.tracks||{},i.map.tracks[e.type]||(i.map.tracks[e.type]=e,"number"==typeof e.id&&e.timescale&&(i.map.timescales=i.map.timescales||{},i.map.timescales[e.id]=e.timescale))})),n(null,i))}}({"segment":s,"finishProcessingFn":b}));T.push(C)}var k=videojs$1.mergeOptions(n,{"uri":s.resolvedUri,"responseType":"arraybuffer","headers":Ta(s)});_&&(k.responseType="text",k.beforeSend=function(e){e.overrideMimeType("text/plain; charset=x-user-defined")});var E=i(k,function handleSegmentResponse(e){var i=e.segment,n=e.finishProcessingFn,a=e.responseType;return function(e,s){var o=s.response,u=Za(e,s);if(u)return n(u,i);var l="arraybuffer"!==a&&s.responseText?ja(s.responseText.substring(i.lastReachedChar||0)):s.response;return 0===o.byteLength?n({"status":s.status,"message":"Empty HLS segment content at URL: "+s.uri,"code":Ka,"xhr":s},i):(i.stats=function getRequestStats(e){return{"bandwidth":e.bandwidth,"bytesReceived":e.bytesReceived||0,"roundTripTime":e.roundTripTime||0}}(s),i.key?i.encryptedBytes=new Uint8Array(l):i.bytes=new Uint8Array(l),n(null,i))}}({"segment":s,"finishProcessingFn":b,"responseType":k.responseType}));E.addEventListener("progress",rs({"segment":s,"progressFn":u,"trackInfoFn":l,"timingInfoFn":c,"videoSegmentTimingInfoFn":h,"audioSegmentTimingInfoFn":f,"id3Fn":m,"captionsFn":g,"dataFn":v,"handlePartialData":_})),T.push(E);var w={};return T.forEach((function(e){e.addEventListener("loadend",function handleLoadEnd(e){var i=e.loadendState,n=e.abortFn;return function(e){e.target.aborted&&n&&!i.calledAbortFn&&(n(),i.calledAbortFn=!0)}}({"loadendState":w,"abortFn":o}))})),function(){return Ja(T)}},ss="undefined"!=typeof window?window:{},os="undefined"==typeof Symbol?"__target":Symbol(),us=ss.BlobBuilder||ss.WebKitBlobBuilder||ss.MozBlobBuilder||ss.MSBlobBuilder,ls=ss.URL||ss.webkitURL||ls&&ls.msURL,cs=ss.Worker;function shimWorker(e,i){return function ShimWorker(n){var a=this;if(!i)return new cs(e);if(cs&&!n){var s=createSourceObject(i.toString().replace(/^function.+?{/,"").slice(0,-1));return this[os]=new cs(s),function wrapTerminate(e,i){if(!e||!i)return;var n=e.terminate;e.objURL=i,e.terminate=function(){e.objURL&&ls.revokeObjectURL(e.objURL),n.call(e)}}(this[os],s),this[os]}var o={"postMessage":function postMessage(e){a.onmessage&&setTimeout((function(){a.onmessage({"data":e,"target":o})}))}};i.call(o),this.postMessage=function(e){setTimeout((function(){o.onmessage({"data":e,"target":a})}))},this.isThisThread=!0}}if(cs){var ds,hs=createSourceObject("self.onmessage = function () {}"),ps=new Uint8Array(1);try{(ds=new cs(hs)).postMessage(ps,[ps.buffer])}catch(e){cs=null}finally{ls.revokeObjectURL(hs),ds&&ds.terminate()}}function createSourceObject(e){try{return ls.createObjectURL(new Blob([e],{"type":"application/javascript"}))}catch(n){var i=new us;return i.append(e),ls.createObjectURL(i.getBlob(type))}}var fs=new shimWorker("./transmuxer-worker.worker.js",(function(e,i){var n=this;!function(){var e=function Stream(){this.init=function(){var e={};this.on=function(i,n){e[i]||(e[i]=[]),e[i]=e[i].concat(n)},this.off=function(i,n){var a;return!!e[i]&&(a=e[i].indexOf(n),e[i]=e[i].slice(),e[i].splice(a,1),a>-1)},this.trigger=function(i){var n,a,s,o;if(n=e[i])if(2===arguments.length)for(s=n.length,a=0;a<s;++a)n[a].call(this,arguments[1]);else{for(o=[],a=arguments.length,a=1;a<arguments.length;++a)o.push(arguments[a]);for(s=n.length,a=0;a<s;++a)n[a].apply(this,o)}},this.dispose=function(){e={}}}};e.prototype.pipe=function(e){return this.on("data",(function(i){e.push(i)})),this.on("done",(function(i){e.flush(i)})),this.on("partialdone",(function(i){e.partialFlush(i)})),this.on("endedtimeline",(function(i){e.endTimeline(i)})),this.on("reset",(function(i){e.reset(i)})),e},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var i,a,s,o,u,l,c,h,f,m,g,v,y,_,T,b,S,C,k,E,w,P,I,x,A,L,D,O,M,R,B,N,U,j,V,H,W,q,$,z,G=e,X=Math.pow(2,32)-1;!function(){var e;if(P={"avc1":[],"avcC":[],"btrt":[],"dinf":[],"dref":[],"esds":[],"ftyp":[],"hdlr":[],"mdat":[],"mdhd":[],"mdia":[],"mfhd":[],"minf":[],"moof":[],"moov":[],"mp4a":[],"mvex":[],"mvhd":[],"pasp":[],"sdtp":[],"smhd":[],"stbl":[],"stco":[],"stsc":[],"stsd":[],"stsz":[],"stts":[],"styp":[],"tfdt":[],"tfhd":[],"traf":[],"trak":[],"trun":[],"trex":[],"tkhd":[],"vmhd":[]},"undefined"!=typeof Uint8Array){for(e in P)P.hasOwnProperty(e)&&(P[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);I=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),A=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),x=new Uint8Array([0,0,0,1]),L=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),D=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),O={"video":L,"audio":D},B=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),R=new Uint8Array([0,0,0,0,0,0,0,0]),N=new Uint8Array([0,0,0,0,0,0,0,0]),U=N,j=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),V=N,M=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),i=function box(e){var i,n,a=[],s=0;for(i=1;i<arguments.length;i++)a.push(arguments[i]);for(i=a.length;i--;)s+=a[i].byteLength;for(n=new Uint8Array(s+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),i=0,s=8;i<a.length;i++)n.set(a[i],s),s+=a[i].byteLength;return n},a=function dinf(){return i(P.dinf,i(P.dref,B))},s=function esds(e){return i(P.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},T=function hdlr(e){return i(P.hdlr,O[e])},_=function mdhd(e){var n=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(n[12]=e.samplerate>>>24&255,n[13]=e.samplerate>>>16&255,n[14]=e.samplerate>>>8&255,n[15]=255&e.samplerate),i(P.mdhd,n)},y=function mdia(e){return i(P.mdia,_(e),T(e.type),l(e))},u=function mfhd(e){return i(P.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},l=function minf(e){return i(P.minf,"video"===e.type?i(P.vmhd,M):i(P.smhd,R),a(),S(e))},c=function moof(e,n){for(var a=[],s=n.length;s--;)a[s]=k(n[s]);return i.apply(null,[P.moof,u(e)].concat(a))},h=function moov(e){for(var n=e.length,a=[];n--;)a[n]=g(e[n]);return i.apply(null,[P.moov,m(4294967295)].concat(a).concat(f(e)))},f=function mvex(e){for(var n=e.length,a=[];n--;)a[n]=E(e[n]);return i.apply(null,[P.mvex].concat(a))},m=function mvhd(e){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return i(P.mvhd,n)},b=function sdtp(e){var n,a,s=e.samples||[],o=new Uint8Array(4+s.length);for(a=0;a<s.length;a++)n=s[a].flags,o[a+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return i(P.sdtp,o)},S=function stbl(e){return i(P.stbl,C(e),i(P.stts,V),i(P.stsc,U),i(P.stsz,j),i(P.stco,N))},C=function stsd(e){return i(P.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?H(e):W(e))},H=function videoSample(e){var n,a,s=e.sps||[],o=e.pps||[],u=[],l=[];for(n=0;n<s.length;n++)u.push((65280&s[n].byteLength)>>>8),u.push(255&s[n].byteLength),u=u.concat(Array.prototype.slice.call(s[n]));for(n=0;n<o.length;n++)l.push((65280&o[n].byteLength)>>>8),l.push(255&o[n].byteLength),l=l.concat(Array.prototype.slice.call(o[n]));if(a=[P.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),i(P.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([s.length],u,[o.length],l))),i(P.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var c=e.sarRatio[0],h=e.sarRatio[1];a.push(i(P.pasp,new Uint8Array([(4278190080&c)>>24,(16711680&c)>>16,(65280&c)>>8,255&c,(4278190080&h)>>24,(16711680&h)>>16,(65280&h)>>8,255&h])))}return i.apply(null,a)},W=function audioSample(e){return i(P.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),s(e))},v=function tkhd(e){var n=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return i(P.tkhd,n)},k=function traf(e){var n,a,s,o,u,l;return n=i(P.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),u=Math.floor(e.baseMediaDecodeTime/(X+1)),l=Math.floor(e.baseMediaDecodeTime%(X+1)),a=i(P.tfdt,new Uint8Array([1,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,255&u,l>>>24&255,l>>>16&255,l>>>8&255,255&l])),92,"audio"===e.type?(s=w(e,92),i(P.traf,n,a,s)):(o=b(e),s=w(e,o.length+92),i(P.traf,n,a,s,o))},g=function trak(e){return e.duration=e.duration||4294967295,i(P.trak,v(e),y(e))},E=function trex(e){var n=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(n[n.length-1]=0),i(P.trex,n)},z=function trunHeader(e,i){var n=0,a=0,s=0,o=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(a=2),void 0!==e[0].flags&&(s=4),void 0!==e[0].compositionTimeOffset&&(o=8)),[0,0,n|a|s|o,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&i)>>>24,(16711680&i)>>>16,(65280&i)>>>8,255&i]},$=function videoTrun(e,n){var a,s,o,u,l,c;for(n+=20+16*(u=e.samples||[]).length,o=z(u,n),(s=new Uint8Array(o.length+16*u.length)).set(o),a=o.length,c=0;c<u.length;c++)l=u[c],s[a++]=(4278190080&l.duration)>>>24,s[a++]=(16711680&l.duration)>>>16,s[a++]=(65280&l.duration)>>>8,s[a++]=255&l.duration,s[a++]=(4278190080&l.size)>>>24,s[a++]=(16711680&l.size)>>>16,s[a++]=(65280&l.size)>>>8,s[a++]=255&l.size,s[a++]=l.flags.isLeading<<2|l.flags.dependsOn,s[a++]=l.flags.isDependedOn<<6|l.flags.hasRedundancy<<4|l.flags.paddingValue<<1|l.flags.isNonSyncSample,s[a++]=61440&l.flags.degradationPriority,s[a++]=15&l.flags.degradationPriority,s[a++]=(4278190080&l.compositionTimeOffset)>>>24,s[a++]=(16711680&l.compositionTimeOffset)>>>16,s[a++]=(65280&l.compositionTimeOffset)>>>8,s[a++]=255&l.compositionTimeOffset;return i(P.trun,s)},q=function audioTrun(e,n){var a,s,o,u,l,c;for(n+=20+8*(u=e.samples||[]).length,o=z(u,n),(a=new Uint8Array(o.length+8*u.length)).set(o),s=o.length,c=0;c<u.length;c++)l=u[c],a[s++]=(4278190080&l.duration)>>>24,a[s++]=(16711680&l.duration)>>>16,a[s++]=(65280&l.duration)>>>8,a[s++]=255&l.duration,a[s++]=(4278190080&l.size)>>>24,a[s++]=(16711680&l.size)>>>16,a[s++]=(65280&l.size)>>>8,a[s++]=255&l.size;return i(P.trun,a)},w=function trun(e,i){return"audio"===e.type?q(e,i):$(e,i)};o=function ftyp(){return i(P.ftyp,I,x,I,A)};var K,Y,Q,J,Z,ee,te,ie,ne=function mdat(e){return i(P.mdat,e)},re=c,ae=function initSegment(e){var i,n=o(),a=h(e);return(i=new Uint8Array(n.byteLength+a.byteLength)).set(n),i.set(a,n.byteLength),i},se=function sampleForFrame(e,i){var n={"size":0,"flags":{"isLeading":0,"dependsOn":1,"isDependedOn":0,"hasRedundancy":0,"degradationPriority":0,"isNonSyncSample":1}};return n.dataOffset=i,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},oe=function groupNalsIntoFrames(e){var i,n,a=[],s=[];for(s.byteLength=0,s.nalCount=0,s.duration=0,a.byteLength=0,i=0;i<e.length;i++)"access_unit_delimiter_rbsp"===(n=e[i]).nalUnitType?(a.length&&(a.duration=n.dts-a.dts,s.byteLength+=a.byteLength,s.nalCount+=a.length,s.duration+=a.duration,s.push(a)),(a=[n]).byteLength=n.data.byteLength,a.pts=n.pts,a.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(a.keyFrame=!0),a.duration=n.dts-a.dts,a.byteLength+=n.data.byteLength,a.push(n));return s.length&&(!a.duration||a.duration<=0)&&(a.duration=s[s.length-1].duration),s.byteLength+=a.byteLength,s.nalCount+=a.length,s.duration+=a.duration,s.push(a),s},ue=function groupFramesIntoGops(e){var i,n,a=[],s=[];for(a.byteLength=0,a.nalCount=0,a.duration=0,a.pts=e[0].pts,a.dts=e[0].dts,s.byteLength=0,s.nalCount=0,s.duration=0,s.pts=e[0].pts,s.dts=e[0].dts,i=0;i<e.length;i++)(n=e[i]).keyFrame?(a.length&&(s.push(a),s.byteLength+=a.byteLength,s.nalCount+=a.nalCount,s.duration+=a.duration),(a=[n]).nalCount=n.length,a.byteLength=n.byteLength,a.pts=n.pts,a.dts=n.dts,a.duration=n.duration):(a.duration+=n.duration,a.nalCount+=n.length,a.byteLength+=n.byteLength,a.push(n));return s.length&&a.duration<=0&&(a.duration=s[s.length-1].duration),s.byteLength+=a.byteLength,s.nalCount+=a.nalCount,s.duration+=a.duration,s.push(a),s},le=function extendFirstKeyFrame(e){var i;return!e[0][0].keyFrame&&e.length>1&&(i=e.shift(),e.byteLength-=i.byteLength,e.nalCount-=i.nalCount,e[0][0].dts=i.dts,e[0][0].pts=i.pts,e[0][0].duration+=i.duration),e},ce=function generateSampleTable(e,i){var n,a,s,o,u,l=i||0,c=[];for(n=0;n<e.length;n++)for(o=e[n],a=0;a<o.length;a++)u=o[a],l+=(s=se(u,l)).size,c.push(s);return c},de=function concatenateNalData(e){var i,n,a,s,o,u,l=0,c=e.byteLength,h=e.nalCount,f=new Uint8Array(c+4*h),m=new DataView(f.buffer);for(i=0;i<e.length;i++)for(s=e[i],n=0;n<s.length;n++)for(o=s[n],a=0;a<o.length;a++)u=o[a],m.setUint32(l,u.data.byteLength),l+=4,f.set(u.data,l),l+=u.data.byteLength;return f},he=function generateSampleTableForFrame(e,i){var n,a=[];return n=se(e,i||0),a.push(n),a},pe=function concatenateNalDataForFrame(e){var i,n,a=0,s=e.byteLength,o=e.length,u=new Uint8Array(s+4*o),l=new DataView(u.buffer);for(i=0;i<e.length;i++)n=e[i],l.setUint32(a,n.data.byteLength),a+=4,u.set(n.data,a),a+=n.data.byteLength;return u},fe=[33,16,5,32,164,27],me=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ge=function zeroFill(e){for(var i=[];e--;)i.push(0);return i},ve=function silence_1(){if(!K){var e={"96000":[fe,[227,64],ge(154),[56]],"88200":[fe,[231],ge(170),[56]],"64000":[fe,[248,192],ge(240),[56]],"48000":[fe,[255,192],ge(268),[55,148,128],ge(54),[112]],"44100":[fe,[255,192],ge(268),[55,163,128],ge(84),[112]],"32000":[fe,[255,192],ge(268),[55,234],ge(226),[112]],"24000":[fe,[255,192],ge(268),[55,255,128],ge(268),[111,112],ge(126),[224]],"16000":[fe,[255,192],ge(268),[55,255,128],ge(268),[111,255],ge(269),[223,108],ge(195),[1,192]],"12000":[me,ge(268),[3,127,248],ge(268),[6,255,240],ge(268),[13,255,224],ge(268),[27,253,128],ge(259),[56]],"11025":[me,ge(268),[3,127,248],ge(268),[6,255,240],ge(268),[13,255,224],ge(268),[27,255,192],ge(268),[55,175,128],ge(108),[112]],"8000":[me,ge(268),[3,121,16],ge(47),[7]]};K=function makeTable(e){return Object.keys(e).reduce((function(i,n){return i[n]=new Uint8Array(e[n].reduce((function(e,i){return e.concat(i)}),[])),i}),{})}(e)}return K};ee=function audioTsToVideoTs(e,i){return Y(Z(e,i))},te=function videoTsToAudioTs(e,i){return Q(J(e),i)},ie=function metadataTsToSeconds(e,i,n){return J(n?e:e-i)};var ye=9e4,_e=Y=function secondsToVideoTs(e){return 9e4*e},Te=(Q=function secondsToAudioTs(e,i){return e*i},J=function videoTsToSeconds(e){return e/9e4}),be=(Z=function audioTsToSeconds(e,i){return e/i},ee),Se=te,Ce=ie,ke=function prefixWithSilence(e,i,n,a){var s,o,u,l,c,h=0,f=0,m=0;if(i.length&&(s=be(e.baseMediaDecodeTime,e.samplerate),o=Math.ceil(ye/(e.samplerate/1024)),n&&a&&(h=s-Math.max(n,a),m=(f=Math.floor(h/o))*o),!(f<1||m>ye/2))){for((u=ve()[e.samplerate])||(u=i[0].data),l=0;l<f;l++)c=i[0],i.splice(0,0,{"data":u,"dts":c.dts-o,"pts":c.pts-o});return e.baseMediaDecodeTime-=Math.floor(Se(m,e.samplerate)),m}},Ee=function trimAdtsFramesByEarliestDts(e,i,n){return i.minSegmentDts>=n?e:(i.minSegmentDts=1/0,e.filter((function(e){return e.dts>=n&&(i.minSegmentDts=Math.min(i.minSegmentDts,e.dts),i.minSegmentPts=i.minSegmentDts,!0)})))},we=function generateSampleTable(e){var i,n,a=[];for(i=0;i<e.length;i++)n=e[i],a.push({"size":n.data.byteLength,"duration":1024});return a},Pe=function concatenateFrameData(e){var i,n,a=0,s=new Uint8Array(function sumFrameByteLengths(e){var i,n=0;for(i=0;i<e.length;i++)n+=e[i].data.byteLength;return n}(e));for(i=0;i<e.length;i++)n=e[i],s.set(n.data,a),a+=n.data.byteLength;return s},Ie=ye,xe=function clearDtsInfo(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},Ae=function calculateTrackBaseMediaDecodeTime(e,i){var n,a=e.minSegmentDts;return i||(a-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=a,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/Ie,n=Math.floor(n)),n},Le=function collectDtsInfo(e,i){"number"==typeof i.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=i.pts),void 0===e.minSegmentPts?e.minSegmentPts=i.pts:e.minSegmentPts=Math.min(e.minSegmentPts,i.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=i.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,i.pts)),"number"==typeof i.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=i.dts),void 0===e.minSegmentDts?e.minSegmentDts=i.dts:e.minSegmentDts=Math.min(e.minSegmentDts,i.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=i.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,i.dts))},De=function parseSei(e){for(var i=0,n={"payloadType":-1,"payloadSize":0},a=0,s=0;i<e.byteLength&&128!==e[i];){for(;255===e[i];)a+=255,i++;for(a+=e[i++];255===e[i];)s+=255,i++;if(s+=e[i++],!n.payload&&4===a){if("GA94"===String.fromCharCode(e[i+3],e[i+4],e[i+5],e[i+6])){n.payloadType=a,n.payloadSize=s,n.payload=e.subarray(i,i+s);break}n.payload=void 0}i+=s,a=0,s=0}return n},Oe=function parseUserData(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Me=function parseCaptionPackets(e,i){var n,a,s,o,u=[];if(!(64&i[0]))return u;for(a=31&i[0],n=0;n<a;n++)o={"type":3&i[(s=3*n)+2],"pts":e},4&i[s+2]&&(o.ccData=i[s+3]<<8|i[s+4],u.push(o));return u},Re=function discardEmulationPreventionBytes(e){for(var i,n,a=e.byteLength,s=[],o=1;o<a-2;)0===e[o]&&0===e[o+1]&&3===e[o+2]?(s.push(o+2),o+=2):o++;if(0===s.length)return e;i=a-s.length,n=new Uint8Array(i);var u=0;for(o=0;o<i;u++,o++)u===s[0]&&(u++,s.shift()),n[o]=e[u];return n},Be=4,Ne=function CaptionStream(){CaptionStream.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Ge(0,0),new Ge(0,1),new Ge(1,0),new Ge(1,1)],this.cc708Stream_=new He,this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this),this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done"))};(Ne.prototype=new G).push=function(e){var i,n,a;if("sei_rbsp"===e.nalUnitType&&(i=De(e.escapedRBSP)).payload&&i.payloadType===Be&&(n=Oe(i)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));a=Me(e.pts,n),this.captionPackets_=this.captionPackets_.concat(a),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},Ne.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(i){return"flush"===e?i.flush():i.partialFlush()}),this)},Ne.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,i){e.presortIndex=i})),this.captionPackets_.sort((function(e,i){return e.pts===i.pts?e.presortIndex-i.presortIndex:e.pts-i.pts})),this.captionPackets_.forEach((function(e){e.type<2?this.dispatchCea608Packet(e):this.dispatchCea708Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},Ne.prototype.flush=function(){return this.flushStream("flush")},Ne.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Ne.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},Ne.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},Ne.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},Ne.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},Ne.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)},Ne.prototype.dispatchCea708Packet=function(e){this.cc708Stream_.push(e)};var Ue={"127":9834,"4128":32,"4129":160,"4133":8230,"4138":352,"4140":338,"4144":9608,"4145":8216,"4146":8217,"4147":8220,"4148":8221,"4149":8226,"4153":8482,"4154":353,"4156":339,"4157":8480,"4159":376,"4214":8539,"4215":8540,"4216":8541,"4217":8542,"4218":9168,"4219":9124,"4220":9123,"4221":9135,"4222":9126,"4223":9121,"4256":12600},je=function within708TextBlock(e){return 32<=e&&e<=127||160<=e&&e<=255},Fe=function Cea708Window(e){this.windowNum=e,this.reset()};Fe.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Fe.prototype.getText=function(){return this.rows.join("\n")},Fe.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Fe.prototype.newLine=function(e){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(e),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Fe.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},Fe.prototype.addText=function(e){this.rows[this.rowIdx]+=e},Fe.prototype.backspace=function(){if(!this.isEmpty()){var e=this.rows[this.rowIdx];this.rows[this.rowIdx]=e.substr(0,e.length-1)}};var Ve=function Cea708Service(e){this.serviceNum=e,this.text="",this.currentWindow=new Fe(-1),this.windows=[]};Ve.prototype.init=function(e,i){this.startPts=e;for(var n=0;n<8;n++)this.windows[n]=new Fe(n),"function"==typeof i&&(this.windows[n].beforeRowOverflow=i)},Ve.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]};var He=function Cea708Stream(){Cea708Stream.prototype.init.call(this);var e=this;this.current708Packet=null,this.services={},this.push=function(i){3===i.type?(e.new708Packet(),e.add708Bytes(i)):(null===e.current708Packet&&e.new708Packet(),e.add708Bytes(i))}};He.prototype=new G,He.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={"data":[],"ptsVals":[]}},He.prototype.add708Bytes=function(e){var i=e.ccData,n=i>>>8,a=255&i;this.current708Packet.ptsVals.push(e.pts),this.current708Packet.data.push(n),this.current708Packet.data.push(a)},He.prototype.push708Packet=function(){var e=this.current708Packet,i=e.data,n=null,a=null,s=0,o=i[s++];for(e.seq=o>>6,e.sizeCode=63&o;s<i.length;s++)a=31&(o=i[s++]),7===(n=o>>5)&&a>0&&(n=o=i[s++]),this.pushServiceBlock(n,s,a),a>0&&(s+=a-1)},He.prototype.pushServiceBlock=function(e,i,n){var a,s=i,o=this.current708Packet.data,u=this.services[e];for(u||(u=this.initService(e,s));s<i+n&&s<o.length;s++)a=o[s],je(a)?s=this.handleText(s,u):16===a?s=this.extendedCommands(s,u):128<=a&&a<=135?s=this.setCurrentWindow(s,u):152<=a&&a<=159?s=this.defineWindow(s,u):136===a?s=this.clearWindows(s,u):140===a?s=this.deleteWindows(s,u):137===a?s=this.displayWindows(s,u):138===a?s=this.hideWindows(s,u):139===a?s=this.toggleWindows(s,u):151===a?s=this.setWindowAttributes(s,u):144===a?s=this.setPenAttributes(s,u):145===a?s=this.setPenColor(s,u):146===a?s=this.setPenLocation(s,u):143===a?u=this.reset(s,u):8===a?u.currentWindow.backspace():12===a?u.currentWindow.clearText():13===a?u.currentWindow.pendingNewLine=!0:14===a?u.currentWindow.clearText():141===a&&s++},He.prototype.extendedCommands=function(e,i){var n=this.current708Packet.data[++e];return je(n)&&(e=this.handleText(e,i,!0)),e},He.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]},He.prototype.initService=function(e,i){var n=this;return this.services[e]=new Ve(e),this.services[e].init(this.getPts(i),(function(i){n.flushDisplayed(i,n.services[e])})),this.services[e]},He.prototype.handleText=function(e,i,n){var a=function get708CharFromCode(e){var i=Ue[e]||e;return 4096&e&&e===i?"":String.fromCharCode(i)}((n?4096:0)|this.current708Packet.data[e]),s=i.currentWindow;return s.pendingNewLine&&!s.isEmpty()&&s.newLine(this.getPts(e)),s.pendingNewLine=!1,s.addText(a),e},He.prototype.setCurrentWindow=function(e,i){var n=7&this.current708Packet.data[e];return i.setCurrentWindow(n),e},He.prototype.defineWindow=function(e,i){var n=this.current708Packet.data,a=n[e],s=7&a;i.setCurrentWindow(s);var o=i.currentWindow;return a=n[++e],o.visible=(32&a)>>5,o.rowLock=(16&a)>>4,o.columnLock=(8&a)>>3,o.priority=7&a,a=n[++e],o.relativePositioning=(128&a)>>7,o.anchorVertical=127&a,a=n[++e],o.anchorHorizontal=a,a=n[++e],o.anchorPoint=(240&a)>>4,o.rowCount=15&a,a=n[++e],o.columnCount=63&a,a=n[++e],o.windowStyle=(56&a)>>3,o.penStyle=7&a,o.virtualRowCount=o.rowCount+1,e},He.prototype.setWindowAttributes=function(e,i){var n=this.current708Packet.data,a=n[e],s=i.currentWindow.winAttr;return a=n[++e],s.fillOpacity=(192&a)>>6,s.fillRed=(48&a)>>4,s.fillGreen=(12&a)>>2,s.fillBlue=3&a,a=n[++e],s.borderType=(192&a)>>6,s.borderRed=(48&a)>>4,s.borderGreen=(12&a)>>2,s.borderBlue=3&a,a=n[++e],s.borderType+=(128&a)>>5,s.wordWrap=(64&a)>>6,s.printDirection=(48&a)>>4,s.scrollDirection=(12&a)>>2,s.justify=3&a,a=n[++e],s.effectSpeed=(240&a)>>4,s.effectDirection=(12&a)>>2,s.displayEffect=3&a,e},He.prototype.flushDisplayed=function(e,i){for(var n=[],a=0;a<8;a++)i.windows[a].visible&&!i.windows[a].isEmpty()&&n.push(i.windows[a].getText());i.endPts=e,i.text=n.join("\n\n"),this.pushCaption(i),i.startPts=e},He.prototype.pushCaption=function(e){""!==e.text&&(this.trigger("data",{"startPts":e.startPts,"endPts":e.endPts,"text":e.text,"stream":"cc708_"+e.serviceNum}),e.text="",e.startPts=e.endPts)},He.prototype.displayWindows=function(e,i){var n=this.current708Packet.data[++e],a=this.getPts(e);this.flushDisplayed(a,i);for(var s=0;s<8;s++)n&1<<s&&(i.windows[s].visible=1);return e},He.prototype.hideWindows=function(e,i){var n=this.current708Packet.data[++e],a=this.getPts(e);this.flushDisplayed(a,i);for(var s=0;s<8;s++)n&1<<s&&(i.windows[s].visible=0);return e},He.prototype.toggleWindows=function(e,i){var n=this.current708Packet.data[++e],a=this.getPts(e);this.flushDisplayed(a,i);for(var s=0;s<8;s++)n&1<<s&&(i.windows[s].visible^=1);return e},He.prototype.clearWindows=function(e,i){var n=this.current708Packet.data[++e],a=this.getPts(e);this.flushDisplayed(a,i);for(var s=0;s<8;s++)n&1<<s&&i.windows[s].clearText();return e},He.prototype.deleteWindows=function(e,i){var n=this.current708Packet.data[++e],a=this.getPts(e);this.flushDisplayed(a,i);for(var s=0;s<8;s++)n&1<<s&&i.windows[s].reset();return e},He.prototype.setPenAttributes=function(e,i){var n=this.current708Packet.data,a=n[e],s=i.currentWindow.penAttr;return a=n[++e],s.textTag=(240&a)>>4,s.offset=(12&a)>>2,s.penSize=3&a,a=n[++e],s.italics=(128&a)>>7,s.underline=(64&a)>>6,s.edgeType=(56&a)>>3,s.fontStyle=7&a,e},He.prototype.setPenColor=function(e,i){var n=this.current708Packet.data,a=n[e],s=i.currentWindow.penColor;return a=n[++e],s.fgOpacity=(192&a)>>6,s.fgRed=(48&a)>>4,s.fgGreen=(12&a)>>2,s.fgBlue=3&a,a=n[++e],s.bgOpacity=(192&a)>>6,s.bgRed=(48&a)>>4,s.bgGreen=(12&a)>>2,s.bgBlue=3&a,a=n[++e],s.edgeRed=(48&a)>>4,s.edgeGreen=(12&a)>>2,s.edgeBlue=3&a,e},He.prototype.setPenLocation=function(e,i){var n=this.current708Packet.data,a=n[e],s=i.currentWindow.penLoc;return i.currentWindow.pendingNewLine=!0,a=n[++e],s.row=15&a,a=n[++e],s.column=63&a,e},He.prototype.reset=function(e,i){var n=this.getPts(e);return this.flushDisplayed(n,i),this.initService(i.serviceNum,e)};var We={"42":225,"92":233,"94":237,"95":243,"96":250,"123":231,"124":247,"125":209,"126":241,"127":9608,"304":174,"305":176,"306":189,"307":191,"308":8482,"309":162,"310":163,"311":9834,"312":224,"313":160,"314":232,"315":226,"316":234,"317":238,"318":244,"319":251,"544":193,"545":201,"546":211,"547":218,"548":220,"549":252,"550":8216,"551":161,"552":42,"553":39,"554":8212,"555":169,"556":8480,"557":8226,"558":8220,"559":8221,"560":192,"561":194,"562":199,"563":200,"564":202,"565":203,"566":235,"567":206,"568":207,"569":239,"570":212,"571":217,"572":249,"573":219,"574":171,"575":187,"800":195,"801":227,"802":205,"803":204,"804":236,"805":210,"806":242,"807":213,"808":245,"809":123,"810":125,"811":92,"812":94,"813":95,"814":124,"815":126,"816":196,"817":228,"818":214,"819":246,"820":223,"821":165,"822":164,"823":9474,"824":197,"825":229,"826":216,"827":248,"828":9484,"829":9488,"830":9492,"831":9496},qe=function getCharFromCode(e){return null===e?"":(e=We[e]||e,String.fromCharCode(e))},$e=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],ze=function createDisplayBuffer(){for(var e=[],i=15;i--;)e.push("");return e},Ge=function Cea608Stream(e,i){Cea608Stream.prototype.init.call(this),this.field_=e||0,this.dataChannel_=i||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var i,n,a,s,o;if((i=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&i)?this.lastControlCode_=i:i!==this.PADDING_&&(this.lastControlCode_=null),a=i>>>8,s=255&i,i!==this.PADDING_)if(i===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(i===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(i===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(i===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(i===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(i===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(i===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(i===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=ze();else if(i===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=ze();else if(i===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=ze()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(a,s))o=qe((a=(3&a)<<8)|s),this[this.mode_](e.pts,o),this.column_++;else if(this.isExtCharacter(a,s))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),o=qe((a=(3&a)<<8)|s),this[this.mode_](e.pts,o),this.column_++;else if(this.isMidRowCode(a,s))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&s)&&this.addFormatting(e.pts,["i"]),1==(1&s)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(a,s))this.column_+=3&s;else if(this.isPAC(a,s)){var u=$e.indexOf(7968&i);"rollUp"===this.mode_&&(u-this.rollUpRows_+1<0&&(u=this.rollUpRows_-1),this.setRollUp(e.pts,u)),u!==this.row_&&(this.clearFormatting(e.pts),this.row_=u),1&s&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&i)&&(this.column_=4*((14&i)>>1)),this.isColorPAC(s)&&14==(14&s)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(a)&&(0===s&&(s=null),o=qe(a),o+=qe(s),this[this.mode_](e.pts,o),this.column_+=o.length)}else this.lastControlCode_=null}};Ge.prototype=new G,Ge.prototype.flushDisplayed=function(e){var i=this.displayed_.map((function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");i.length&&this.trigger("data",{"startPts":this.startPts_,"endPts":e,"text":i,"stream":this.name_})},Ge.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=ze(),this.nonDisplayed_=ze(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Ge.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Ge.prototype.isSpecialCharacter=function(e,i){return e===this.EXT_&&i>=48&&i<=63},Ge.prototype.isExtCharacter=function(e,i){return(e===this.EXT_+1||e===this.EXT_+2)&&i>=32&&i<=63},Ge.prototype.isMidRowCode=function(e,i){return e===this.EXT_&&i>=32&&i<=47},Ge.prototype.isOffsetControlCode=function(e,i){return e===this.OFFSET_&&i>=33&&i<=35},Ge.prototype.isPAC=function(e,i){return e>=this.BASE_&&e<this.BASE_+8&&i>=64&&i<=127},Ge.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Ge.prototype.isNormalChar=function(e){return e>=32&&e<=127},Ge.prototype.setRollUp=function(e,i){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=ze(),this.displayed_=ze()),void 0!==i&&i!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[i-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===i&&(i=this.row_),this.topRow_=i-this.rollUpRows_+1},Ge.prototype.addFormatting=function(e,i){this.formatting_=this.formatting_.concat(i);var n=i.reduce((function(e,i){return e+"<"+i+">"}),"");this[this.mode_](e,n)},Ge.prototype.clearFormatting=function(e){if(this.formatting_.length){var i=this.formatting_.reverse().reduce((function(e,i){return e+"</"+i+">"}),"");this.formatting_=[],this[this.mode_](e,i)}},Ge.prototype.popOn=function(e,i){var n=this.nonDisplayed_[this.row_];n+=i,this.nonDisplayed_[this.row_]=n},Ge.prototype.rollUp=function(e,i){var n=this.displayed_[this.row_];n+=i,this.displayed_[this.row_]=n},Ge.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Ge.prototype.paintOn=function(e,i){var n=this.displayed_[this.row_];n+=i,this.displayed_[this.row_]=n};var Xe={"CaptionStream":Ne,"Cea608Stream":Ge,"Cea708Stream":He},Ke={"H264_STREAM_TYPE":27,"ADTS_STREAM_TYPE":15,"METADATA_STREAM_TYPE":21},Ye=function handleRollover(e,i){var n=1;for(e>i&&(n=-1);Math.abs(i-e)>4294967296;)e+=8589934592*n;return e},Qe=function TimestampRolloverStream(e){var i,n;TimestampRolloverStream.prototype.init.call(this),this.type_=e||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===n&&(n=e.dts),e.dts=Ye(e.dts,n),e.pts=Ye(e.pts,n),i=e.dts,this.trigger("data",e))},this.flush=function(){n=i,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){n=void 0,i=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Qe.prototype=new G;var Je,Ze=Qe,et=function percentEncode(e,i,n){var a,s="";for(a=i;a<n;a++)s+="%"+("00"+e[a].toString(16)).slice(-2);return s},tt=function parseUtf8(e,i,n){return decodeURIComponent(et(e,i,n))},it=function parseIso88591(e,i,n){return unescape(et(e,i,n))},nt=function parseSyncSafeInteger(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},rt={"TXXX":function TXXX(e){var i;if(3===e.data[0]){for(i=1;i<e.data.length;i++)if(0===e.data[i]){e.description=tt(e.data,1,i),e.value=tt(e.data,i+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},"WXXX":function WXXX(e){var i;if(3===e.data[0])for(i=1;i<e.data.length;i++)if(0===e.data[i]){e.description=tt(e.data,1,i),e.url=tt(e.data,i+1,e.data.length);break}},"PRIV":function PRIV(e){var i;for(i=0;i<e.data.length;i++)if(0===e.data[i]){e.owner=it(e.data,0,i);break}e.privateData=e.data.subarray(i+1),e.data=e.privateData}};(Je=function MetadataStream(e){var i,n={"debug":!(!e||!e.debug),"descriptor":e&&e.descriptor},a=0,s=[],o=0;if(Je.prototype.init.call(this),this.dispatchType=Ke.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(i=0;i<n.descriptor.length;i++)this.dispatchType+=("00"+n.descriptor[i].toString(16)).slice(-2);this.push=function(e){var i,u,l,c,h;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(o=0,s.length=0),0===s.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(s.push(e),o+=e.data.byteLength,1===s.length&&(a=nt(e.data.subarray(6,10)),a+=10),!(o<a)){for(i={"data":new Uint8Array(a),"frames":[],"pts":s[0].pts,"dts":s[0].dts},h=0;h<a;)i.data.set(s[0].data.subarray(0,a-h),h),h+=s[0].data.byteLength,o-=s[0].data.byteLength,s.shift();u=10,64&i.data[5]&&(u+=4,u+=nt(i.data.subarray(10,14)),a-=nt(i.data.subarray(16,20)));do{if((l=nt(i.data.subarray(u+4,u+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((c={"id":String.fromCharCode(i.data[u],i.data[u+1],i.data[u+2],i.data[u+3]),"data":i.data.subarray(u+10,u+l+10)}).key=c.id,rt[c.id]&&(rt[c.id](c),"com.apple.streaming.transportStreamTimestamp"===c.owner)){var f=c.data,m=(1&f[3])<<30|f[4]<<22|f[5]<<14|f[6]<<6|f[7]>>>2;m*=4,m+=3&f[7],c.timeStamp=m,void 0===i.pts&&void 0===i.dts&&(i.pts=c.timeStamp,i.dts=c.timeStamp),this.trigger("timestamp",c)}i.frames.push(c),u+=10,u+=l}while(u<a);this.trigger("data",i)}}}).prototype=new G;var at,st,ot,ut=Je,lt=Ze;(at=function TransportPacketStream(){var e=new Uint8Array(188),i=0;at.prototype.init.call(this),this.push=function(n){var a,s=0,o=188;for(i?((a=new Uint8Array(n.byteLength+i)).set(e.subarray(0,i)),a.set(n,i),i=0):a=n;o<a.byteLength;)71!==a[s]||71!==a[o]?(s++,o++):(this.trigger("data",a.subarray(s,o)),s+=188,o+=188);s<a.byteLength&&(e.set(a.subarray(s),0),i=a.byteLength-s)},this.flush=function(){188===i&&71===e[0]&&(this.trigger("data",e),i=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){i=0,this.trigger("reset")}}).prototype=new G,(st=function TransportParseStream(){var e,i,n,a;st.prototype.init.call(this),a=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function parsePsi(e,a){var s=0;a.payloadUnitStartIndicator&&(s+=e[s]+1),"pat"===a.type?i(e.subarray(s),a):n(e.subarray(s),a)},i=function parsePat(e,i){i.section_number=e[7],i.last_section_number=e[8],a.pmtPid=(31&e[10])<<8|e[11],i.pmtPid=a.pmtPid},n=function parsePmt(e,i){var n,s;if(1&e[5]){for(a.programMapTable={"video":null,"audio":null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,s=12+((15&e[10])<<8|e[11]);s<n;){var o=e[s],u=(31&e[s+1])<<8|e[s+2];o===Ke.H264_STREAM_TYPE&&null===a.programMapTable.video?a.programMapTable.video=u:o===Ke.ADTS_STREAM_TYPE&&null===a.programMapTable.audio?a.programMapTable.audio=u:o===Ke.METADATA_STREAM_TYPE&&(a.programMapTable["timed-metadata"][u]=o),s+=5+((15&e[s+3])<<8|e[s+4])}i.programMapTable=a.programMapTable}},this.push=function(i){var n={},a=4;if(n.payloadUnitStartIndicator=!!(64&i[1]),n.pid=31&i[1],n.pid<<=8,n.pid|=i[2],(48&i[3])>>>4>1&&(a+=i[a]+1),0===n.pid)n.type="pat",e(i.subarray(a),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(i.subarray(a),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([i,a,n]):this.processPes_(i,a,n)},this.processPes_=function(e,i,n){n.pid===this.programMapTable.video?n.streamType=Ke.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Ke.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(i),this.trigger("data",n)}}).prototype=new G,st.STREAM_TYPES={"h264":27,"adts":15},(ot=function ElementaryStream(){var e,i=this,n={"data":[],"size":0},a={"data":[],"size":0},s={"data":[],"size":0},o=function flushStream(e,n,a){var s,o,u=new Uint8Array(e.size),l={"type":n},c=0,h=0;if(e.data.length&&!(e.size<9)){for(l.trackId=e.data[0].pid,c=0;c<e.data.length;c++)o=e.data[c],u.set(o.data,h),h+=o.data.byteLength;!function parsePes(e,i){var n;i.packetLength=6+(e[4]<<8|e[5]),i.dataAlignmentIndicator=0!=(4&e[6]),192&(n=e[7])&&(i.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,i.pts*=4,i.pts+=(6&e[13])>>>1,i.dts=i.pts,64&n&&(i.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,i.dts*=4,i.dts+=(6&e[18])>>>1)),i.data=e.subarray(9+e[8])}(u,l),s="video"===n||l.packetLength<=e.size,(a||s)&&(e.size=0,e.data.length=0),s&&i.trigger("data",l)}};ot.prototype.init.call(this),this.push=function(u){({"pat":function pat(){},"pes":function pes(){var e,i;switch(u.streamType){case Ke.H264_STREAM_TYPE:e=n,i="video";break;case Ke.ADTS_STREAM_TYPE:e=a,i="audio";break;case Ke.METADATA_STREAM_TYPE:e=s,i="timed-metadata";break;default:return}u.payloadUnitStartIndicator&&o(e,i,!0),e.data.push(u),e.size+=u.data.byteLength},"pmt":function pmt(){var n={"type":"metadata","tracks":[]};null!==(e=u.programMapTable).video&&n.tracks.push({"timelineStartInfo":{"baseMediaDecodeTime":0},"id":+e.video,"codec":"avc","type":"video"}),null!==e.audio&&n.tracks.push({"timelineStartInfo":{"baseMediaDecodeTime":0},"id":+e.audio,"codec":"adts","type":"audio"}),i.trigger("data",n)}})[u.type]()},this.reset=function(){n.size=0,n.data.length=0,a.size=0,a.data.length=0,this.trigger("reset")},this.flushStreams_=function(){o(n,"video"),o(a,"audio"),o(s,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new G;var ct={"PAT_PID":0,"MP2T_PACKET_LENGTH":188,"TransportPacketStream":at,"TransportParseStream":st,"ElementaryStream":ot,"TimestampRolloverStream":lt,"CaptionStream":Xe.CaptionStream,"Cea608Stream":Xe.Cea608Stream,"Cea708Stream":Xe.Cea708Stream,"MetadataStream":ut};for(var dt in Ke)Ke.hasOwnProperty(dt)&&(ct[dt]=Ke[dt]);var ht,pt=ct,ft=ye,mt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(ht=function AdtsStream(e){var i,n=0;ht.prototype.init.call(this),this.push=function(a){var s,o,u,l,c,h,f=0;if(e||(n=0),"audio"===a.type)for(i?(l=i,(i=new Uint8Array(l.byteLength+a.data.byteLength)).set(l),i.set(a.data,l.byteLength)):i=a.data;f+5<i.length;)if(255===i[f]&&240==(246&i[f+1])){if(o=2*(1&~i[f+1]),s=(3&i[f+3])<<11|i[f+4]<<3|(224&i[f+5])>>5,h=(c=1024*(1+(3&i[f+6])))*ft/mt[(60&i[f+2])>>>2],u=f+s,i.byteLength<u)return;if(this.trigger("data",{"pts":a.pts+n*h,"dts":a.dts+n*h,"sampleCount":c,"audioobjecttype":1+(i[f+2]>>>6&3),"channelcount":(1&i[f+2])<<2|(192&i[f+3])>>>6,"samplerate":mt[(60&i[f+2])>>>2],"samplingfrequencyindex":(60&i[f+2])>>>2,"samplesize":16,"data":i.subarray(f+7+o,u)}),n++,i.byteLength===u)return void(i=void 0);i=i.subarray(u)}else f++},this.flush=function(){n=0,this.trigger("done")},this.reset=function(){i=void 0,this.trigger("reset")},this.endTimeline=function(){i=void 0,this.trigger("endedtimeline")}}).prototype=new G;var gt,vt,yt,_t=ht,Tt=function ExpGolomb(e){var i=e.byteLength,n=0,a=0;this.length=function(){return 8*i},this.bitsAvailable=function(){return 8*i+a},this.loadWord=function(){var s=e.byteLength-i,o=new Uint8Array(4),u=Math.min(4,i);if(0===u)throw new Error("no bytes available");o.set(e.subarray(s,s+u)),n=new DataView(o.buffer).getUint32(0),a=8*u,i-=u},this.skipBits=function(e){var s;a>e?(n<<=e,a-=e):(e-=a,e-=8*(s=Math.floor(e/8)),i-=s,this.loadWord(),n<<=e,a-=e)},this.readBits=function(e){var s=Math.min(a,e),o=n>>>32-s;return(a-=s)>0?n<<=s:i>0&&this.loadWord(),(s=e-s)>0?o<<s|this.readBits(s):o},this.skipLeadingZeros=function(){var e;for(e=0;e<a;++e)if(0!=(n&2147483648>>>e))return n<<=e,a-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(vt=function NalByteStream(){var e,i,n=0;vt.prototype.init.call(this),this.push=function(a){var s;i?((s=new Uint8Array(i.byteLength+a.data.byteLength)).set(i),s.set(a.data,i.byteLength),i=s):i=a.data;for(var o=i.byteLength;n<o-3;n++)if(1===i[n+2]){e=n+5;break}for(;e<o;)switch(i[e]){case 0:if(0!==i[e-1]){e+=2;break}if(0!==i[e-2]){e++;break}n+3!==e-2&&this.trigger("data",i.subarray(n+3,e-2));do{e++}while(1!==i[e]&&e<o);n=e-2,e+=3;break;case 1:if(0!==i[e-1]||0!==i[e-2]){e+=3;break}this.trigger("data",i.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}i=i.subarray(n),e-=n,n=0},this.reset=function(){i=null,n=0,this.trigger("reset")},this.flush=function(){i&&i.byteLength>3&&this.trigger("data",i.subarray(n+3)),i=null,n=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new G,yt={"100":!0,"110":!0,"122":!0,"244":!0,"44":!0,"83":!0,"86":!0,"118":!0,"128":!0,"138":!0,"139":!0,"134":!0},(gt=function H264Stream(){var e,i,n,a,s,o,u,l=new vt;gt.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(i=e.trackId,n=e.pts,a=e.dts,l.push(e))},l.on("data",(function(u){var l={"trackId":i,"pts":n,"dts":a,"data":u};switch(31&u[0]){case 5:l.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:l.nalUnitType="sei_rbsp",l.escapedRBSP=s(u.subarray(1));break;case 7:l.nalUnitType="seq_parameter_set_rbsp",l.escapedRBSP=s(u.subarray(1)),l.config=o(l.escapedRBSP);break;case 8:l.nalUnitType="pic_parameter_set_rbsp";break;case 9:l.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",l)})),l.on("done",(function(){e.trigger("done")})),l.on("partialdone",(function(){e.trigger("partialdone")})),l.on("reset",(function(){e.trigger("reset")})),l.on("endedtimeline",(function(){e.trigger("endedtimeline")})),this.flush=function(){l.flush()},this.partialFlush=function(){l.partialFlush()},this.reset=function(){l.reset()},this.endTimeline=function(){l.endTimeline()},u=function skipScalingList(e,i){var n,a=8,s=8;for(n=0;n<e;n++)0!==s&&(s=(a+i.readExpGolomb()+256)%256),a=0===s?a:s},s=function discardEmulationPreventionBytes(e){for(var i,n,a=e.byteLength,s=[],o=1;o<a-2;)0===e[o]&&0===e[o+1]&&3===e[o+2]?(s.push(o+2),o+=2):o++;if(0===s.length)return e;i=a-s.length,n=new Uint8Array(i);var u=0;for(o=0;o<i;u++,o++)u===s[0]&&(u++,s.shift()),n[o]=e[u];return n},o=function readSequenceParameterSet(e){var i,n,a,s,o,l,c,h,f,m,g,v,y,_=0,T=0,b=0,S=0,C=1;if(n=(i=new Tt(e)).readUnsignedByte(),s=i.readUnsignedByte(),a=i.readUnsignedByte(),i.skipUnsignedExpGolomb(),yt[n]&&(3===(o=i.readUnsignedExpGolomb())&&i.skipBits(1),i.skipUnsignedExpGolomb(),i.skipUnsignedExpGolomb(),i.skipBits(1),i.readBoolean()))for(g=3!==o?8:12,y=0;y<g;y++)i.readBoolean()&&u(y<6?16:64,i);if(i.skipUnsignedExpGolomb(),0===(l=i.readUnsignedExpGolomb()))i.readUnsignedExpGolomb();else if(1===l)for(i.skipBits(1),i.skipExpGolomb(),i.skipExpGolomb(),c=i.readUnsignedExpGolomb(),y=0;y<c;y++)i.skipExpGolomb();if(i.skipUnsignedExpGolomb(),i.skipBits(1),h=i.readUnsignedExpGolomb(),f=i.readUnsignedExpGolomb(),0===(m=i.readBits(1))&&i.skipBits(1),i.skipBits(1),i.readBoolean()&&(_=i.readUnsignedExpGolomb(),T=i.readUnsignedExpGolomb(),b=i.readUnsignedExpGolomb(),S=i.readUnsignedExpGolomb()),i.readBoolean()&&i.readBoolean()){switch(i.readUnsignedByte()){case 1:v=[1,1];break;case 2:v=[12,11];break;case 3:v=[10,11];break;case 4:v=[16,11];break;case 5:v=[40,33];break;case 6:v=[24,11];break;case 7:v=[20,11];break;case 8:v=[32,11];break;case 9:v=[80,33];break;case 10:v=[18,11];break;case 11:v=[15,11];break;case 12:v=[64,33];break;case 13:v=[160,99];break;case 14:v=[4,3];break;case 15:v=[3,2];break;case 16:v=[2,1];break;case 255:v=[i.readUnsignedByte()<<8|i.readUnsignedByte(),i.readUnsignedByte()<<8|i.readUnsignedByte()]}v&&(C=v[0]/v[1])}return{"profileIdc":n,"levelIdc":a,"profileCompatibility":s,"width":Math.ceil((16*(h+1)-2*_-2*T)*C),"height":(2-m)*(f+1)*16-2*b-2*S,"sarRatio":v}}}).prototype=new G;var bt,St={"H264Stream":gt,"NalByteStream":vt},Ct=function parseId3TagSize(e,i){var n=e[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9];return n=n>=0?n:0,(16&e[i+5])>>4?n+20:n+10},kt=function isLikelyAacData(e){var i=function getId3Offset(e,i){return e.length-i<10||e[i]!=="I".charCodeAt(0)||e[i+1]!=="D".charCodeAt(0)||e[i+2]!=="3".charCodeAt(0)?i:getId3Offset(e,i+=Ct(e,i))}(e,0);return e.length>=i+2&&255==(255&e[i])&&240==(240&e[i+1])&&16==(22&e[i+1])},Et=Ct,wt=function parseAdtsSize(e,i){var n=(224&e[i+5])>>5,a=e[i+4]<<3;return 6144&e[i+3]|a|n};(bt=function AacStream(){var e=new Uint8Array,i=0;bt.prototype.init.call(this),this.setTimestamp=function(e){i=e},this.push=function(n){var a,s,o,u,l=0,c=0;for(e.length?(u=e.length,(e=new Uint8Array(n.byteLength+u)).set(e.subarray(0,u)),e.set(n,u)):e=n;e.length-c>=3;)if(e[c]!=="I".charCodeAt(0)||e[c+1]!=="D".charCodeAt(0)||e[c+2]!=="3".charCodeAt(0))if(255!=(255&e[c])||240!=(240&e[c+1]))c++;else{if(e.length-c<7)break;if(c+(l=wt(e,c))>e.length)break;o={"type":"audio","data":e.subarray(c,c+l),"pts":i,"dts":i},this.trigger("data",o),c+=l}else{if(e.length-c<10)break;if(c+(l=Et(e,c))>e.length)break;s={"type":"timed-metadata","data":e.subarray(c,c+l)},this.trigger("data",s),c+=l}a=e.length-c,e=a>0?e.subarray(c):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new G;var Pt,It,xt,At,Lt=bt,Dt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Ot=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Mt=St.H264Stream,Rt=kt,Bt=ye,Nt=function arrayEquals(e,i){var n;if(e.length!==i.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==i[n])return!1;return!0},Ut=function generateSegmentTimingInfo(e,i,n,a,s,o){return{"start":{"dts":e,"pts":e+(n-i)},"end":{"dts":e+(a-i),"pts":e+(s-n)},"prependedContentDuration":o,"baseMediaDecodeTime":e}};(It=function AudioSegmentStream(e,i){var n=[],a=0,s=0,o=0,u=1/0;i=i||{},It.prototype.init.call(this),this.push=function(i){Le(e,i),e&&Dt.forEach((function(n){e[n]=i[n]})),n.push(i)},this.setEarliestDts=function(e){s=e},this.setVideoBaseMediaDecodeTime=function(e){u=e},this.setAudioAppendStart=function(e){o=e},this.flush=function(){var l,c,h,f,m,g,v;0!==n.length?(l=Ee(n,e,s),e.baseMediaDecodeTime=Ae(e,i.keepOriginalTimestamps),v=ke(e,l,o,u),e.samples=we(l),h=ne(Pe(l)),n=[],c=re(a,[e]),f=new Uint8Array(c.byteLength+h.byteLength),a++,f.set(c),f.set(h,c.byteLength),xe(e),m=Math.ceil(1024*Bt/e.samplerate),l.length&&(g=l.length*m,this.trigger("segmentTimingInfo",Ut(be(e.baseMediaDecodeTime,e.samplerate),l[0].dts,l[0].pts,l[0].dts+g,l[0].pts+g,v||0)),this.trigger("timingInfo",{"start":l[0].pts,"end":l[0].pts+g})),this.trigger("data",{"track":e,"boxes":f}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){xe(e),n=[],this.trigger("reset")}}).prototype=new G,(Pt=function VideoSegmentStream(e,i){var n,a,s=0,o=[],u=[];i=i||{},Pt.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(i){Le(e,i),"seq_parameter_set_rbsp"!==i.nalUnitType||n||(n=i.config,e.sps=[i.data],Ot.forEach((function(i){e[i]=n[i]}),this)),"pic_parameter_set_rbsp"!==i.nalUnitType||a||(a=i.data,e.pps=[i.data]),o.push(i)},this.flush=function(){for(var n,a,l,c,h,f,m,g,v=0;o.length&&"access_unit_delimiter_rbsp"!==o[0].nalUnitType;)o.shift();if(0===o.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=oe(o),(l=ue(n))[0][0].keyFrame||((a=this.getGopForFusion_(o[0],e))?(v=a.duration,l.unshift(a),l.byteLength+=a.byteLength,l.nalCount+=a.nalCount,l.pts=a.pts,l.dts=a.dts,l.duration+=a.duration):l=le(l)),u.length){var y;if(!(y=i.alignGopsAtEnd?this.alignGopsAtEnd_(l):this.alignGopsAtStart_(l)))return this.gopCache_.unshift({"gop":l.pop(),"pps":e.pps,"sps":e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");xe(e),l=y}Le(e,l),e.samples=ce(l),h=ne(de(l)),e.baseMediaDecodeTime=Ae(e,i.keepOriginalTimestamps),this.trigger("processedGopsInfo",l.map((function(e){return{"pts":e.pts,"dts":e.dts,"byteLength":e.byteLength}}))),m=l[0],g=l[l.length-1],this.trigger("segmentTimingInfo",Ut(e.baseMediaDecodeTime,m.dts,m.pts,g.dts+g.duration,g.pts+g.duration,v)),this.trigger("timingInfo",{"start":l[0].pts,"end":l[l.length-1].pts+l[l.length-1].duration}),this.gopCache_.unshift({"gop":l.pop(),"pps":e.pps,"sps":e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),c=re(s,[e]),f=new Uint8Array(c.byteLength+h.byteLength),s++,f.set(c),f.set(h,c.byteLength),this.trigger("data",{"track":e,"boxes":f}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),o=[],this.gopCache_.length=0,u.length=0,this.trigger("reset")},this.resetStream_=function(){xe(e),n=void 0,a=void 0},this.getGopForFusion_=function(i){var n,a,s,o,u,l=1/0;for(u=0;u<this.gopCache_.length;u++)s=(o=this.gopCache_[u]).gop,e.pps&&Nt(e.pps[0],o.pps[0])&&e.sps&&Nt(e.sps[0],o.sps[0])&&(s.dts<e.timelineStartInfo.dts||(n=i.dts-s.dts-s.duration)>=-1e4&&n<=45e3&&(!a||l>n)&&(a=o,l=n));return a?a.gop:null},this.alignGopsAtStart_=function(e){var i,n,a,s,o,l,c,h;for(o=e.byteLength,l=e.nalCount,c=e.duration,i=n=0;i<u.length&&n<e.length&&(a=u[i],s=e[n],a.pts!==s.pts);)s.pts>a.pts?i++:(n++,o-=s.byteLength,l-=s.nalCount,c-=s.duration);return 0===n?e:n===e.length?null:((h=e.slice(n)).byteLength=o,h.duration=c,h.nalCount=l,h.pts=h[0].pts,h.dts=h[0].dts,h)},this.alignGopsAtEnd_=function(e){var i,n,a,s,o,l,c;for(i=u.length-1,n=e.length-1,o=null,l=!1;i>=0&&n>=0;){if(a=u[i],s=e[n],a.pts===s.pts){l=!0;break}a.pts>s.pts?i--:(i===u.length-1&&(o=n),n--)}if(!l&&null===o)return null;if(0===(c=l?n:o))return e;var h=e.slice(c),f=h.reduce((function(e,i){return e.byteLength+=i.byteLength,e.duration+=i.duration,e.nalCount+=i.nalCount,e}),{"byteLength":0,"duration":0,"nalCount":0});return h.byteLength=f.byteLength,h.duration=f.duration,h.nalCount=f.nalCount,h.pts=h[0].pts,h.dts=h[0].dts,h},this.alignGopsWith=function(e){u=e}}).prototype=new G,(At=function CoalesceStream(e,i){this.numberOfTracks=0,this.metadataStream=i,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,At.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new G,At.prototype.flush=function(e){var i,n,a,s,o=0,u={"captions":[],"captionStreams":{},"metadata":[],"info":{}},l=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(l=this.videoTrack.timelineStartInfo.pts,Ot.forEach((function(e){u.info[e]=this.videoTrack[e]}),this)):this.audioTrack&&(l=this.audioTrack.timelineStartInfo.pts,Dt.forEach((function(e){u.info[e]=this.audioTrack[e]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?u.type=this.pendingTracks[0].type:u.type="combined",this.emittedTracks+=this.pendingTracks.length,a=ae(this.pendingTracks),u.initSegment=new Uint8Array(a.byteLength),u.initSegment.set(a),u.data=new Uint8Array(this.pendingBytes),s=0;s<this.pendingBoxes.length;s++)u.data.set(this.pendingBoxes[s],o),o+=this.pendingBoxes[s].byteLength;for(s=0;s<this.pendingCaptions.length;s++)(i=this.pendingCaptions[s]).startTime=Ce(i.startPts,l,this.keepOriginalTimestamps),i.endTime=Ce(i.endPts,l,this.keepOriginalTimestamps),u.captionStreams[i.stream]=!0,u.captions.push(i);for(s=0;s<this.pendingMetadata.length;s++)(n=this.pendingMetadata[s]).cueTime=Ce(n.pts,l,this.keepOriginalTimestamps),u.metadata.push(n);for(u.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",u),s=0;s<u.captions.length;s++)i=u.captions[s],this.trigger("caption",i);for(s=0;s<u.metadata.length;s++)n=u.metadata[s],this.trigger("id3Frame",n)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},At.prototype.setRemux=function(e){this.remuxTracks=e},(xt=function Transmuxer(e){var i,n,a=this,s=!0;xt.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var s={};this.transmuxPipeline_=s,s.type="aac",s.metadataStream=new pt.MetadataStream,s.aacStream=new Lt,s.audioTimestampRolloverStream=new pt.TimestampRolloverStream("audio"),s.timedMetadataTimestampRolloverStream=new pt.TimestampRolloverStream("timed-metadata"),s.adtsStream=new _t,s.coalesceStream=new At(e,s.metadataStream),s.headOfPipeline=s.aacStream,s.aacStream.pipe(s.audioTimestampRolloverStream).pipe(s.adtsStream),s.aacStream.pipe(s.timedMetadataTimestampRolloverStream).pipe(s.metadataStream).pipe(s.coalesceStream),s.metadataStream.on("timestamp",(function(e){s.aacStream.setTimestamp(e.timeStamp)})),s.aacStream.on("data",(function(o){"timed-metadata"!==o.type&&"audio"!==o.type||s.audioSegmentStream||(n=n||{"timelineStartInfo":{"baseMediaDecodeTime":a.baseMediaDecodeTime},"codec":"adts","type":"audio"},s.coalesceStream.numberOfTracks++,s.audioSegmentStream=new It(n,e),s.audioSegmentStream.on("timingInfo",a.trigger.bind(a,"audioTimingInfo")),s.adtsStream.pipe(s.audioSegmentStream).pipe(s.coalesceStream),a.trigger("trackinfo",{"hasAudio":!!n,"hasVideo":!!i}))})),s.coalesceStream.on("data",this.trigger.bind(this,"data")),s.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var s={};this.transmuxPipeline_=s,s.type="ts",s.metadataStream=new pt.MetadataStream,s.packetStream=new pt.TransportPacketStream,s.parseStream=new pt.TransportParseStream,s.elementaryStream=new pt.ElementaryStream,s.timestampRolloverStream=new pt.TimestampRolloverStream,s.adtsStream=new _t,s.h264Stream=new Mt,s.captionStream=new pt.CaptionStream,s.coalesceStream=new At(e,s.metadataStream),s.headOfPipeline=s.packetStream,s.packetStream.pipe(s.parseStream).pipe(s.elementaryStream).pipe(s.timestampRolloverStream),s.timestampRolloverStream.pipe(s.h264Stream),s.timestampRolloverStream.pipe(s.adtsStream),s.timestampRolloverStream.pipe(s.metadataStream).pipe(s.coalesceStream),s.h264Stream.pipe(s.captionStream).pipe(s.coalesceStream),s.elementaryStream.on("data",(function(o){var u;if("metadata"===o.type){for(u=o.tracks.length;u--;)i||"video"!==o.tracks[u].type?n||"audio"!==o.tracks[u].type||((n=o.tracks[u]).timelineStartInfo.baseMediaDecodeTime=a.baseMediaDecodeTime):(i=o.tracks[u]).timelineStartInfo.baseMediaDecodeTime=a.baseMediaDecodeTime;i&&!s.videoSegmentStream&&(s.coalesceStream.numberOfTracks++,s.videoSegmentStream=new Pt(i,e),s.videoSegmentStream.on("timelineStartInfo",(function(i){n&&!e.keepOriginalTimestamps&&(n.timelineStartInfo=i,s.audioSegmentStream.setEarliestDts(i.dts-a.baseMediaDecodeTime))})),s.videoSegmentStream.on("processedGopsInfo",a.trigger.bind(a,"gopInfo")),s.videoSegmentStream.on("segmentTimingInfo",a.trigger.bind(a,"videoSegmentTimingInfo")),s.videoSegmentStream.on("baseMediaDecodeTime",(function(e){n&&s.audioSegmentStream.setVideoBaseMediaDecodeTime(e)})),s.videoSegmentStream.on("timingInfo",a.trigger.bind(a,"videoTimingInfo")),s.h264Stream.pipe(s.videoSegmentStream).pipe(s.coalesceStream)),n&&!s.audioSegmentStream&&(s.coalesceStream.numberOfTracks++,s.audioSegmentStream=new It(n,e),s.audioSegmentStream.on("timingInfo",a.trigger.bind(a,"audioTimingInfo")),s.audioSegmentStream.on("segmentTimingInfo",a.trigger.bind(a,"audioSegmentTimingInfo")),s.adtsStream.pipe(s.audioSegmentStream).pipe(s.coalesceStream)),a.trigger("trackinfo",{"hasAudio":!!n,"hasVideo":!!i})}})),s.coalesceStream.on("data",this.trigger.bind(this,"data")),s.coalesceStream.on("id3Frame",(function(e){e.dispatchType=s.metadataStream.dispatchType,a.trigger("id3Frame",e)})),s.coalesceStream.on("caption",this.trigger.bind(this,"caption")),s.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(a){var s=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=a),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,xe(n),s.audioTimestampRolloverStream&&s.audioTimestampRolloverStream.discontinuity()),i&&(s.videoSegmentStream&&(s.videoSegmentStream.gopCache_=[]),i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,xe(i),s.captionStream.reset()),s.timestampRolloverStream&&s.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(i){var n=this.transmuxPipeline_;e.remux=i,n&&n.coalesceStream&&n.coalesceStream.setRemux(i)},this.alignGopsWith=function(e){i&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(s){var i=Rt(e);i&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():i||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),s=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){s=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new G;var jt={"Transmuxer":xt,"VideoSegmentStream":Pt,"AudioSegmentStream":It,"AUDIO_PROPERTIES":Dt,"VIDEO_PROPERTIES":Ot,"generateSegmentTimingInfo":Ut},Ft={"Adts":_t,"h264":St},Vt=ye,Ht=function AudioSegmentStream(e,i){var n=[],a=0,s=0,o=0,u=1/0,l=null,c=null;i=i||{},AudioSegmentStream.prototype.init.call(this),this.push=function(i){Le(e,i),e&&Dt.forEach((function(n){e[n]=i[n]})),n.push(i)},this.setEarliestDts=function(e){s=e},this.setVideoBaseMediaDecodeTime=function(e){u=e},this.setAudioAppendStart=function(e){o=e},this.processFrames_=function(){var h,f,m,g,v;0!==n.length&&0!==(h=Ee(n,e,s)).length&&(e.baseMediaDecodeTime=Ae(e,i.keepOriginalTimestamps),ke(e,h,o,u),e.samples=we(h),m=ne(Pe(h)),n=[],f=re(a,[e]),a++,e.initSegment=ae([e]),(g=new Uint8Array(f.byteLength+m.byteLength)).set(f),g.set(m,f.byteLength),xe(e),null===l&&(c=l=h[0].pts),c+=h.length*(1024*Vt/e.samplerate),v={"start":l},this.trigger("timingInfo",v),this.trigger("data",{"track":e,"boxes":g}))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{"start":l,"end":c}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){xe(e),l=null,c=null},this.reset=function(){this.resetTiming_(),n=[],this.trigger("reset")}};Ht.prototype=new G;var Wt=Ht,qt=function VideoSegmentStream(e,i){var n,a,s,o=0,u=[],l=[],c=null,h=null,f=!0;i=i||{},VideoSegmentStream.prototype.init.call(this),this.push=function(i){Le(e,i),void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=i.dts),"seq_parameter_set_rbsp"!==i.nalUnitType||n||(n=i.config,e.sps=[i.data],Ot.forEach((function(i){e[i]=n[i]}),this)),"pic_parameter_set_rbsp"!==i.nalUnitType||a||(a=i.data,e.pps=[i.data]),u.push(i)},this.processNals_=function(n){var a;for(u=l.concat(u);u.length&&"access_unit_delimiter_rbsp"!==u[0].nalUnitType;)u.shift();if(0!==u.length){var m=oe(u);if(m.length)if(l=m[m.length-1],n&&(m.pop(),m.duration-=l.duration,m.nalCount-=l.length,m.byteLength-=l.byteLength),m.length){if(this.trigger("timelineStartInfo",e.timelineStartInfo),f){if(!(s=ue(m))[0][0].keyFrame){if(!(s=le(s))[0][0].keyFrame)return u=[].concat.apply([],m).concat(l),void(l=[]);(m=[].concat.apply([],s)).duration=s.duration}f=!1}for(null===c&&(c=m[0].pts,h=c),h+=m.duration,this.trigger("timingInfo",{"start":c,"end":h}),a=0;a<m.length;a++){var g=m[a];e.samples=he(g);var v=ne(pe(g));xe(e),Le(e,g),e.baseMediaDecodeTime=Ae(e,i.keepOriginalTimestamps);var y=re(o,[e]);o++,e.initSegment=ae([e]);var _=new Uint8Array(y.byteLength+v.byteLength);_.set(y),_.set(v,y.byteLength),this.trigger("data",{"track":e,"boxes":_,"sequence":o,"videoFrameDts":g.dts,"videoFramePts":g.pts})}u=[]}else u=[]}},this.resetTimingAndConfig_=function(){n=void 0,a=void 0,c=null,h=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),l=[],u=[],f=!0,this.trigger("reset")}};qt.prototype=new G;var $t=qt,zt=kt,Gt=function createPipeline(e){return e.prototype=new G,e.prototype.init.call(e),e},Xt=function setupPipelineListeners(e,i){e.on("data",i.trigger.bind(i,"data")),e.on("done",i.trigger.bind(i,"done")),e.on("partialdone",i.trigger.bind(i,"partialdone")),e.on("endedtimeline",i.trigger.bind(i,"endedtimeline")),e.on("audioTimingInfo",i.trigger.bind(i,"audioTimingInfo")),e.on("videoTimingInfo",i.trigger.bind(i,"videoTimingInfo")),e.on("trackinfo",i.trigger.bind(i,"trackinfo")),e.on("id3Frame",(function(n){n.dispatchType=e.metadataStream.dispatchType,n.cueTime=Te(n.pts),i.trigger("id3Frame",n)})),e.on("caption",(function(e){i.trigger("caption",e)}))},Kt=function Transmuxer(e){var i=null,n=!0;e=e||{},Transmuxer.prototype.init.call(this),e.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.push=function(a){if(n){var s=zt(a);!s||i&&"aac"===i.type?s||i&&"ts"===i.type||(i=function tsPipeline(e){var i={"type":"ts","tracks":{"audio":null,"video":null},"packet":new pt.TransportPacketStream,"parse":new pt.TransportParseStream,"elementary":new pt.ElementaryStream,"timestampRollover":new pt.TimestampRolloverStream,"adts":new Ft.Adts,"h264":new Ft.h264.H264Stream,"captionStream":new pt.CaptionStream,"metadataStream":new pt.MetadataStream};return i.headOfPipeline=i.packet,i.packet.pipe(i.parse).pipe(i.elementary).pipe(i.timestampRollover),i.timestampRollover.pipe(i.h264),i.h264.pipe(i.captionStream),i.timestampRollover.pipe(i.metadataStream),i.timestampRollover.pipe(i.adts),i.elementary.on("data",(function(n){if("metadata"===n.type){for(var a=0;a<n.tracks.length;a++)i.tracks[n.tracks[a].type]||(i.tracks[n.tracks[a].type]=n.tracks[a],i.tracks[n.tracks[a].type].timelineStartInfo.baseMediaDecodeTime=e.baseMediaDecodeTime);i.tracks.video&&!i.videoSegmentStream&&(i.videoSegmentStream=new $t(i.tracks.video,e),i.videoSegmentStream.on("timelineStartInfo",(function(n){i.tracks.audio&&!e.keepOriginalTimestamps&&i.audioSegmentStream.setEarliestDts(n.dts-e.baseMediaDecodeTime)})),i.videoSegmentStream.on("timingInfo",i.trigger.bind(i,"videoTimingInfo")),i.videoSegmentStream.on("data",(function(e){i.trigger("data",{"type":"video","data":e})})),i.videoSegmentStream.on("done",i.trigger.bind(i,"done")),i.videoSegmentStream.on("partialdone",i.trigger.bind(i,"partialdone")),i.videoSegmentStream.on("endedtimeline",i.trigger.bind(i,"endedtimeline")),i.h264.pipe(i.videoSegmentStream)),i.tracks.audio&&!i.audioSegmentStream&&(i.audioSegmentStream=new Wt(i.tracks.audio,e),i.audioSegmentStream.on("data",(function(e){i.trigger("data",{"type":"audio","data":e})})),i.audioSegmentStream.on("done",i.trigger.bind(i,"done")),i.audioSegmentStream.on("partialdone",i.trigger.bind(i,"partialdone")),i.audioSegmentStream.on("endedtimeline",i.trigger.bind(i,"endedtimeline")),i.audioSegmentStream.on("timingInfo",i.trigger.bind(i,"audioTimingInfo")),i.adts.pipe(i.audioSegmentStream)),i.trigger("trackinfo",{"hasAudio":!!i.tracks.audio,"hasVideo":!!i.tracks.video})}})),i.captionStream.on("data",(function(n){var a;a=i.tracks.video&&i.tracks.video.timelineStartInfo.pts||0,n.startTime=Ce(n.startPts,a,e.keepOriginalTimestamps),n.endTime=Ce(n.endPts,a,e.keepOriginalTimestamps),i.trigger("caption",n)})),(i=Gt(i)).metadataStream.on("data",i.trigger.bind(i,"id3Frame")),i}(e),Xt(i,this)):(i=function aacPipeline(e){var i={"type":"aac","tracks":{"audio":null},"metadataStream":new pt.MetadataStream,"aacStream":new Lt,"audioRollover":new pt.TimestampRolloverStream("audio"),"timedMetadataRollover":new pt.TimestampRolloverStream("timed-metadata"),"adtsStream":new _t(!0)};return i.headOfPipeline=i.aacStream,i.aacStream.pipe(i.audioRollover).pipe(i.adtsStream),i.aacStream.pipe(i.timedMetadataRollover).pipe(i.metadataStream),i.metadataStream.on("timestamp",(function(e){i.aacStream.setTimestamp(e.timeStamp)})),i.aacStream.on("data",(function(n){"timed-metadata"!==n.type&&"audio"!==n.type||i.audioSegmentStream||(i.tracks.audio=i.tracks.audio||{"timelineStartInfo":{"baseMediaDecodeTime":e.baseMediaDecodeTime},"codec":"adts","type":"audio"},i.audioSegmentStream=new Wt(i.tracks.audio,e),i.audioSegmentStream.on("data",(function(e){i.trigger("data",{"type":"audio","data":e})})),i.audioSegmentStream.on("partialdone",i.trigger.bind(i,"partialdone")),i.audioSegmentStream.on("done",i.trigger.bind(i,"done")),i.audioSegmentStream.on("endedtimeline",i.trigger.bind(i,"endedtimeline")),i.audioSegmentStream.on("timingInfo",i.trigger.bind(i,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream),i.trigger("trackinfo",{"hasAudio":!!i.tracks.audio,"hasVideo":!!i.tracks.video}))})),(i=Gt(i)).metadataStream.on("data",i.trigger.bind(i,"id3Frame")),i}(e),Xt(i,this)),n=!1}i.headOfPipeline.push(a)},this.flush=function(){i&&(n=!0,i.headOfPipeline.flush())},this.partialFlush=function(){i&&i.headOfPipeline.partialFlush()},this.endTimeline=function(){i&&i.headOfPipeline.endTimeline()},this.reset=function(){i&&i.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(n){e.keepOriginalTimestamps||(e.baseMediaDecodeTime=n),i&&(i.tracks.audio&&(i.tracks.audio.timelineStartInfo.dts=void 0,i.tracks.audio.timelineStartInfo.pts=void 0,xe(i.tracks.audio),i.audioRollover&&i.audioRollover.discontinuity()),i.tracks.video&&(i.videoSegmentStream&&(i.videoSegmentStream.gopCache_=[]),i.tracks.video.timelineStartInfo.dts=void 0,i.tracks.video.timelineStartInfo.pts=void 0,xe(i.tracks.video)),i.timestampRollover&&i.timestampRollover.discontinuity())},this.setRemux=function(n){e.remux=n,i&&i.coalesceStream&&i.coalesceStream.setRemux(n)},this.setAudioAppendStart=function(e){i&&i.tracks.audio&&i.audioSegmentStream&&i.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){}};Kt.prototype=new G;var Yt=Kt,Qt=function toUnsigned(e){return e>>>0},Jt=function parseType(e){var i="";return i+=String.fromCharCode(e[0]),i+=String.fromCharCode(e[1]),i+=String.fromCharCode(e[2]),i+=String.fromCharCode(e[3])},Zt=Qt,ei=function findBox(e,i){var n,a,s,o,u,l=[];if(!i.length)return null;for(n=0;n<e.byteLength;)a=Zt(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),s=Jt(e.subarray(n+4,n+8)),o=a>1?n+a:e.byteLength,s===i[0]&&(1===i.length?l.push(e.subarray(n+8,o)):(u=findBox(e.subarray(n+8,o),i.slice(1))).length&&(l=l.concat(u))),n=o;return l},ti=Qt,ii=function tfdt(e){var i={"version":e[0],"flags":new Uint8Array(e.subarray(1,4)),"baseMediaDecodeTime":ti(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===i.version&&(i.baseMediaDecodeTime*=Math.pow(2,32),i.baseMediaDecodeTime+=ti(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),i},ni=function parseSampleFlags(e){return{"isLeading":(12&e[0])>>>2,"dependsOn":3&e[0],"isDependedOn":(192&e[1])>>>6,"hasRedundancy":(48&e[1])>>>4,"paddingValue":(14&e[1])>>>1,"isNonSyncSample":1&e[1],"degradationPriority":e[2]<<8|e[3]}},ri=function trun(e){var i,n={"version":e[0],"flags":new Uint8Array(e.subarray(1,4)),"samples":[]},a=new DataView(e.buffer,e.byteOffset,e.byteLength),s=1&n.flags[2],o=4&n.flags[2],u=1&n.flags[1],l=2&n.flags[1],c=4&n.flags[1],h=8&n.flags[1],f=a.getUint32(4),m=8;for(s&&(n.dataOffset=a.getInt32(m),m+=4),o&&f&&(i={"flags":ni(e.subarray(m,m+4))},m+=4,u&&(i.duration=a.getUint32(m),m+=4),l&&(i.size=a.getUint32(m),m+=4),h&&(1===n.version?i.compositionTimeOffset=a.getInt32(m):i.compositionTimeOffset=a.getUint32(m),m+=4),n.samples.push(i),f--);f--;)i={},u&&(i.duration=a.getUint32(m),m+=4),l&&(i.size=a.getUint32(m),m+=4),c&&(i.flags=ni(e.subarray(m,m+4)),m+=4),h&&(1===n.version?i.compositionTimeOffset=a.getInt32(m):i.compositionTimeOffset=a.getUint32(m),m+=4),n.samples.push(i);return n},ai=function tfhd(e){var i,n=new DataView(e.buffer,e.byteOffset,e.byteLength),a={"version":e[0],"flags":new Uint8Array(e.subarray(1,4)),"trackId":n.getUint32(4)},s=1&a.flags[2],o=2&a.flags[2],u=8&a.flags[2],l=16&a.flags[2],c=32&a.flags[2],h=65536&a.flags[0],f=131072&a.flags[0];return i=8,s&&(i+=4,a.baseDataOffset=n.getUint32(12),i+=4),o&&(a.sampleDescriptionIndex=n.getUint32(i),i+=4),u&&(a.defaultSampleDuration=n.getUint32(i),i+=4),l&&(a.defaultSampleSize=n.getUint32(i),i+=4),c&&(a.defaultSampleFlags=n.getUint32(i)),h&&(a.durationIsEmpty=!0),!s&&f&&(a.baseDataOffsetIsMoof=!0),a},si=Re,oi=Xe.CaptionStream,ui=function mapToSample(e,i){for(var n=e,a=0;a<i.length;a++){var s=i[a];if(n<s.size)return s;n-=s.size}return null},li=function parseCaptionNals(e,i){var n=ei(e,["moof","traf"]),a=ei(e,["mdat"]),s={},o=[];return a.forEach((function(e,i){var a=n[i];o.push({"mdat":e,"traf":a})})),o.forEach((function(e){var n,a=e.mdat,o=e.traf,u=ei(o,["tfhd"]),l=ai(u[0]),c=l.trackId,h=ei(o,["tfdt"]),f=h.length>0?ii(h[0]).baseMediaDecodeTime:0,m=ei(o,["trun"]);i===c&&m.length>0&&(n=function findSeiNals(e,i,n){var a,s,o,u,l=new DataView(e.buffer,e.byteOffset,e.byteLength),c=[];for(s=0;s+4<e.length;s+=o)if(o=l.getUint32(s),s+=4,!(o<=0))switch(31&e[s]){case 6:var h=e.subarray(s+1,s+1+o),f=ui(s,i);if(a={"nalUnitType":"sei_rbsp","size":o,"data":h,"escapedRBSP":si(h),"trackId":n},f)a.pts=f.pts,a.dts=f.dts,u=f;else{if(!u){console.log("We've encountered a nal unit without data. See mux.js#233.");break}a.pts=u.pts,a.dts=u.dts}c.push(a)}return c}(a,function parseSamples(e,i,n){var a=i,s=n.defaultSampleDuration||0,o=n.defaultSampleSize||0,u=n.trackId,l=[];return e.forEach((function(e){var i=ri(e).samples;i.forEach((function(e){void 0===e.duration&&(e.duration=s),void 0===e.size&&(e.size=o),e.trackId=u,e.dts=a,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=a+e.compositionTimeOffset,a+=e.duration})),l=l.concat(i)})),l}(m,f,l),c),s[c]||(s[c]=[]),s[c]=s[c].concat(n))})),s},ci=function CaptionParser(){var e,i,n,a,s,o,u=!1;this.isInitialized=function(){return u},this.init=function(i){e=new oi,u=!0,o=!!i&&i.isPartial,e.on("data",(function(e){e.startTime=e.startPts/a,e.endTime=e.endPts/a,s.captions.push(e),s.captionStreams[e.stream]=!0}))},this.isNewInit=function(e,i){return!(e&&0===e.length||i&&"object"==typeof i&&0===Object.keys(i).length)&&(n!==e[0]||a!==i[n])},this.parse=function(e,o,u){var l;if(!this.isInitialized())return null;if(!o||!u)return null;if(this.isNewInit(o,u))n=o[0],a=u[n];else if(null===n||!a)return i.push(e),null;for(;i.length>0;){var c=i.shift();this.parse(c,o,u)}return null!==(l=function parseEmbeddedCaptions(e,i,n){return null===i?null:{"seiNals":li(e,i)[i],"timescale":n}}(e,n,a))&&l.seiNals?(this.pushNals(l.seiNals),this.flushStream(),s):null},this.pushNals=function(i){if(!this.isInitialized()||!i||0===i.length)return null;i.forEach((function(i){e.push(i)}))},this.flushStream=function(){if(!this.isInitialized())return null;o?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){s.captions=[],s.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){i=[],n=null,a=null,s?this.clearParsedCaptions():s={"captions":[],"captionStreams":{}},this.resetCaptionStream()},this.reset()},di=function typeFromStreamString(e){return"AudioSegmentStream"===e?"audio":"VideoSegmentStream"===e?"video":""},hi=function(){function MessageHandlers(e,i){this.options=i||{},this.self=e,this.init()}var e=MessageHandlers.prototype;return e.init=function init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=this.options.handlePartialData?new Yt(this.options):new jt.Transmuxer(this.options),this.options.handlePartialData?function wirePartialTransmuxerEvents(e,i){i.on("data",(function(i){var n={"data":i.data.track.initSegment.buffer,"byteOffset":i.data.track.initSegment.byteOffset,"byteLength":i.data.track.initSegment.byteLength},a={"boxes":{"data":i.data.boxes.buffer,"byteOffset":i.data.boxes.byteOffset,"byteLength":i.data.boxes.byteLength},"initSegment":n,"type":i.type,"sequence":i.data.sequence};void 0!==i.data.videoFrameDts&&(a.videoFrameDtsTime=Te(i.data.videoFrameDts)),void 0!==i.data.videoFramePts&&(a.videoFramePtsTime=Te(i.data.videoFramePts)),e.postMessage({"action":"data","segment":a},[a.boxes.data,a.initSegment.data])})),i.on("id3Frame",(function(i){e.postMessage({"action":"id3Frame","id3Frame":i})})),i.on("caption",(function(i){e.postMessage({"action":"caption","caption":i})})),i.on("done",(function(i){e.postMessage({"action":"done","type":di(i)})})),i.on("partialdone",(function(i){e.postMessage({"action":"partialdone","type":di(i)})})),i.on("endedsegment",(function(i){e.postMessage({"action":"endedSegment","type":di(i)})})),i.on("trackinfo",(function(i){e.postMessage({"action":"trackinfo","trackInfo":i})})),i.on("audioTimingInfo",(function(i){if(null!==i.start){var n={"start":Te(i.start)};i.end&&(n.end=Te(i.end)),e.postMessage({"action":"audioTimingInfo","audioTimingInfo":n})}else e.postMessage({"action":"audioTimingInfo","audioTimingInfo":i})})),i.on("videoTimingInfo",(function(i){var n={"start":Te(i.start)};i.end&&(n.end=Te(i.end)),e.postMessage({"action":"videoTimingInfo","videoTimingInfo":n})}))}(this.self,this.transmuxer):function wireFullTransmuxerEvents(e,i){i.on("data",(function(i){var n=i.initSegment;i.initSegment={"data":n.buffer,"byteOffset":n.byteOffset,"byteLength":n.byteLength};var a=i.data;i.data=a.buffer,e.postMessage({"action":"data","segment":i,"byteOffset":a.byteOffset,"byteLength":a.byteLength},[i.data])})),i.on("done",(function(i){e.postMessage({"action":"done"})})),i.on("gopInfo",(function(i){e.postMessage({"action":"gopInfo","gopInfo":i})})),i.on("videoSegmentTimingInfo",(function(i){var n={"start":{"decode":Te(i.start.dts),"presentation":Te(i.start.pts)},"end":{"decode":Te(i.end.dts),"presentation":Te(i.end.pts)},"baseMediaDecodeTime":Te(i.baseMediaDecodeTime)};i.prependedContentDuration&&(n.prependedContentDuration=Te(i.prependedContentDuration)),e.postMessage({"action":"videoSegmentTimingInfo","videoSegmentTimingInfo":n})})),i.on("audioSegmentTimingInfo",(function(i){var n={"start":{"decode":Te(i.start.dts),"presentation":Te(i.start.pts)},"end":{"decode":Te(i.end.dts),"presentation":Te(i.end.pts)},"baseMediaDecodeTime":Te(i.baseMediaDecodeTime)};i.prependedContentDuration&&(n.prependedContentDuration=Te(i.prependedContentDuration)),e.postMessage({"action":"audioSegmentTimingInfo","audioSegmentTimingInfo":n})})),i.on("id3Frame",(function(i){e.postMessage({"action":"id3Frame","id3Frame":i})})),i.on("caption",(function(i){e.postMessage({"action":"caption","caption":i})})),i.on("trackinfo",(function(i){e.postMessage({"action":"trackinfo","trackInfo":i})})),i.on("audioTimingInfo",(function(i){e.postMessage({"action":"audioTimingInfo","audioTimingInfo":{"start":Te(i.start),"end":Te(i.end)}})})),i.on("videoTimingInfo",(function(i){e.postMessage({"action":"videoTimingInfo","videoTimingInfo":{"start":Te(i.start),"end":Te(i.end)}})}))}(this.self,this.transmuxer)},e.pushMp4Captions=function pushMp4Captions(e){this.captionParser||(this.captionParser=new ci,this.captionParser.init());var i=new Uint8Array(e.data,e.byteOffset,e.byteLength),n=this.captionParser.parse(i,e.trackIds,e.timescales);this.self.postMessage({"action":"mp4Captions","captions":n&&n.captions||[],"data":i.buffer},[i.buffer])},e.clearAllMp4Captions=function clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()},e.clearParsedMp4Captions=function clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()},e.push=function push(e){var i=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(i)},e.reset=function reset(){this.transmuxer.reset()},e.setTimestampOffset=function setTimestampOffset(e){var i=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(_e(i)))},e.setAudioAppendStart=function setAudioAppendStart(e){this.transmuxer.setAudioAppendStart(Math.ceil(_e(e.appendStart)))},e.setRemux=function setRemux(e){this.transmuxer.setRemux(e.remux)},e.flush=function flush(e){this.transmuxer.flush(),n.postMessage({"action":"done","type":"transmuxed"})},e.partialFlush=function partialFlush(e){this.transmuxer.partialFlush(),n.postMessage({"action":"partialdone","type":"transmuxed"})},e.endTimeline=function endTimeline(){this.transmuxer.endTimeline(),n.postMessage({"action":"endedtimeline","type":"transmuxed"})},e.alignGopsWith=function alignGopsWith(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())},MessageHandlers}();new function TransmuxerWorker(e){e.onmessage=function(i){"init"===i.data.action&&i.data.options?this.messageHandlers=new hi(e,i.data.options):(this.messageHandlers||(this.messageHandlers=new hi(e)),i.data&&i.data.action&&"init"!==i.data.action&&this.messageHandlers[i.data.action]&&this.messageHandlers[i.data.action](i.data))}}(n)}()})),ms=function isMaat(e,i){var n=i.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&n.AUDIO&&e.mediaGroups.AUDIO[n.AUDIO]},gs=function codecsForPlaylist(e,i){var n=i.attributes||{},a=function getCodecs(e){var i=e.attributes||{};if(i.CODECS)return Object(Fe.parseCodecs)(i.CODECS)}(i)||{};if(ms(e,i)&&!a.audio&&!function isMuxed(e,i){if(!ms(e,i))return!0;var n=i.attributes||{},a=e.mediaGroups.AUDIO[n.AUDIO];for(var s in a)if(!a[s].uri&&!a[s].playlists)return!0;return!1}(e,i)){var s=Object(Fe.codecsFromDefault)(e,n.AUDIO);s&&(a.audio=s.audio)}var o={};return a.video&&(o.video=Object(Fe.translateLegacyCodec)(""+a.video.type+a.video.details)),a.audio&&(o.audio=Object(Fe.translateLegacyCodec)(""+a.audio.type+a.audio.details)),a.text&&(o.text=a.text.type),a.unknown&&(o.unknown=a.unknown),o},vs=function logger(e){return videojs$1.log.debug?videojs$1.log.debug.bind(videojs$1,"VHS:",e+" >"):function(){}},ys=vs("PlaylistSelector"),_s=function representationToString(e){if(e&&e.playlist){var i=e.playlist;return JSON.stringify({"id":i.id,"bandwidth":e.bandwidth,"width":e.width,"height":e.height,"codecs":i.attributes&&i.attributes.CODECS||""})}},Ts=function safeGetComputedStyle(e,i){if(!e)return"";var n=s.a.getComputedStyle(e);return n?n[i]:""},bs=function stableSort(e,i){var n=e.slice();e.sort((function(e,a){var s=i(e,a);return 0===s?n.indexOf(e)-n.indexOf(a):s}))},Ss=function comparePlaylistBandwidth(e,i){var n,a;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||s.a.Number.MAX_VALUE,i.attributes.BANDWIDTH&&(a=i.attributes.BANDWIDTH),n-(a=a||s.a.Number.MAX_VALUE)},Cs=function simpleSelector(e,i,n,a,o){if(e){var u={"bandwidth":i,"width":n,"height":a,"limitRenditionByPlayerDimensions":o},l=e.playlists.map((function(e){var i=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,n=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;return{"bandwidth":e.attributes.BANDWIDTH||s.a.Number.MAX_VALUE,"width":i,"height":n,"playlist":e}}));bs(l,(function(e,i){return e.bandwidth-i.bandwidth}));var c=(l=l.filter((function(e){return!ma.isIncompatible(e.playlist)}))).filter((function(e){return ma.isEnabled(e.playlist)}));c.length||(c=l.filter((function(e){return!ma.isDisabled(e.playlist)})));var h=c.filter((function(e){return e.bandwidth*Ua.BANDWIDTH_VARIANCE<i})),f=h[h.length-1],m=h.filter((function(e){return e.bandwidth===f.bandwidth}))[0];if(!1===o){var g=m||c[0]||l[0];if(g&&g.playlist){var v="sortedPlaylistReps";return m&&(v="bandwidthBestRep"),c[0]&&(v="enabledPlaylistReps"),ys("choosing "+_s(g)+" using "+v+" with options",u),g.playlist}return ys("could not choose a playlist with options",u),null}var y=h.filter((function(e){return e.width&&e.height}));bs(y,(function(e,i){return e.width-i.width}));var _=y.filter((function(e){return e.width===n&&e.height===a}));f=_[_.length-1];var T,b,S,C=_.filter((function(e){return e.bandwidth===f.bandwidth}))[0];C||(b=(T=y.filter((function(e){return e.width>n||e.height>a}))).filter((function(e){return e.width===T[0].width&&e.height===T[0].height})),f=b[b.length-1],S=b.filter((function(e){return e.bandwidth===f.bandwidth}))[0]);var k=S||C||m||c[0]||l[0];if(k&&k.playlist){var E="sortedPlaylistReps";return S?E="resolutionPlusOneRep":C?E="resolutionBestRep":m?E="bandwidthBestRep":c[0]&&(E="enabledPlaylistReps"),ys("choosing "+_s(k)+" using "+E+" with options",u),k.playlist}return ys("could not choose a playlist with options",u),null}},ks=function lastBandwidthSelector(){var e=this.useDevicePixelRatio&&s.a.devicePixelRatio||1;return Cs(this.playlists.master,this.systemBandwidth,parseInt(Ts(this.tech_.el(),"width"),10)*e,parseInt(Ts(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions)},Es=function addMetadata(e){var i=e.inbandTextTracks,n=e.metadataArray,a=e.timestampOffset,o=e.videoDuration;if(n){var u=s.a.WebKitDataCue||s.a.VTTCue,l=i.metadataTrack_;if(l&&(n.forEach((function(e){var i=e.cueTime+a;!("number"!=typeof i||s.a.isNaN(i)||i<0)&&i<1/0&&e.frames.forEach((function(e){var n=new u(i,i,e.value||e.url||e.data||"");n.frame=e,n.value=e,function deprecateOldCue(e){Object.defineProperties(e.frame,{"id":{"get":function get(){return videojs$1.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},"value":{"get":function get(){return videojs$1.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},"privateData":{"get":function get(){return videojs$1.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(n),l.addCue(n)}))})),l.cues&&l.cues.length)){for(var c=l.cues,h=[],f=0;f<c.length;f++)c[f]&&h.push(c[f]);var m=h.reduce((function(e,i){var n=e[i.startTime]||[];return n.push(i),e[i.startTime]=n,e}),{}),g=Object.keys(m).sort((function(e,i){return Number(e)-Number(i)}));g.forEach((function(e,i){var n=m[e],a=Number(g[i+1])||o;n.forEach((function(e){e.endTime=a}))}))}}},ws=function removeCuesFromTrack(e,i,n){var a,s;if(n&&n.cues)for(a=n.cues.length;a--;)(s=n.cues[a]).startTime>=e&&s.endTime<=i&&n.removeCue(s)},Ps=function finite(e){return"number"==typeof e&&isFinite(e)},Is=function timingInfoPropertyForMedia(e){return e+"TimingInfo"},xs=function timestampOffsetForSegment(e){var i=e.segmentTimeline,n=e.currentTimeline,a=e.startOfSegment,s=e.buffered;return e.overrideCheck||i!==n?i<n?a:s.length?s.end(s.length-1):a:null},As=function shouldWaitForTimelineChange(e){var i=e.timelineChangeController,n=e.currentTimeline,a=e.segmentTimeline,s=e.loaderType,o=e.audioDisabled;if(n===a)return!1;if("audio"===s){var u=i.lastTimelineChange({"type":"main"});return!u||u.to!==a}if("main"===s&&o){var l=i.pendingTimelineChange({"type":"audio"});return!l||l.to!==a}return!1},Ls=function segmentTooLong(e){var i=e.segmentDuration,n=e.maxDuration;return!!i&&Math.round(i)>n+1/30},Ds=function getTroublesomeSegmentDurationMessage(e,i){if("hls"!==i)return null;var n=function mediaDuration(e,i){var n=e&&"number"==typeof e.start&&"number"==typeof e.end?e.end-e.start:0,a=i&&"number"==typeof i.start&&"number"==typeof i.end?i.end-i.start:0;return Math.max(n,a)}(e.audioTimingInfo,e.videoTimingInfo);if(!n)return null;var a=e.playlist.targetDuration,s=Ls({"segmentDuration":n,"maxDuration":2*a}),o=Ls({"segmentDuration":n,"maxDuration":a}),u="Segment with index "+e.mediaIndex+" from playlist "+e.playlist.id+" has a duration of "+n+" when the reported duration is "+e.duration+" and the target duration is "+a+". For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";return s||o?{"severity":s?"warn":"info","message":u}:null},Os=function(e){function SegmentLoader(i,n){var a;if(a=e.call(this)||this,!i)throw new TypeError("Initialization settings are required");if("function"!=typeof i.currentTime)throw new TypeError("No currentTime getter specified");if(!i.mediaSource)throw new TypeError("No MediaSource specified");return a.bandwidth=i.bandwidth,a.throughput={"rate":0,"count":0},a.roundTrip=NaN,a.resetStats_(),a.mediaIndex=null,a.hasPlayed_=i.hasPlayed,a.currentTime_=i.currentTime,a.seekable_=i.seekable,a.seeking_=i.seeking,a.duration_=i.duration,a.mediaSource_=i.mediaSource,a.vhs_=i.vhs,a.loaderType_=i.loaderType,a.currentMediaInfo_=void 0,a.startingMediaInfo_=void 0,a.segmentMetadataTrack_=i.segmentMetadataTrack,a.goalBufferLength_=i.goalBufferLength,a.sourceType_=i.sourceType,a.sourceUpdater_=i.sourceUpdater,a.inbandTextTracks_=i.inbandTextTracks,a.state_="INIT",a.handlePartialData_=i.handlePartialData,a.timelineChangeController_=i.timelineChangeController,a.shouldSaveSegmentTimingInfo_=!0,a.checkBufferTimeout_=null,a.error_=void 0,a.currentTimeline_=-1,a.pendingSegment_=null,a.xhrOptions_=null,a.pendingSegments_=[],a.audioDisabled_=!1,a.isPendingTimestampOffset_=!1,a.gopBuffer_=[],a.timeMapping_=0,a.safeAppend_=videojs$1.browser.IE_VERSION>=11,a.appendInitSegment_={"audio":!0,"video":!0},a.playlistOfLastInitSegment_={"audio":null,"video":null},a.callQueue_=[],a.loadQueue_=[],a.metadataQueue_={"id3":[],"caption":[]},a.activeInitSegmentId_=null,a.initSegments_={},a.cacheEncryptionKeys_=i.cacheEncryptionKeys,a.keyCache_={},a.decrypter_=i.decrypter,a.syncController_=i.syncController,a.syncPoint_={"segmentIndex":0,"time":0},a.transmuxer_=a.createTransmuxer_(),a.triggerSyncInfoUpdate_=function(){return a.trigger("syncinfoupdate")},a.syncController_.on("syncinfoupdate",a.triggerSyncInfoUpdate_),a.mediaSource_.addEventListener("sourceopen",(function(){a.isEndOfStream_()||(a.ended_=!1)})),a.fetchAtBuffer_=!1,a.logger_=vs("SegmentLoader["+a.loaderType_+"]"),Object.defineProperty(f()(a),"state",{"get":function get(){return this.state_},"set":function set(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e,this.trigger("statechange"))}}),a.sourceUpdater_.on("ready",(function(){a.hasEnoughInfoToAppend_()&&a.processCallQueue_()})),"main"===a.loaderType_&&a.timelineChangeController_.on("pendingtimelinechange",(function(){a.hasEnoughInfoToAppend_()&&a.processCallQueue_()})),"audio"===a.loaderType_&&a.timelineChangeController_.on("timelinechange",(function(){a.hasEnoughInfoToLoad_()&&a.processLoadQueue_(),a.hasEnoughInfoToAppend_()&&a.processCallQueue_()})),a}g()(SegmentLoader,e);var i=SegmentLoader.prototype;return i.createTransmuxer_=function createTransmuxer_(){var e=new fs;return e.postMessage({"action":"init","options":{"remux":!1,"alignGopsAtEnd":this.safeAppend_,"keepOriginalTimestamps":!0,"handlePartialData":this.handlePartialData_}}),e},i.resetStats_=function resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0},i.dispose=function dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&(this.transmuxer_.terminate(),Ga()),this.resetStats_(),this.checkBufferTimeout_&&s.a.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},i.setAudio=function setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},i.abort=function abort(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)},i.abort_=function abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_)},i.checkForAbort_=function checkForAbort_(e){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==e:(this.state="READY",!0)},i.error=function error(e){return void 0!==e&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_},i.endOfStream=function endOfStream(){this.ended_=!0,this.transmuxer_&&za(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},i.buffered_=function buffered_(){if(!this.sourceUpdater_||!this.startingMediaInfo_)return videojs$1.createTimeRanges();if("main"===this.loaderType_){var e=this.startingMediaInfo_,i=e.hasAudio,n=e.hasVideo,a=e.isMuxed;if(n&&i&&!this.audioDisabled_&&!a)return this.sourceUpdater_.buffered();if(n)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},i.initSegmentForMap=function initSegmentForMap(e,i){if(void 0===i&&(i=!1),!e)return null;var n=Ea(e),a=this.initSegments_[n];return i&&!a&&e.bytes&&(this.initSegments_[n]=a={"resolvedUri":e.resolvedUri,"byterange":e.byterange,"bytes":e.bytes,"tracks":e.tracks,"timescales":e.timescales}),a||e},i.segmentKey=function segmentKey(e,i){if(void 0===i&&(i=!1),!e)return null;var n=wa(e),a=this.keyCache_[n];this.cacheEncryptionKeys_&&i&&!a&&e.bytes&&(this.keyCache_[n]=a={"resolvedUri":e.resolvedUri,"bytes":e.bytes});var s={"resolvedUri":(a||e).resolvedUri};return a&&(s.bytes=a.bytes),s},i.couldBeginLoading_=function couldBeginLoading_(){return this.playlist_&&!this.paused()},i.load=function load(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}},i.init_=function init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},i.playlist=function playlist(e,i){if(void 0===i&&(i={}),e){var n=this.playlist_,a=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=i,"INIT"===this.state&&(e.syncInfo={"mediaSequence":e.mediaSequence,"time":0});var s=null;if(n&&(n.id?s=n.id:n.uri&&(s=n.uri)),this.logger_("playlist update ["+s+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!n||n.uri!==e.uri)return(null!==this.mediaIndex||this.handlePartialData_)&&this.resyncLoader(),this.currentMediaInfo_=void 0,void this.trigger("playlistupdate");var o=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+o+"]"),null!==this.mediaIndex&&(this.mediaIndex-=o),a&&(a.mediaIndex-=o,a.mediaIndex>=0&&(a.segment=e.segments[a.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}},i.pause=function pause(){this.checkBufferTimeout_&&(s.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},i.paused=function paused(){return null===this.checkBufferTimeout_},i.resetEverything=function resetEverything(e){this.ended_=!1,this.appendInitSegment_={"audio":!0,"video":!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&this.transmuxer_.postMessage({"action":"clearAllMp4Captions"})},i.resetLoader=function resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()},i.resyncLoader=function resyncLoader(){this.transmuxer_&&za(this.transmuxer_),this.mediaIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({"action":"clearParsedMp4Captions"})},i.remove=function remove(e,i,n){if(void 0===n&&(n=function done(){}),i===1/0&&(i=this.duration_()),this.sourceUpdater_&&this.currentMediaInfo_){var a=1,s=function removeFinished(){0===--a&&n()};for(var o in this.audioDisabled_||(a++,this.sourceUpdater_.removeAudio(e,i,s)),"main"===this.loaderType_&&this.currentMediaInfo_&&this.currentMediaInfo_.hasVideo&&(this.gopBuffer_=function removeGopBuffer(e,i,n,a){for(var s=Math.ceil((i-a)*Ne.ONE_SECOND_IN_TS),o=Math.ceil((n-a)*Ne.ONE_SECOND_IN_TS),u=e.slice(),l=e.length;l--&&!(e[l].pts<=o););if(-1===l)return u;for(var c=l+1;c--&&!(e[c].pts<=s););return c=Math.max(c,0),u.splice(c,l-c+1),u}(this.gopBuffer_,e,i,this.timeMapping_),a++,this.sourceUpdater_.removeVideo(e,i,s)),this.inbandTextTracks_)ws(e,i,this.inbandTextTracks_[o]);ws(e,i,this.segmentMetadataTrack_),s()}},i.monitorBuffer_=function monitorBuffer_(){this.checkBufferTimeout_&&s.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=s.a.setTimeout(this.monitorBufferTick_.bind(this),1)},i.monitorBufferTick_=function monitorBufferTick_(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&s.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=s.a.setTimeout(this.monitorBufferTick_.bind(this),500)},i.fillBuffer_=function fillBuffer_(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.buffered_(),i=this.checkBuffer_(e,this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);i&&(i.timestampOffset=xs({"segmentTimeline":i.timeline,"currentTimeline":this.currentTimeline_,"startOfSegment":i.startOfSegment,"buffered":e,"overrideCheck":this.isPendingTimestampOffset_}),this.isPendingTimestampOffset_=!1,"number"==typeof i.timestampOffset&&this.timelineChangeController_.pendingTimelineChange({"type":this.loaderType_,"from":this.currentTimeline_,"to":i.timeline}),this.loadSegment_(i))}},i.isEndOfStream_=function isEndOfStream_(e,i){if(void 0===e&&(e=this.mediaIndex),void 0===i&&(i=this.playlist_),!i||!this.mediaSource_)return!1;var n=e+1===i.segments.length;return i.endList&&"open"===this.mediaSource_.readyState&&n},i.checkBuffer_=function checkBuffer_(e,i,n,a,s,o){var u=0;e.length&&(u=e.end(e.length-1));var l=Math.max(0,u-s);if(!i.segments.length)return null;if(l>=this.goalBufferLength_())return null;if(!a&&l>=1)return null;var c,h=null,f=!1;if(null===o)h=this.getSyncSegmentCandidate_(i),f=!0;else if(null!==n){var m=i.segments[n];c=m&&m.end?m.end:u,h=n+1}else if(this.fetchAtBuffer_){var g=ma.getMediaInfoForTime(i,u,o.segmentIndex,o.time);h=g.mediaIndex,c=g.startTime}else{var v=ma.getMediaInfoForTime(i,s,o.segmentIndex,o.time);h=v.mediaIndex,c=v.startTime}var y=this.generateSegmentInfo_(i,h,c,f);return!y||this.mediaSource_&&this.playlist_&&y.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()?void 0:(this.logger_("checkBuffer_ returning "+y.uri,{"segmentInfo":y,"playlist":i,"currentMediaIndex":n,"nextMediaIndex":h,"startOfSegment":c,"isSyncRequest":f}),y)},i.getSyncSegmentCandidate_=function getSyncSegmentCandidate_(e){var i=this;if(-1===this.currentTimeline_)return 0;var n=e.segments.map((function(e,i){return{"timeline":e.timeline,"segmentIndex":i}})).filter((function(e){return e.timeline===i.currentTimeline_}));return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)},i.generateSegmentInfo_=function generateSegmentInfo_(e,i,n,a){if(i<0||i>=e.segments.length)return null;var s,o,u=e.segments[i],l=this.sourceUpdater_.audioBuffered(),c=this.sourceUpdater_.videoBuffered();return l.length&&(s=l.end(l.length-1)-this.sourceUpdater_.audioTimestampOffset()),c.length&&(o=function gopsSafeToAlignWith(e,i,n){if(null==i||!e.length)return[];var a,s=Math.ceil((i-n+3)*Ne.ONE_SECOND_IN_TS);for(a=0;a<e.length&&!(e[a].pts>s);a++);return e.slice(a)}(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),{"requestId":"segment-loader-"+Math.random(),"uri":u.resolvedUri,"mediaIndex":i,"isSyncRequest":a,"startOfSegment":n,"playlist":e,"bytes":null,"encryptedBytes":null,"timestampOffset":null,"timeline":u.timeline,"duration":u.duration,"segment":u,"byteLength":0,"transmuxer":this.transmuxer_,"audioAppendStart":s,"gopsToAlignWith":o}},i.earlyAbortWhenNeeded_=function earlyAbortWhenNeeded_(e){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)){var i=this.currentTime_(),n=e.bandwidth,a=this.pendingSegment_.duration,s=ma.estimateSegmentRequestTime(a,n,this.playlist_,e.bytesReceived),o=function timeUntilRebuffer(e,i,n){return void 0===n&&(n=1),((e.length?e.end(e.length-1):0)-i)/n}(this.buffered_(),i,this.vhs_.tech_.playbackRate())-1;if(!(s<=o)){var u=function minRebufferMaxBandwidthSelector(e){var i=e.master,n=e.currentTime,a=e.bandwidth,s=e.duration,o=e.segmentDuration,u=e.timeUntilRebuffer,l=e.currentTimeline,c=e.syncController,h=i.playlists.filter((function(e){return!ma.isIncompatible(e)})),f=h.filter(ma.isEnabled);f.length||(f=h.filter((function(e){return!ma.isDisabled(e)})));var m=f.filter(ma.hasAttribute.bind(null,"BANDWIDTH")).map((function(e){var i=c.getSyncPoint(e,s,l,n)?1:2;return{"playlist":e,"rebufferingImpact":ma.estimateSegmentRequestTime(o,a,e)*i-u}})),g=m.filter((function(e){return e.rebufferingImpact<=0}));return bs(g,(function(e,i){return Ss(i.playlist,e.playlist)})),g.length?g[0]:(bs(m,(function(e,i){return e.rebufferingImpact-i.rebufferingImpact})),m[0]||null)}({"master":this.vhs_.playlists.master,"currentTime":i,"bandwidth":n,"duration":this.duration_(),"segmentDuration":a,"timeUntilRebuffer":o,"currentTimeline":this.currentTimeline_,"syncController":this.syncController_});if(u){var l=s-o-u.rebufferingImpact,c=.5;o<=1/30&&(c=1),!u.playlist||u.playlist.uri===this.playlist_.uri||l<c||(this.bandwidth=u.playlist.attributes.BANDWIDTH*Ua.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}},i.handleAbort_=function handleAbort_(){this.mediaRequestsAborted+=1},i.handleProgress_=function handleProgress_(e,i){this.earlyAbortWhenNeeded_(i.stats),this.checkForAbort_(i.requestId)||this.trigger("progress")},i.handleTrackInfo_=function handleTrackInfo_(e,i){this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId)||this.checkForIllegalMediaSwitch(i)||(i=i||{},function shallowEqual(e,i){if(!e&&!i||!e&&i||e&&!i)return!1;if(e===i)return!0;var n=Object.keys(e).sort(),a=Object.keys(i).sort();if(n.length!==a.length)return!1;for(var s=0;s<n.length;s++){var o=n[s];if(o!==a[s])return!1;if(e[o]!==i[o])return!1}return!0}(this.currentMediaInfo_,i)||(this.appendInitSegment_={"audio":!0,"video":!0},this.startingMediaInfo_=i,this.currentMediaInfo_=i,this.logger_("trackinfo update",i),this.trigger("trackinfo")),this.checkForAbort_(e.requestId)||(this.pendingSegment_.trackInfo=i,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))},i.handleTimingInfo_=function handleTimingInfo_(e,i,n,a){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)){var s=this.pendingSegment_,o=Is(i);s[o]=s[o]||{},s[o][n]=a,this.logger_("timinginfo: "+i+" - "+n+" - "+a),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},i.handleCaptions_=function handleCaptions_(e,i){var n=this;if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(0!==i.length)if(this.pendingSegment_.hasAppendedData_){var a=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),o={};i.forEach((function(e){o[e.stream]=o[e.stream]||{"startTime":1/0,"captions":[],"endTime":0};var i=o[e.stream];i.startTime=Math.min(i.startTime,e.startTime+a),i.endTime=Math.max(i.endTime,e.endTime+a),i.captions.push(e)})),Object.keys(o).forEach((function(e){var i=o[e],u=i.startTime,l=i.endTime,c=i.captions,h=n.inbandTextTracks_;n.logger_("adding cues from "+u+" -> "+l+" for "+e),function createCaptionsTrackIfNotExists(e,i,n){if(!e[n]){i.trigger({"type":"usage","name":"vhs-608"}),i.trigger({"type":"usage","name":"hls-608"});var a=i.textTracks().getTrackById(n);e[n]=a||i.addRemoteTextTrack({"kind":"captions","id":n,"label":n},!1).track}}(h,n.vhs_.tech_,e),ws(u,l,h[e]),function addCaptionData(e){var i=e.inbandTextTracks,n=e.captionArray,a=e.timestampOffset;if(n){var o=s.a.WebKitDataCue||s.a.VTTCue;n.forEach((function(e){var n=e.stream;i[n].addCue(new o(e.startTime+a,e.endTime+a,e.text))}))}}({"captionArray":c,"inbandTextTracks":h,"timestampOffset":a})})),this.transmuxer_&&this.transmuxer_.postMessage({"action":"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,i));else this.logger_("SegmentLoader received no captions from a caption event")},i.handleId3_=function handleId3_(e,i,n){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(this.pendingSegment_.hasAppendedData_){var a=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();!function createMetadataTrackIfNotExists(e,i,n){e.metadataTrack_||(e.metadataTrack_=n.addRemoteTextTrack({"kind":"metadata","label":"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=i)}(this.inbandTextTracks_,n,this.vhs_.tech_),Es({"inbandTextTracks":this.inbandTextTracks_,"metadataArray":i,"timestampOffset":a,"videoDuration":this.duration_()})}else this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,i,n))},i.processMetadataQueue_=function processMetadataQueue_(){this.metadataQueue_.id3.forEach((function(e){return e()})),this.metadataQueue_.caption.forEach((function(e){return e()})),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},i.processCallQueue_=function processCallQueue_(){var e=this.callQueue_;this.callQueue_=[],e.forEach((function(e){return e()}))},i.processLoadQueue_=function processLoadQueue_(){var e=this.loadQueue_;this.loadQueue_=[],e.forEach((function(e){return e()}))},i.hasEnoughInfoToLoad_=function hasEnoughInfoToLoad_(){if("audio"!==this.loaderType_)return!0;var e=this.pendingSegment_;return!!e&&(!this.currentMediaInfo_||!As({"timelineChangeController":this.timelineChangeController_,"currentTimeline":this.currentTimeline_,"segmentTimeline":e.timeline,"loaderType":this.loaderType_,"audioDisabled":this.audioDisabled_}))},i.hasEnoughInfoToAppend_=function hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready())return!1;var e=this.pendingSegment_;if(!e||!e.trackInfo)return!1;if(!this.handlePartialData_){var i=this.currentMediaInfo_,n=i.hasAudio,a=i.hasVideo,s=i.isMuxed;if(a&&!e.videoTimingInfo)return!1;if(n&&!this.audioDisabled_&&!s&&!e.audioTimingInfo)return!1}return!As({"timelineChangeController":this.timelineChangeController_,"currentTimeline":this.currentTimeline_,"segmentTimeline":e.timeline,"loaderType":this.loaderType_,"audioDisabled":this.audioDisabled_})},i.handleData_=function handleData_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(!this.callQueue_.length&&this.hasEnoughInfoToAppend_()){var n=this.pendingSegment_;if(this.setTimeMapping_(n.timeline),this.updateMediaSecondsLoaded_(n.segment),"closed"!==this.mediaSource_.readyState){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),n.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),n.isFmp4=e.isFmp4,n.timingInfo=n.timingInfo||{},n.isFmp4)this.trigger("fmp4"),n.timingInfo.start=n[Is(i.type)].start;else{var a,s="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo;s&&(a=this.handlePartialData_?i.videoFramePtsTime:n.videoTimingInfo.start),n.timingInfo.start=this.trueSegmentStart_({"currentStart":n.timingInfo.start,"playlist":n.playlist,"mediaIndex":n.mediaIndex,"currentVideoTimestampOffset":this.sourceUpdater_.videoTimestampOffset(),"useVideoTimingInfo":s,"firstVideoFrameTimeForData":a,"videoTimingInfo":n.videoTimingInfo,"audioTimingInfo":n.audioTimingInfo})}this.updateAppendInitSegmentStatus(n,i.type),this.updateSourceBufferTimestampOffset_(n),n.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(n,i)}}else this.callQueue_.push(this.handleData_.bind(this,e,i))},i.updateAppendInitSegmentStatus=function updateAppendInitSegmentStatus(e,i){"main"!==this.loaderType_||"number"!=typeof e.timestampOffset||e.changedTimestampOffset||(this.appendInitSegment_={"audio":!0,"video":!0}),this.playlistOfLastInitSegment_[i]!==e.playlist&&(this.appendInitSegment_[i]=!0)},i.getInitSegmentAndUpdateState_=function getInitSegmentAndUpdateState_(e){var i=e.type,n=e.initSegment,a=e.map,s=e.playlist;if(a){var o=Ea(a);if(this.activeInitSegmentId_===o)return null;n=this.initSegmentForMap(a,!0).bytes,this.activeInitSegmentId_=o}return n&&this.appendInitSegment_[i]?(this.playlistOfLastInitSegment_[i]=s,this.appendInitSegment_[i]=!!a,this.activeInitSegmentId_=null,n):null},i.appendToSourceBuffer_=function appendToSourceBuffer_(e){var i=this,n=e.segmentInfo,a=e.type,s=e.initSegment,o=e.data,u=[o],l=o.byteLength;s&&(u.unshift(s),l+=s.byteLength);var c=function concatSegments(e){var i,n=0;return e.bytes&&(i=new Uint8Array(e.bytes),e.segments.forEach((function(e){i.set(e,n),n+=e.byteLength}))),i}({"bytes":l,"segments":u});this.sourceUpdater_.appendBuffer({"segmentInfo":n,"type":a,"bytes":c},(function(e){e&&(i.error(a+" append of "+c.length+"b failed for segment #"+n.mediaIndex+" in playlist "+n.playlist.id),i.trigger("appenderror"))}))},i.handleSegmentTimingInfo_=function handleSegmentTimingInfo_(e,i,n){if(this.pendingSegment_&&i===this.pendingSegment_.requestId){var a=this.pendingSegment_.segment,s=e+"TimingInfo";a[s]||(a[s]={}),a[s].transmuxerPrependedSeconds=n.prependedContentDuration||0,a[s].transmuxedPresentationStart=n.start.presentation,a[s].transmuxedDecodeStart=n.start.decode,a[s].transmuxedPresentationEnd=n.end.presentation,a[s].transmuxedDecodeEnd=n.end.decode,a[s].baseMediaDecodeTime=n.baseMediaDecodeTime}},i.appendData_=function appendData_(e,i){var n=i.type,a=i.data;if(a&&a.byteLength&&("audio"!==n||!this.audioDisabled_)){var s=this.getInitSegmentAndUpdateState_({"type":n,"initSegment":i.initSegment,"playlist":e.playlist,"map":e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({"segmentInfo":e,"type":n,"initSegment":s,"data":a})}},i.loadSegment_=function loadSegment_(e){var i=this;this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),"number"==typeof e.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({"action":"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(e):this.loadQueue_.push((function(){var n=i.buffered_();"number"==typeof e.timestampOffset&&(e.timestampOffset=xs({"segmentTimeline":e.timeline,"currentTimeline":i.currentTimeline_,"startOfSegment":e.startOfSegment,"buffered":n,"overrideCheck":!0})),delete e.audioAppendStart;var a=i.sourceUpdater_.audioBuffered();a.length&&(e.audioAppendStart=a.end(a.length-1)-i.sourceUpdater_.audioTimestampOffset()),i.updateTransmuxerAndRequestSegment_(e)}))},i.updateTransmuxerAndRequestSegment_=function updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({"action":"reset"}),this.transmuxer_.postMessage({"action":"setTimestampOffset","timestampOffset":e.timestampOffset}));var i=this.createSimplifiedSegmentObj_(e);e.abortRequests=as({"xhr":this.vhs_.xhr,"xhrOptions":this.xhrOptions_,"decryptionWorker":this.decrypter_,"segment":i,"handlePartialData":this.handlePartialData_,"abortFn":this.handleAbort_.bind(this),"progressFn":this.handleProgress_.bind(this),"trackInfoFn":this.handleTrackInfo_.bind(this),"timingInfoFn":this.handleTimingInfo_.bind(this),"videoSegmentTimingInfoFn":this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),"audioSegmentTimingInfoFn":this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),"captionsFn":this.handleCaptions_.bind(this),"id3Fn":this.handleId3_.bind(this),"dataFn":this.handleData_.bind(this),"doneFn":this.segmentRequestFinished_.bind(this)})},i.trimBackBuffer_=function trimBackBuffer_(e){var i=function safeBackBufferTrimTime(e,i,n){var a=i-Ua.BACK_BUFFER_LENGTH;e.length&&(a=Math.max(a,e.start(0)));var s=i-n;return Math.min(s,a)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);i>0&&this.remove(0,i)},i.createSimplifiedSegmentObj_=function createSimplifiedSegmentObj_(e){var i=e.segment,n={"resolvedUri":i.resolvedUri,"byterange":i.byterange,"requestId":e.requestId,"transmuxer":e.transmuxer,"audioAppendStart":e.audioAppendStart,"gopsToAlignWith":e.gopsToAlignWith},a=e.playlist.segments[e.mediaIndex-1];if(a&&a.timeline===i.timeline&&(a.videoTimingInfo?n.baseStartTime=a.videoTimingInfo.transmuxedDecodeEnd:a.audioTimingInfo&&(n.baseStartTime=a.audioTimingInfo.transmuxedDecodeEnd)),i.key){var s=i.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(i.key),n.key.iv=s}return i.map&&(n.map=this.initSegmentForMap(i.map)),n},i.saveTransferStats_=function saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)},i.saveBandwidthRelatedStats_=function saveBandwidthRelatedStats_(e,i){this.pendingSegment_.byteLength=i.bytesReceived,e<1/60?this.logger_("Ignoring segment's bandwidth because its duration of "+e+" is less than the min to record "+1/60):(this.bandwidth=i.bandwidth,this.roundTrip=i.roundTripTime)},i.handleTimeout_=function handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate")},i.segmentRequestFinished_=function segmentRequestFinished_(e,i,n){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,i,n));else if(this.saveTransferStats_(i.stats),this.pendingSegment_&&i.requestId===this.pendingSegment_.requestId){if(e){if(this.pendingSegment_=null,this.state="READY",e.code===Qa)return;return this.pause(),e.code===Ya?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error"))}var a=this.pendingSegment_;this.saveBandwidthRelatedStats_(a.duration,i.stats),a.endOfAllRequests=i.endOfAllRequests,n.gopInfo&&(this.gopBuffer_=function updateGopBuffer(e,i,n){if(!i.length)return e;if(n)return i.slice();for(var a=i[0].pts,s=0;s<e.length&&!(e[s].pts>=a);s++);return e.slice(0,s).concat(i)}(this.gopBuffer_,n.gopInfo,this.safeAppend_)),this.state="APPENDING";var s=this.isEndOfStream_(a.mediaIndex,a.playlist),o=null!==this.mediaIndex,u=a.timeline!==this.currentTimeline_&&a.timeline>0;!a.isFmp4&&(s||o&&u)&&Xa(this.transmuxer_),this.trigger("appending"),this.waitForAppendsToComplete_(a)}},i.setTimeMapping_=function setTimeMapping_(e){var i=this.syncController_.mappingForTimeline(e);null!==i&&(this.timeMapping_=i)},i.updateMediaSecondsLoaded_=function updateMediaSecondsLoaded_(e){"number"==typeof e.start&&"number"==typeof e.end?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration},i.shouldUpdateTransmuxerTimestampOffset_=function shouldUpdateTransmuxerTimestampOffset_(e){return null!==e&&("main"===this.loaderType_&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset())},i.trueSegmentStart_=function trueSegmentStart_(e){var i=e.currentStart,n=e.playlist,a=e.mediaIndex,s=e.firstVideoFrameTimeForData,o=e.currentVideoTimestampOffset,u=e.useVideoTimingInfo,l=e.videoTimingInfo,c=e.audioTimingInfo;if(void 0!==i)return i;if(!u)return c.start;var h=n.segments[a-1];return 0!==a&&h&&void 0!==h.start&&h.end===s+o?l.start:s},i.waitForAppendsToComplete_=function waitForAppendsToComplete_(e){if(!this.currentMediaInfo_)return this.error({"message":"No starting media returned, likely due to an unsupported media format.","blacklistDuration":1/0}),void this.trigger("error");var i=this.currentMediaInfo_,n=i.hasAudio,a=i.hasVideo,s=i.isMuxed,o="main"===this.loaderType_&&a,u=!this.audioDisabled_&&n&&!s;if(e.waitingOnAppends=0,!e.hasAppendedData_)return e.timingInfo||"number"!=typeof e.timestampOffset||(this.isPendingTimestampOffset_=!0),e.timingInfo={"start":0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),void this.checkAppendsDone_(e);o&&e.waitingOnAppends++,u&&e.waitingOnAppends++,o&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),u&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))},i.checkAppendsDone_=function checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,0===e.waitingOnAppends&&this.handleAppendsDone_())},i.checkForIllegalMediaSwitch=function checkForIllegalMediaSwitch(e){var i=function illegalMediaSwitch(e,i,n){return"main"===e&&i&&n?n.hasAudio||n.hasVideo?i.hasVideo&&!n.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!i.hasVideo&&n.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.currentMediaInfo_,e);return!!i&&(this.error({"message":i,"blacklistDuration":1/0}),this.trigger("error"),!0)},i.updateSourceBufferTimestampOffset_=function updateSourceBufferTimestampOffset_(e){if(null!==e.timestampOffset&&"number"==typeof e.timingInfo.start&&!e.changedTimestampOffset&&"main"===this.loaderType_){var i=!1;e.timestampOffset-=e.timingInfo.start,e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),i=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),i=!0),i&&this.trigger("timestampoffset")}},i.updateTimingInfoEnd_=function updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};var i="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;i&&(e.timingInfo.end="number"==typeof i.end?i.end:i.start+e.duration)},i.handleAppendsDone_=function handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_;this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({"segmentInfo":e,"shouldSaveTimelineMapping":"main"===this.loaderType_}),this.logger_(function segmentInfoString(e){var i=e.segment,n=i.start,a=i.end,s=e.playlist,o=s.mediaSequence,u=s.id,l=s.segments,c=void 0===l?[]:l,h=e.mediaIndex,f=e.timeline;return["appending ["+h+"] of ["+o+", "+(o+c.length)+"] from playlist ["+u+"]","["+n+" => "+a+"] in timeline ["+f+"]"].join(" ")}(e));var i=Ds(e,this.sourceType_);if(i&&("warn"===i.severity?videojs$1.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest)this.trigger("syncinfoupdate");else{this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({"type":this.loaderType_,"from":this.currentTimeline_,"to":e.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({"type":"audio","from":this.currentTimeline_,"to":e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");var n=e.segment;if(n.end&&this.currentTime_()-n.end>3*e.playlist.targetDuration)this.resetEverything();else null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.isEndOfStream_(e.mediaIndex,e.playlist)&&this.endOfStream(),this.trigger("appended"),this.paused()||this.monitorBuffer_()}},i.recordThroughput_=function recordThroughput_(e){if(e.duration<1/60)this.logger_("Ignoring segment's throughput because its duration of "+e.duration+" is less than the min to record "+1/60);else{var i=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,a=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(a-i)/++this.throughput.count}},i.addSegmentMetadataCue_=function addSegmentMetadataCue_(e){if(this.segmentMetadataTrack_){var i=e.segment,n=i.start,a=i.end;if(Ps(n)&&Ps(a)){ws(n,a,this.segmentMetadataTrack_);var o=s.a.WebKitDataCue||s.a.VTTCue,u={"custom":i.custom,"dateTimeObject":i.dateTimeObject,"dateTimeString":i.dateTimeString,"bandwidth":e.playlist.attributes.BANDWIDTH,"resolution":e.playlist.attributes.RESOLUTION,"codecs":e.playlist.attributes.CODECS,"byteLength":e.byteLength,"uri":e.uri,"timeline":e.timeline,"playlist":e.playlist.id,"start":n,"end":a},l=new o(n,a,JSON.stringify(u));l.value=u,this.segmentMetadataTrack_.addCue(l)}}},SegmentLoader}(videojs$1.EventTarget);function video_es_noop(){}var Ms,Rs=function toTitleCase(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toUpperCase()}))},Bs=["video","audio"],Ns=function updating(e,i){var n=i[e+"Buffer"];return n&&n.updating||i.queuePending[e]},Us=function shiftQueue(e,i){if(0!==i.queue.length){var n=0,a=i.queue[n];if("mediaSource"!==a.type){if("mediaSource"!==e&&i.ready()&&"closed"!==i.mediaSource.readyState&&!Ns(e,i)){if(a.type!==e){if(null===(n=function nextQueueIndexOfType(e,i){for(var n=0;n<i.length;n++){var a=i[n];if("mediaSource"===a.type)return null;if(a.type===e)return n}return null}(e,i.queue)))return;a=i.queue[n]}i.queue.splice(n,1),a.action(e,i),a.doneFn?i.queuePending[e]=a:shiftQueue(e,i)}}else i.updating()||"closed"===i.mediaSource.readyState||(i.queue.shift(),a.action(i),a.doneFn&&a.doneFn(),shiftQueue("audio",i),shiftQueue("video",i))}},js=function cleanupBuffer(e,i){var n=i[e+"Buffer"],a=Rs(e);n&&(n.removeEventListener("updateend",i["on"+a+"UpdateEnd_"]),n.removeEventListener("error",i["on"+a+"Error_"]),i.codecs[e]=null,i[e+"Buffer"]=null)},Fs=function inSourceBuffers(e,i){return e&&i&&-1!==Array.prototype.indexOf.call(e.sourceBuffers,i)},Vs=function appendBuffer(e,i){return function(n,a){var s=a[n+"Buffer"];Fs(a.mediaSource,s)&&(a.logger_("Appending segment "+i.mediaIndex+"'s "+e.length+" bytes to "+n+"Buffer"),s.appendBuffer(e))}},Hs=function remove(e,i){return function(n,a){var s=a[n+"Buffer"];Fs(a.mediaSource,s)&&(a.logger_("Removing "+e+" to "+i+" from "+n+"Buffer"),s.remove(e,i))}},Ws=function timestampOffset(e){return function(i,n){var a=n[i+"Buffer"];Fs(n.mediaSource,a)&&(n.logger_("Setting "+i+"timestampOffset to "+e),a.timestampOffset=e)}},qs=function callback(e){return function(i,n){e()}},$s=function endOfStream(e){return function(i){if("open"===i.mediaSource.readyState){i.logger_("Calling mediaSource endOfStream("+(e||"")+")");try{i.mediaSource.endOfStream(e)}catch(e){videojs$1.log.warn("Failed to call media source endOfStream",e)}}}},zs=function duration(e){return function(i){i.logger_("Setting mediaSource duration to "+e);try{i.mediaSource.duration=e}catch(e){videojs$1.log.warn("Failed to set media source duration",e)}}},Gs=function abort(){return function(e,i){if("open"===i.mediaSource.readyState){var n=i[e+"Buffer"];if(Fs(i.mediaSource,n)){i.logger_("calling abort on "+e+"Buffer");try{n.abort()}catch(i){videojs$1.log.warn("Failed to abort on "+e+"Buffer",i)}}}}},Xs=function addSourceBuffer(e,i){return function(n){var a=Rs(e),s=Object(Fe.getMimeForCodec)(i);n.logger_("Adding "+e+"Buffer with codec "+i+" to mediaSource");var o=n.mediaSource.addSourceBuffer(s);o.addEventListener("updateend",n["on"+a+"UpdateEnd_"]),o.addEventListener("error",n["on"+a+"Error_"]),n.codecs[e]=i,n[e+"Buffer"]=o}},Ks=function removeSourceBuffer(e){return function(i){var n=i[e+"Buffer"];if(js(e,i),Fs(i.mediaSource,n)){i.logger_("Removing "+e+"Buffer with codec "+i.codecs[e]+" from mediaSource");try{i.mediaSource.removeSourceBuffer(n)}catch(i){videojs$1.log.warn("Failed to removeSourceBuffer "+e+"Buffer",i)}}}},Ys=function changeType(e){return function(i,n){var a=n[i+"Buffer"],s=Object(Fe.getMimeForCodec)(e);Fs(n.mediaSource,a)&&n.codecs[i]!==e&&(n.logger_("changing "+i+"Buffer codec from "+n.codecs[i]+" to "+e),a.changeType(s),n.codecs[i]=e)}},Qs=function pushQueue(e){var i=e.type,n=e.sourceUpdater,a=e.action,s=e.doneFn,o=e.name;n.queue.push({"type":i,"action":a,"doneFn":s,"name":o}),Us(i,n)},Js=function onUpdateend(e,i){return function(n){if(i.queuePending[e]){var a=i.queuePending[e].doneFn;i.queuePending[e]=null,a&&a(i[e+"Error_"])}Us(e,i)}},Zs=function(e){function SourceUpdater(i){var n;return(n=e.call(this)||this).mediaSource=i,n.sourceopenListener_=function(){return Us("mediaSource",f()(n))},n.mediaSource.addEventListener("sourceopen",n.sourceopenListener_),n.logger_=vs("SourceUpdater"),n.audioTimestampOffset_=0,n.videoTimestampOffset_=0,n.queue=[],n.queuePending={"audio":null,"video":null},n.delayedAudioAppendQueue_=[],n.videoAppendQueued_=!1,n.codecs={},n.onVideoUpdateEnd_=Js("video",f()(n)),n.onAudioUpdateEnd_=Js("audio",f()(n)),n.onVideoError_=function(e){n.videoError_=e},n.onAudioError_=function(e){n.audioError_=e},n.createdSourceBuffers_=!1,n.initializedEme_=!1,n.triggeredReady_=!1,n}g()(SourceUpdater,e);var i=SourceUpdater.prototype;return i.initializedEme=function initializedEme(){this.initializedEme_=!0,this.triggerReady()},i.hasCreatedSourceBuffers=function hasCreatedSourceBuffers(){return this.createdSourceBuffers_},i.hasInitializedAnyEme=function hasInitializedAnyEme(){return this.initializedEme_},i.ready=function ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},i.createSourceBuffers=function createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},i.triggerReady=function triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},i.addSourceBuffer=function addSourceBuffer(e,i){Qs({"type":"mediaSource","sourceUpdater":this,"action":Xs(e,i),"name":"addSourceBuffer"})},i.abort=function abort(e){Qs({"type":e,"sourceUpdater":this,"action":Gs(e),"name":"abort"})},i.removeSourceBuffer=function removeSourceBuffer(e){this.canRemoveSourceBuffer()?Qs({"type":"mediaSource","sourceUpdater":this,"action":Ks(e),"name":"removeSourceBuffer"}):videojs$1.log.error("removeSourceBuffer is not supported!")},i.canRemoveSourceBuffer=function canRemoveSourceBuffer(){return!videojs$1.browser.IE_VERSION&&!videojs$1.browser.IS_FIREFOX&&s.a.MediaSource&&s.a.MediaSource.prototype&&"function"==typeof s.a.MediaSource.prototype.removeSourceBuffer},SourceUpdater.canChangeType=function canChangeType(){return s.a.SourceBuffer&&s.a.SourceBuffer.prototype&&"function"==typeof s.a.SourceBuffer.prototype.changeType},i.canChangeType=function canChangeType(){return this.constructor.canChangeType()},i.changeType=function changeType(e,i){this.canChangeType()?Qs({"type":e,"sourceUpdater":this,"action":Ys(i),"name":"changeType"}):videojs$1.log.error("changeType is not supported!")},i.addOrChangeSourceBuffers=function addOrChangeSourceBuffers(e){var i=this;if(!e||"object"!=typeof e||0===Object.keys(e).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach((function(n){var a=e[n];if(!i.hasCreatedSourceBuffers())return i.addSourceBuffer(n,a);i.canChangeType()&&i.changeType(n,a)}))},i.appendBuffer=function appendBuffer(e,i){var n=this,a=e.segmentInfo,s=e.type,o=e.bytes;if(this.processedAppend_=!0,"audio"===s&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([e,i]),void this.logger_("delayed audio append of "+o.length+" until video append");if(Qs({"type":s,"sourceUpdater":this,"action":Vs(o,a||{"mediaIndex":-1}),"doneFn":i,"name":"appendBuffer"}),"video"===s){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var u=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+u.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,u.forEach((function(e){n.appendBuffer.apply(n,e)}))}},i.audioBuffered=function audioBuffered(){return Fs(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:videojs$1.createTimeRange()},i.videoBuffered=function videoBuffered(){return Fs(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:videojs$1.createTimeRange()},i.buffered=function buffered(){var e=Fs(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,i=Fs(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return i&&!e?this.audioBuffered():e&&!i?this.videoBuffered():function bufferIntersection(e,i){var n=null,a=null,s=0,o=[],u=[];if(!(e&&e.length&&i&&i.length))return videojs$1.createTimeRange();for(var l=e.length;l--;)o.push({"time":e.start(l),"type":"start"}),o.push({"time":e.end(l),"type":"end"});for(l=i.length;l--;)o.push({"time":i.start(l),"type":"start"}),o.push({"time":i.end(l),"type":"end"});for(o.sort((function(e,i){return e.time-i.time})),l=0;l<o.length;l++)"start"===o[l].type?2===++s&&(n=o[l].time):"end"===o[l].type&&1===--s&&(a=o[l].time),null!==n&&null!==a&&(u.push([n,a]),n=null,a=null);return videojs$1.createTimeRanges(u)}(this.audioBuffered(),this.videoBuffered())},i.setDuration=function setDuration(e,i){void 0===i&&(i=video_es_noop),Qs({"type":"mediaSource","sourceUpdater":this,"action":zs(e),"name":"duration","doneFn":i})},i.endOfStream=function endOfStream(e,i){void 0===e&&(e=null),void 0===i&&(i=video_es_noop),"string"!=typeof e&&(e=void 0),Qs({"type":"mediaSource","sourceUpdater":this,"action":$s(e),"name":"endOfStream","doneFn":i})},i.removeAudio=function removeAudio(e,i,n){void 0===n&&(n=video_es_noop),this.audioBuffered().length&&0!==this.audioBuffered().end(0)?Qs({"type":"audio","sourceUpdater":this,"action":Hs(e,i),"doneFn":n,"name":"remove"}):n()},i.removeVideo=function removeVideo(e,i,n){void 0===n&&(n=video_es_noop),this.videoBuffered().length&&0!==this.videoBuffered().end(0)?Qs({"type":"video","sourceUpdater":this,"action":Hs(e,i),"doneFn":n,"name":"remove"}):n()},i.updating=function updating(){return!(!Ns("audio",this)&&!Ns("video",this))},i.audioTimestampOffset=function audioTimestampOffset(e){return void 0!==e&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Qs({"type":"audio","sourceUpdater":this,"action":Ws(e),"name":"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_},i.videoTimestampOffset=function videoTimestampOffset(e){return void 0!==e&&this.videoBuffer&&this.videoTimestampOffset!==e&&(Qs({"type":"video","sourceUpdater":this,"action":Ws(e),"name":"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_},i.audioQueueCallback=function audioQueueCallback(e){this.audioBuffer&&Qs({"type":"audio","sourceUpdater":this,"action":qs(e),"name":"callback"})},i.videoQueueCallback=function videoQueueCallback(e){this.videoBuffer&&Qs({"type":"video","sourceUpdater":this,"action":qs(e),"name":"callback"})},i.dispose=function dispose(){var e=this;this.trigger("dispose"),Bs.forEach((function(i){e.abort(i),e.canRemoveSourceBuffer()?e.removeSourceBuffer(i):e[i+"QueueCallback"]((function(){return js(i,e)}))})),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},SourceUpdater}(videojs$1.EventTarget),eo=function uint8ToUtf8(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},to=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)}))),io=function(e){function VTTSegmentLoader(i,n){var a;return void 0===n&&(n={}),(a=e.call(this,i,n)||this).handlePartialData_=!1,a.mediaSource_=null,a.subtitlesTrack_=null,a.loaderType_="subtitle",a.featuresNativeTextTracks_=i.featuresNativeTextTracks,a.shouldSaveSegmentTimingInfo_=!1,a}g()(VTTSegmentLoader,e);var i=VTTSegmentLoader.prototype;return i.createTransmuxer_=function createTransmuxer_(){return null},i.buffered_=function buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return videojs$1.createTimeRanges();var e=this.subtitlesTrack_.cues,i=e[0].startTime,n=e[e.length-1].startTime;return videojs$1.createTimeRanges([[i,n]])},i.initSegmentForMap=function initSegmentForMap(e,i){if(void 0===i&&(i=!1),!e)return null;var n=Ea(e),a=this.initSegments_[n];if(i&&!a&&e.bytes){var s=to.byteLength+e.bytes.byteLength,o=new Uint8Array(s);o.set(e.bytes),o.set(to,e.bytes.byteLength),this.initSegments_[n]=a={"resolvedUri":e.resolvedUri,"byterange":e.byterange,"bytes":o}}return a||e},i.couldBeginLoading_=function couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},i.init_=function init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},i.track=function track(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_},i.remove=function remove(e,i){ws(e,i,this.subtitlesTrack_)},i.fillBuffer_=function fillBuffer_(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var i=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(i=this.skipEmptySegments_(i)){if(null===this.syncController_.timestampOffsetForTimeline(i.timeline)){return this.syncController_.one("timestampoffset",(function checkTimestampOffset(){e.state="READY",e.paused()||e.monitorBuffer_()})),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(i)}},i.skipEmptySegments_=function skipEmptySegments_(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e},i.stopForError=function stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")},i.segmentRequestFinished_=function segmentRequestFinished_(e,i,n){var a=this;if(this.subtitlesTrack_){if(this.saveTransferStats_(i.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(e)return e.code===Ya&&this.handleTimeout_(),e.code===Qa?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(e);var o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,i.stats),this.state="APPENDING",this.trigger("appending");var u=o.segment;if(u.map&&(u.map.bytes=i.map.bytes),o.bytes=i.bytes,"function"!=typeof s.a.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var l,c=function errorHandler(){a.subtitlesTrack_.tech_.off("vttjsloaded",l),a.stopForError({"message":"Error loading vtt.js"})};return l=function loadHandler(){a.subtitlesTrack_.tech_.off("vttjserror",c),a.segmentRequestFinished_(e,i,n)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",l),void this.subtitlesTrack_.tech_.one("vttjserror",c)}u.requested=!0;try{this.parseVTTCues_(o)}catch(e){return void this.stopForError({"message":e.message})}if(this.updateTimeMapping_(o,this.syncController_.timelines[o.timeline],this.playlist_),o.cues.length?o.timingInfo={"start":o.cues[0].startTime,"end":o.cues[o.cues.length-1].endTime}:o.timingInfo={"start":o.startOfSegment,"end":o.startOfSegment+o.duration},o.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");o.byteLength=o.bytes.byteLength,this.mediaSecondsLoaded+=u.duration,o.cues.forEach((function(e){a.subtitlesTrack_.addCue(a.featuresNativeTextTracks_?new s.a.VTTCue(e.startTime,e.endTime,e.text):e)})),function removeDuplicateCuesFromTrack(e){var i=e.cues;if(i)for(var n=0;n<i.length;n++){for(var a=[],s=0,o=0;o<i.length;o++)i[n].startTime===i[o].startTime&&i[n].endTime===i[o].endTime&&i[n].text===i[o].text&&++s>1&&a.push(i[o]);a.length&&a.forEach((function(i){return e.removeCue(i)}))}}(this.subtitlesTrack_),this.handleAppendsDone_()}else this.state="READY"},i.handleData_=function handleData_(){},i.updateTimingInfoEnd_=function updateTimingInfoEnd_(){},i.parseVTTCues_=function parseVTTCues_(e){var i,n=!1;"function"==typeof s.a.TextDecoder?i=new s.a.TextDecoder("utf8"):(i=s.a.WebVTT.StringDecoder(),n=!0);var a=new s.a.WebVTT.Parser(s.a,s.a.vttjs,i);if(e.cues=[],e.timestampmap={"MPEGTS":0,"LOCAL":0},a.oncue=e.cues.push.bind(e.cues),a.ontimestampmap=function(i){e.timestampmap=i},a.onparsingerror=function(e){videojs$1.log.warn("Error encountered when parsing cues: "+e.message)},e.segment.map){var o=e.segment.map.bytes;n&&(o=eo(o)),a.parse(o)}var u=e.bytes;n&&(u=eo(u)),a.parse(u),a.flush()},i.updateTimeMapping_=function updateTimeMapping_(e,i,n){var a=e.segment;if(i)if(e.cues.length){var s=e.timestampmap,o=s.MPEGTS/Ne.ONE_SECOND_IN_TS-s.LOCAL+i.mapping;if(e.cues.forEach((function(e){e.startTime+=o,e.endTime+=o})),!n.syncInfo){var u=e.cues[0].startTime,l=e.cues[e.cues.length-1].startTime;n.syncInfo={"mediaSequence":n.mediaSequence+e.mediaIndex,"time":Math.min(u,l-a.duration)}}}else a.empty=!0},VTTSegmentLoader}(Os),no=function findAdCue(e,i){for(var n=e.cues,a=0;a<n.length;a++){var s=n[a];if(i>=s.adStartTime&&i<=s.adEndTime)return s}return null},ro=[{"name":"VOD","run":function run(e,i,n,a,s){if(n!==1/0){return{"time":0,"segmentIndex":0}}return null}},{"name":"ProgramDateTime","run":function run(e,i,n,a,s){if(!e.datetimeToDisplayTime)return null;var o=i.segments||[],u=null,l=null;s=s||0;for(var c=0;c<o.length;c++){var h=o[c];if(h.dateTimeObject){var f=h.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,m=Math.abs(s-f);if(null!==l&&(0===m||l<m))break;l=m,u={"time":f,"segmentIndex":c}}}return u}},{"name":"Segment","run":function run(e,i,n,a,s){var o=i.segments||[],u=null,l=null;s=s||0;for(var c=0;c<o.length;c++){var h=o[c];if(h.timeline===a&&void 0!==h.start){var f=Math.abs(s-h.start);if(null!==l&&l<f)break;(!u||null===l||l>=f)&&(l=f,u={"time":h.start,"segmentIndex":c})}}return u}},{"name":"Discontinuity","run":function run(e,i,n,a,s){var o=null;if(s=s||0,i.discontinuityStarts&&i.discontinuityStarts.length)for(var u=null,l=0;l<i.discontinuityStarts.length;l++){var c=i.discontinuityStarts[l],h=i.discontinuitySequence+l+1,f=e.discontinuities[h];if(f){var m=Math.abs(s-f.time);if(null!==u&&u<m)break;(!o||null===u||u>=m)&&(u=m,o={"time":f.time,"segmentIndex":c})}}return o}},{"name":"Playlist","run":function run(e,i,n,a,s){return i.syncInfo?{"time":i.syncInfo.time,"segmentIndex":i.syncInfo.mediaSequence-i.mediaSequence}:null}}],ao=function(e){function SyncController(i){var n;return(n=e.call(this)||this).timelines=[],n.discontinuities=[],n.datetimeToDisplayTime=null,n.logger_=vs("SyncController"),n}g()(SyncController,e);var i=SyncController.prototype;return i.getSyncPoint=function getSyncPoint(e,i,n,a){var s=this.runStrategies_(e,i,n,a);return s.length?this.selectSyncPoint_(s,{"key":"time","value":a}):null},i.getExpiredTime=function getExpiredTime(e,i){if(!e||!e.segments)return null;var n=this.runStrategies_(e,i,e.discontinuitySequence,0);if(!n.length)return null;var a=this.selectSyncPoint_(n,{"key":"segmentIndex","value":0});return a.segmentIndex>0&&(a.time*=-1),Math.abs(a.time+oa(e,a.segmentIndex,0))},i.runStrategies_=function runStrategies_(e,i,n,a){for(var s=[],o=0;o<ro.length;o++){var u=ro[o],l=u.run(this,e,i,n,a);l&&(l.strategy=u.name,s.push({"strategy":u.name,"syncPoint":l}))}return s},i.selectSyncPoint_=function selectSyncPoint_(e,i){for(var n=e[0].syncPoint,a=Math.abs(e[0].syncPoint[i.key]-i.value),s=e[0].strategy,o=1;o<e.length;o++){var u=Math.abs(e[o].syncPoint[i.key]-i.value);u<a&&(a=u,n=e[o].syncPoint,s=e[o].strategy)}return this.logger_("syncPoint for ["+i.key+": "+i.value+"] chosen with strategy ["+s+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n},i.saveExpiredSegmentInfo=function saveExpiredSegmentInfo(e,i){for(var n=i.mediaSequence-e.mediaSequence-1;n>=0;n--){var a=e.segments[n];if(a&&void 0!==a.start){i.syncInfo={"mediaSequence":e.mediaSequence+n,"time":a.start},this.logger_("playlist refresh sync: [time:"+i.syncInfo.time+", mediaSequence: "+i.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}},i.setDateTimeMapping=function setDateTimeMapping(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var i=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-i}},i.saveSegmentTimingInfo=function saveSegmentTimingInfo(e){var i=e.segmentInfo,n=e.shouldSaveTimelineMapping;this.calculateSegmentTimeMapping_(i,i.timingInfo,n)&&(this.saveDiscontinuitySyncInfo_(i),i.playlist.syncInfo||(i.playlist.syncInfo={"mediaSequence":i.playlist.mediaSequence+i.mediaIndex,"time":i.segment.start}))},i.timestampOffsetForTimeline=function timestampOffsetForTimeline(e){return void 0===this.timelines[e]?null:this.timelines[e].time},i.mappingForTimeline=function mappingForTimeline(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping},i.calculateSegmentTimeMapping_=function calculateSegmentTimeMapping_(e,i,n){var a=e.segment,s=this.timelines[e.timeline];if(null!==e.timestampOffset)s={"time":e.startOfSegment,"mapping":e.startOfSegment-i.start},n&&(this.timelines[e.timeline]=s,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+s.time+"] [mapping: "+s.mapping+"]")),a.start=e.startOfSegment,a.end=i.end+s.mapping;else{if(!s)return!1;a.start=i.start+s.mapping,a.end=i.end+s.mapping}return!0},i.saveDiscontinuitySyncInfo_=function saveDiscontinuitySyncInfo_(e){var i=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={"time":n.start,"accuracy":0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(var a=0;a<i.discontinuityStarts.length;a++){var s=i.discontinuityStarts[a],o=i.discontinuitySequence+a+1,u=s-e.mediaIndex,l=Math.abs(u);if(!this.discontinuities[o]||this.discontinuities[o].accuracy>l){var c=void 0;c=u<0?n.start-oa(i,e.mediaIndex,s):n.end+oa(i,e.mediaIndex+1,s),this.discontinuities[o]={"time":c,"accuracy":l}}}},i.dispose=function dispose(){this.trigger("dispose"),this.off()},SyncController}(videojs$1.EventTarget),so=function(e){function TimelineChangeController(){var i;return(i=e.call(this)||this).pendingTimelineChanges_={},i.lastTimelineChanges_={},i}g()(TimelineChangeController,e);var i=TimelineChangeController.prototype;return i.clearPendingTimelineChange=function clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")},i.pendingTimelineChange=function pendingTimelineChange(e){var i=e.type,n=e.from,a=e.to;return"number"==typeof n&&"number"==typeof a&&(this.pendingTimelineChanges_[i]={"type":i,"from":n,"to":a},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[i]},i.lastTimelineChange=function lastTimelineChange(e){var i=e.type,n=e.from,a=e.to;return"number"==typeof n&&"number"==typeof a&&(this.lastTimelineChanges_[i]={"type":i,"from":n,"to":a},delete this.pendingTimelineChanges_[i],this.trigger("timelinechange")),this.lastTimelineChanges_[i]},i.dispose=function dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},TimelineChangeController}(videojs$1.EventTarget),oo=new shimWorker("./decrypter-worker.worker.js",(function(e,i){var n=this;!function(){function _defineProperties(e,i){for(var n=0;n<i.length;n++){var a=i[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var e=function _createClass(e,i,n){return i&&_defineProperties(e.prototype,i),n&&_defineProperties(e,n),e};var i=function _inheritsLoose(e,i){e.prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i},a=function(){function Stream(){this.listeners={}}var e=Stream.prototype;return e.on=function on(e,i){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(i)},e.off=function off(e,i){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(i);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(n,1),n>-1},e.trigger=function trigger(e){var i=this.listeners[e];if(i)if(2===arguments.length)for(var n=i.length,a=0;a<n;++a)i[a].call(this,arguments[1]);else for(var s=Array.prototype.slice.call(arguments,1),o=i.length,u=0;u<o;++u)i[u].apply(this,s)},e.dispose=function dispose(){this.listeners={}},e.pipe=function pipe(e){this.on("data",(function(i){e.push(i)}))},Stream}();var s=null,o=function(){function AES(e){var i,n,a;s||(s=function precompute(){var e,i,n,a,s,o,u,l,c=[[[],[],[],[],[]],[[],[],[],[],[]]],h=c[0],f=c[1],m=h[4],g=f[4],v=[],y=[];for(e=0;e<256;e++)y[(v[e]=e<<1^283*(e>>7))^e]=e;for(i=n=0;!m[i];i^=a||1,n=y[n]||1)for(o=(o=n^n<<1^n<<2^n<<3^n<<4)>>8^255&o^99,m[i]=o,g[o]=i,l=16843009*v[s=v[a=v[i]]]^65537*s^257*a^16843008*i,u=257*v[o]^16843008*o,e=0;e<4;e++)h[e][i]=u=u<<24^u>>>8,f[e][o]=l=l<<24^l>>>8;for(e=0;e<5;e++)h[e]=h[e].slice(0),f[e]=f[e].slice(0);return c}()),this._tables=[[s[0][0].slice(),s[0][1].slice(),s[0][2].slice(),s[0][3].slice(),s[0][4].slice()],[s[1][0].slice(),s[1][1].slice(),s[1][2].slice(),s[1][3].slice(),s[1][4].slice()]];var o=this._tables[0][4],u=this._tables[1],l=e.length,c=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size");var h=e.slice(0),f=[];for(this._key=[h,f],i=l;i<4*l+28;i++)a=h[i-1],(i%l==0||8===l&&i%l==4)&&(a=o[a>>>24]<<24^o[a>>16&255]<<16^o[a>>8&255]<<8^o[255&a],i%l==0&&(a=a<<8^a>>>24^c<<24,c=c<<1^283*(c>>7))),h[i]=h[i-l]^a;for(n=0;i;n++,i--)a=h[3&n?i:i-4],f[n]=i<=4||n<4?a:u[0][o[a>>>24]]^u[1][o[a>>16&255]]^u[2][o[a>>8&255]]^u[3][o[255&a]]}return AES.prototype.decrypt=function decrypt(e,i,n,a,s,o){var u,l,c,h,f=this._key[1],m=e^f[0],g=a^f[1],v=n^f[2],y=i^f[3],_=f.length/4-2,T=4,b=this._tables[1],S=b[0],C=b[1],k=b[2],E=b[3],w=b[4];for(h=0;h<_;h++)u=S[m>>>24]^C[g>>16&255]^k[v>>8&255]^E[255&y]^f[T],l=S[g>>>24]^C[v>>16&255]^k[y>>8&255]^E[255&m]^f[T+1],c=S[v>>>24]^C[y>>16&255]^k[m>>8&255]^E[255&g]^f[T+2],y=S[y>>>24]^C[m>>16&255]^k[g>>8&255]^E[255&v]^f[T+3],T+=4,m=u,g=l,v=c;for(h=0;h<4;h++)s[(3&-h)+o]=w[m>>>24]<<24^w[g>>16&255]<<16^w[v>>8&255]<<8^w[255&y]^f[T++],u=m,m=g,g=v,v=y,y=u},AES}(),u=function(e){function AsyncStream(){var i;return(i=e.call(this,a)||this).jobs=[],i.delay=1,i.timeout_=null,i}i(AsyncStream,e);var n=AsyncStream.prototype;return n.processJob_=function processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},n.push=function push(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},AsyncStream}(a),l=function ntoh(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},c=function(){function Decrypter(e,i,n,a){var s=Decrypter.STEP,o=new Int32Array(e.buffer),c=new Uint8Array(e.byteLength),h=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(o.subarray(h,h+s),i,n,c)),h=s;h<o.length;h+=s)n=new Uint32Array([l(o[h-4]),l(o[h-3]),l(o[h-2]),l(o[h-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(h,h+s),i,n,c));this.asyncStream_.push((function(){a(null,function unpad(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}(c))}))}return Decrypter.prototype.decryptChunk_=function decryptChunk_(e,i,n,a){return function(){var s=function decrypt(e,i,n){var a,s,u,c,h,f,m,g,v,y=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),_=new o(Array.prototype.slice.call(i)),T=new Uint8Array(e.byteLength),b=new Int32Array(T.buffer);for(a=n[0],s=n[1],u=n[2],c=n[3],v=0;v<y.length;v+=4)h=l(y[v]),f=l(y[v+1]),m=l(y[v+2]),g=l(y[v+3]),_.decrypt(h,f,m,g,b,v),b[v]=l(b[v]^a),b[v+1]=l(b[v+1]^s),b[v+2]=l(b[v+2]^u),b[v+3]=l(b[v+3]^c),a=h,s=f,u=m,c=g;return T}(e,i,n);a.set(s,e.byteOffset)}},e(Decrypter,null,[{"key":"STEP","get":function get(){return 32e3}}]),Decrypter}();new function DecrypterWorker(e){e.onmessage=function(i){var n=i.data,a=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),s=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),o=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new c(a,s,o,(function(i,a){e.postMessage(function createTransferableMessage(e){var i={};return Object.keys(e).forEach((function(n){var a=e[n];ArrayBuffer.isView(a)?i[n]={"bytes":a.buffer,"byteOffset":a.byteOffset,"byteLength":a.byteLength}:i[n]=a})),i}({"source":n.source,"decrypted":a}),[a.buffer])}))}}(n)}()})),uo=function audioTrackKind_(e){var i=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(i="main-desc"),i},lo=function stopLoaders(e,i){e.abort(),e.pause(),i&&i.activePlaylistLoader&&(i.activePlaylistLoader.pause(),i.activePlaylistLoader=null)},co=function startLoaders(e,i){i.activePlaylistLoader=e,e.load()},ho={"AUDIO":function AUDIO(e,i){return function(){var n=i.segmentLoaders[e],a=i.mediaTypes[e],s=i.blacklistCurrentPlaylist;lo(n,a);var o=a.activeTrack(),u=a.activeGroup(),l=(u.filter((function(e){return e.default}))[0]||u[0]).id,c=a.tracks[l];if(o!==c){for(var h in videojs$1.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),a.tracks)a.tracks[h].enabled=a.tracks[h]===c;a.onTrackChanged()}else s({"message":"Problem encountered loading the default audio track."})}},"SUBTITLES":function SUBTITLES(e,i){return function(){var n=i.segmentLoaders[e],a=i.mediaTypes[e];videojs$1.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),lo(n,a);var s=a.activeTrack();s&&(s.mode="disabled"),a.onTrackChanged()}}},po={"AUDIO":function AUDIO(e,i,n){if(i){var a=n.tech,s=n.requestOptions,o=n.segmentLoaders[e];i.on("loadedmetadata",(function(){var e=i.media();o.playlist(e,s),(!a.paused()||e.endList&&"none"!==a.preload())&&o.load()})),i.on("loadedplaylist",(function(){o.playlist(i.media(),s),a.paused()||o.load()})),i.on("error",ho[e](e,n))}},"SUBTITLES":function SUBTITLES(e,i,n){var a=n.tech,s=n.requestOptions,o=n.segmentLoaders[e],u=n.mediaTypes[e];i.on("loadedmetadata",(function(){var e=i.media();o.playlist(e,s),o.track(u.activeTrack()),(!a.paused()||e.endList&&"none"!==a.preload())&&o.load()})),i.on("loadedplaylist",(function(){o.playlist(i.media(),s),a.paused()||o.load()})),i.on("error",ho[e](e,n))}},fo={"AUDIO":function AUDIO(e,i){var n=i.vhs,a=i.sourceType,s=i.segmentLoaders[e],o=i.requestOptions,u=i.master,l=u.mediaGroups,c=u.playlists,h=i.mediaTypes[e],f=h.groups,m=h.tracks,g=i.masterPlaylistLoader;l[e]&&0!==Object.keys(l[e]).length||(l[e]={"main":{"default":{"default":!0}}});var v=function _loop(s){f[s]||(f[s]=[]);var u=c.filter((function(i){return i.attributes[e]===s})),h=function _loop2(c){var h=l[e][s][c];!u.filter((function(e){return e.resolvedUri!==h.resolvedUri})).length&&u.length&&delete h.resolvedUri;var v=void 0;if(v="vhs-json"===a&&h.playlists?new Jr(h.playlists[0],n,o):h.resolvedUri?new Jr(h.resolvedUri,n,o):h.playlists&&"dash"===a?new Na(h.playlists[0],n,o,g):null,h=videojs$1.mergeOptions({"id":c,"playlistLoader":v},h),po[e](e,h.playlistLoader,i),f[s].push(h),void 0===m[c]){var y=new videojs$1.AudioTrack({"id":c,"kind":uo(h),"enabled":!1,"language":h.language,"default":h.default,"label":c});m[c]=y}};for(var v in l[e][s])h(v)};for(var y in l[e])v(y);s.on("error",ho[e](e,i))},"SUBTITLES":function SUBTITLES(e,i){var n=i.tech,a=i.vhs,s=i.sourceType,o=i.segmentLoaders[e],u=i.requestOptions,l=i.master.mediaGroups,c=i.mediaTypes[e],h=c.groups,f=c.tracks,m=i.masterPlaylistLoader;for(var g in l[e])for(var v in h[g]||(h[g]=[]),l[e][g])if(!l[e][g][v].forced){var y=l[e][g][v],_=void 0;if("hls"===s)_=new Jr(y.resolvedUri,a,u);else if("dash"===s){if(!y.playlists.filter((function(e){return e.excludeUntil!==1/0})).length)return;_=new Na(y.playlists[0],a,u,m)}else"vhs-json"===s&&(_=new Jr(y.playlists?y.playlists[0]:y.resolvedUri,a,u));if(y=videojs$1.mergeOptions({"id":v,"playlistLoader":_},y),po[e](e,y.playlistLoader,i),h[g].push(y),void 0===f[v]){var T=n.addRemoteTextTrack({"id":v,"kind":"subtitles","default":y.default&&y.autoselect,"language":y.language,"label":v},!1).track;f[v]=T}}o.on("error",ho[e](e,i))},"CLOSED-CAPTIONS":function CLOSEDCAPTIONS(e,i){var n=i.tech,a=i.master.mediaGroups,s=i.mediaTypes[e],o=s.groups,u=s.tracks;for(var l in a[e])for(var c in o[l]||(o[l]=[]),a[e][l]){var h=a[e][l][c];if(h.instreamId.match(/CC\d/)&&(o[l].push(videojs$1.mergeOptions({"id":c},h)),void 0===u[c])){var f=n.addRemoteTextTrack({"id":h.instreamId,"kind":"captions","default":h.default&&h.autoselect,"language":h.language,"label":c},!1).track;u[c]=f}}}},mo={"AUDIO":function AUDIO(e,i){return function(){var n=i.mediaTypes[e].tracks;for(var a in n)if(n[a].enabled)return n[a];return null}},"SUBTITLES":function SUBTITLES(e,i){return function(){var n=i.mediaTypes[e].tracks;for(var a in n)if("showing"===n[a].mode||"hidden"===n[a].mode)return n[a];return null}}},go=function setupMediaGroups(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(i){fo[i](i,e)}));var i=e.mediaTypes,n=e.masterPlaylistLoader,a=e.tech,s=e.vhs;["AUDIO","SUBTITLES"].forEach((function(n){i[n].activeGroup=function activeGroup(e,i){return function(n){var a=i.masterPlaylistLoader,s=i.mediaTypes[e].groups,o=a.media();if(!o)return null;var u=null;return o.attributes[e]&&(u=s[o.attributes[e]]),u=u||s.main,void 0===n?u:null===n?null:u.filter((function(e){return e.id===n.id}))[0]||null}}(n,e),i[n].activeTrack=mo[n](n,e),i[n].onGroupChanged=function onGroupChanged(e,i){return function(){var n=i.segmentLoaders,a=n[e],s=n.main,o=i.mediaTypes[e],u=o.activeTrack(),l=o.activeGroup(u),c=o.activePlaylistLoader;lo(a,o),l&&(l.playlistLoader?(a.resyncLoader(),co(l.playlistLoader,o)):c&&s.resetEverything())}}(n,e),i[n].onGroupChanging=function onGroupChanging(e,i){return function(){var n=i.segmentLoaders[e];n.abort(),n.pause()}}(n,e),i[n].onTrackChanged=function onTrackChanged(e,i){return function(){var n=i.segmentLoaders,a=n[e],s=n.main,o=i.mediaTypes[e],u=o.activeTrack(),l=o.activeGroup(u),c=o.activePlaylistLoader;if(lo(a,o),l){if("AUDIO"===e){if(!l.playlistLoader)return s.setAudio(!0),void s.resetEverything();a.setAudio(!0),s.setAudio(!1)}c!==l.playlistLoader?(a.track&&a.track(u),a.resetEverything(),co(l.playlistLoader,o)):co(l.playlistLoader,o)}}}(n,e)}));var o=i.AUDIO.activeGroup();if(o){var u=(o.filter((function(e){return e.default}))[0]||o[0]).id;i.AUDIO.tracks[u].enabled=!0,i.AUDIO.onTrackChanged()}n.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return i[e].onGroupChanged()}))})),n.on("mediachanging",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return i[e].onGroupChanging()}))}));var l=function onAudioTrackChanged(){i.AUDIO.onTrackChanged(),a.trigger({"type":"usage","name":"vhs-audio-change"}),a.trigger({"type":"usage","name":"hls-audio-change"})};for(var c in a.audioTracks().addEventListener("change",l),a.remoteTextTracks().addEventListener("change",i.SUBTITLES.onTrackChanged),s.on("dispose",(function(){a.audioTracks().removeEventListener("change",l),a.remoteTextTracks().removeEventListener("change",i.SUBTITLES.onTrackChanged)})),a.clearTracks("audio"),i.AUDIO.tracks)a.audioTracks().addTrack(i.AUDIO.tracks[c])},vo=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],yo=function sumLoaderStat(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},_o=function(e){function MasterPlaylistController(i){var n;n=e.call(this)||this;var a=i.src,o=i.handleManifestRedirects,u=i.withCredentials,l=i.tech,c=i.bandwidth,h=i.externVhs,m=i.useCueTags,g=i.blacklistDuration,v=i.enableLowInitialPlaylist,y=i.sourceType,_=i.cacheEncryptionKeys,T=i.handlePartialData,b=i.experimentalBufferBasedABR;if(!a)throw new Error("A non-empty playlist URL or JSON manifest string is required");Ms=h,n.experimentalBufferBasedABR=Boolean(b),n.withCredentials=u,n.tech_=l,n.vhs_=l.vhs,n.sourceType_=y,n.useCueTags_=m,n.blacklistDuration=g,n.enableLowInitialPlaylist=v,n.useCueTags_&&(n.cueTagsTrack_=n.tech_.addTextTrack("metadata","ad-cues"),n.cueTagsTrack_.inBandMetadataTrackDispatchType=""),n.requestOptions_={"withCredentials":u,"handleManifestRedirects":o,"timeout":null},n.on("error",n.pauseLoading),n.mediaTypes_=function createMediaTypes(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(i){e[i]={"groups":{},"tracks":{},"activePlaylistLoader":null,"activeGroup":video_es_noop,"activeTrack":video_es_noop,"onGroupChanged":video_es_noop,"onTrackChanged":video_es_noop}})),e}(),n.mediaSource=new s.a.MediaSource,n.handleDurationChange_=n.handleDurationChange_.bind(f()(n)),n.handleSourceOpen_=n.handleSourceOpen_.bind(f()(n)),n.handleSourceEnded_=n.handleSourceEnded_.bind(f()(n)),n.mediaSource.addEventListener("durationchange",n.handleDurationChange_),n.mediaSource.addEventListener("sourceopen",n.handleSourceOpen_),n.mediaSource.addEventListener("sourceended",n.handleSourceEnded_),n.seekable_=videojs$1.createTimeRanges(),n.hasPlayed_=!1,n.syncController_=new ao(i),n.segmentMetadataTrack_=l.addRemoteTextTrack({"kind":"metadata","label":"segment-metadata"},!1).track,n.decrypter_=new oo,n.sourceUpdater_=new Zs(n.mediaSource),n.inbandTextTracks_={},n.timelineChangeController_=new so;var S={"vhs":n.vhs_,"mediaSource":n.mediaSource,"currentTime":n.tech_.currentTime.bind(n.tech_),"seekable":function seekable(){return n.seekable()},"seeking":function seeking(){return n.tech_.seeking()},"duration":function duration(){return n.duration()},"hasPlayed":function hasPlayed(){return n.hasPlayed_},"goalBufferLength":function goalBufferLength(){return n.goalBufferLength()},"bandwidth":c,"syncController":n.syncController_,"decrypter":n.decrypter_,"sourceType":n.sourceType_,"inbandTextTracks":n.inbandTextTracks_,"cacheEncryptionKeys":_,"handlePartialData":T,"sourceUpdater":n.sourceUpdater_,"timelineChangeController":n.timelineChangeController_};return n.masterPlaylistLoader_="dash"===n.sourceType_?new Na(a,n.vhs_,n.requestOptions_):new Jr(a,n.vhs_,n.requestOptions_),n.setupMasterPlaylistLoaderListeners_(),n.mainSegmentLoader_=new Os(videojs$1.mergeOptions(S,{"segmentMetadataTrack":n.segmentMetadataTrack_,"loaderType":"main"}),i),n.audioSegmentLoader_=new Os(videojs$1.mergeOptions(S,{"loaderType":"audio"}),i),n.subtitleSegmentLoader_=new io(videojs$1.mergeOptions(S,{"loaderType":"vtt","featuresNativeTextTracks":n.tech_.featuresNativeTextTracks}),i),n.setupSegmentLoaderListeners_(),n.experimentalBufferBasedABR&&(n.masterPlaylistLoader_.one("loadedplaylist",(function(){return n.startABRTimer_()})),n.tech_.on("pause",(function(){return n.stopABRTimer_()})),n.tech_.on("play",(function(){return n.startABRTimer_()}))),vo.forEach((function(e){n[e+"_"]=yo.bind(f()(n),e)})),n.logger_=vs("MPC"),n.triggeredFmp4Usage=!1,n.masterPlaylistLoader_.load(),n}g()(MasterPlaylistController,e);var i=MasterPlaylistController.prototype;return i.checkABR_=function checkABR_(){var e=this.selectPlaylist();this.shouldSwitchToMedia_(e)&&this.masterPlaylistLoader_.media(e)},i.startABRTimer_=function startABRTimer_(){var e=this;this.stopABRTimer_(),this.abrTimer_=s.a.setInterval((function(){return e.checkABR_()}),250)},i.stopABRTimer_=function stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(s.a.clearInterval(this.abrTimer_),this.abrTimer_=null)},i.setupMasterPlaylistLoaderListeners_=function setupMasterPlaylistLoaderListeners_(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var i=e.masterPlaylistLoader_.media(),n=1.5*i.targetDuration*1e3;fa(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,i.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(i,e.requestOptions_),e.mainSegmentLoader_.load()),go({"sourceType":e.sourceType_,"segmentLoaders":{"AUDIO":e.audioSegmentLoader_,"SUBTITLES":e.subtitleSegmentLoader_,"main":e.mainSegmentLoader_},"tech":e.tech_,"requestOptions":e.requestOptions_,"masterPlaylistLoader":e.masterPlaylistLoader_,"vhs":e.vhs_,"master":e.master(),"mediaTypes":e.mediaTypes_,"blacklistCurrentPlaylist":e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),i),e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){e.trigger("selectedinitialmedia")}))})),this.masterPlaylistLoader_.on("loadedplaylist",(function(){var i=e.masterPlaylistLoader_.media();if(!i){var n;if(e.excludeUnsupportedVariants_(),e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),!n||!e.shouldSwitchToMedia_(n))return;if(e.initialMedia_=n,e.masterPlaylistLoader_.media(e.initialMedia_),!("vhs-json"===e.sourceType_&&e.initialMedia_.segments))return;i=e.initialMedia_}e.handleUpdatedMediaPlaylist(i)})),this.masterPlaylistLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)})),this.masterPlaylistLoader_.on("mediachanging",(function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()})),this.masterPlaylistLoader_.on("mediachange",(function(){var i=e.masterPlaylistLoader_.media(),n=1.5*i.targetDuration*1e3;fa(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(i,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({"type":"mediachange","bubbles":!0})})),this.masterPlaylistLoader_.on("playlistunchanged",(function(){var i=e.masterPlaylistLoader_.media();e.stuckAtPlaylistEnd_(i)&&(e.blacklistCurrentPlaylist({"message":"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))})),this.masterPlaylistLoader_.on("renditiondisabled",(function(){e.tech_.trigger({"type":"usage","name":"vhs-rendition-disabled"}),e.tech_.trigger({"type":"usage","name":"hls-rendition-disabled"})})),this.masterPlaylistLoader_.on("renditionenabled",(function(){e.tech_.trigger({"type":"usage","name":"vhs-rendition-enabled"}),e.tech_.trigger({"type":"usage","name":"hls-rendition-enabled"})}))},i.handleUpdatedMediaPlaylist=function handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},i.triggerPresenceUsage_=function triggerPresenceUsage_(e,i){var n=e.mediaGroups||{},a=!0,s=Object.keys(n.AUDIO);for(var o in n.AUDIO)for(var u in n.AUDIO[o]){n.AUDIO[o][u].uri||(a=!1)}a&&(this.tech_.trigger({"type":"usage","name":"vhs-demuxed"}),this.tech_.trigger({"type":"usage","name":"hls-demuxed"})),Object.keys(n.SUBTITLES).length&&(this.tech_.trigger({"type":"usage","name":"vhs-webvtt"}),this.tech_.trigger({"type":"usage","name":"hls-webvtt"})),Ms.Playlist.isAes(i)&&(this.tech_.trigger({"type":"usage","name":"vhs-aes"}),this.tech_.trigger({"type":"usage","name":"hls-aes"})),s.length&&Object.keys(n.AUDIO[s[0]]).length>1&&(this.tech_.trigger({"type":"usage","name":"vhs-alternate-audio"}),this.tech_.trigger({"type":"usage","name":"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({"type":"usage","name":"vhs-playlist-cue-tags"}),this.tech_.trigger({"type":"usage","name":"hls-playlist-cue-tags"}))},i.shouldSwitchToMedia_=function shouldSwitchToMedia_(e){var i=this.masterPlaylistLoader_.media(),n=this.tech_.buffered();return function shouldSwitchToMedia(e){var i=e.currentPlaylist,n=e.nextPlaylist,a=e.forwardBuffer,s=e.bufferLowWaterLine,o=e.bufferHighWaterLine,u=e.duration,l=e.experimentalBufferBasedABR,c=e.log;if(!n)return videojs$1.log.warn("We received no playlist to switch to. Please check your stream."),!1;var h="allowing switch "+(i&&i.id||"null")+" -> "+n.id;if(!i||!i.endList)return c(h+" as current playlist "+(i?"is live":"is not set")),!0;if(n.id===i.id)return!1;var f=l?Ua.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Ua.MAX_BUFFER_LOW_WATER_LINE;if(u<f)return c(h+" as duration < max low water line ("+u+" < "+f+")"),!0;var m=n.attributes.BANDWIDTH,g=i.attributes.BANDWIDTH;if(m<g&&(!l||a<o)){var v=h+" as next bandwidth < current bandwidth ("+m+" < "+g+")";return l&&(v+=" and forwardBuffer < bufferHighWaterLine ("+a+" < "+o+")"),c(v),!0}if((!l||m>g)&&a>=s){var y=h+" as forwardBuffer >= bufferLowWaterLine ("+a+" >= "+s+")";return l&&(y+=" and next bandwidth > current bandwidth ("+m+" > "+g+")"),c(y),!0}return c("not "+h+" as no switching criteria met"),!1}({"currentPlaylist":i,"nextPlaylist":e,"forwardBuffer":n.length?n.end(n.length-1)-this.tech_.currentTime():0,"bufferLowWaterLine":this.bufferLowWaterLine(),"bufferHighWaterLine":this.bufferHighWaterLine(),"duration":this.duration(),"experimentalBufferBasedABR":this.experimentalBufferBasedABR,"log":this.logger_})},i.setupSegmentLoaderListeners_=function setupSegmentLoaderListeners_(){var e=this;this.experimentalBufferBasedABR||(this.mainSegmentLoader_.on("bandwidthupdate",(function(){var i=e.selectPlaylist();e.shouldSwitchToMedia_(i)&&e.masterPlaylistLoader_.media(i),e.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("progress",(function(){e.trigger("progress")}))),this.mainSegmentLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())})),this.mainSegmentLoader_.on("appenderror",(function(){e.error=e.mainSegmentLoader_.error_,e.trigger("error")})),this.mainSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(function(){e.tech_.trigger({"type":"usage","name":"vhs-timestamp-offset"}),e.tech_.trigger({"type":"usage","name":"hls-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.audioSegmentLoader_.on("appenderror",(function(){e.error=e.audioSegmentLoader_.error_,e.trigger("error")})),this.mainSegmentLoader_.on("ended",(function(){e.logger_("main segment loader ended"),e.onEndOfStream()})),this.mainSegmentLoader_.on("earlyabort",(function(i){e.experimentalBufferBasedABR||(e.delegateLoaders_("all",["abort"]),e.blacklistCurrentPlaylist({"message":"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120))}));var i=function updateCodecs(){if(!e.sourceUpdater_.hasCreatedSourceBuffers())return e.tryToCreateSourceBuffers_();var i=e.getCodecsOrExclude_();i&&e.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",i),this.audioSegmentLoader_.on("trackinfo",i),this.mainSegmentLoader_.on("fmp4",(function(){e.triggeredFmp4Usage||(e.tech_.trigger({"type":"usage","name":"vhs-fmp4"}),e.tech_.trigger({"type":"usage","name":"hls-fmp4"}),e.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("fmp4",(function(){e.triggeredFmp4Usage||(e.tech_.trigger({"type":"usage","name":"vhs-fmp4"}),e.tech_.trigger({"type":"usage","name":"hls-fmp4"}),e.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("ended",(function(){e.logger_("audioSegmentLoader ended"),e.onEndOfStream()}))},i.mediaSecondsLoaded_=function mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},i.load=function load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},i.smoothQualityChange_=function smoothQualityChange_(e){void 0===e&&(e=this.selectPlaylist()),e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())},i.fastQualityChange_=function fastQualityChange_(e){var i=this;void 0===e&&(e=this.selectPlaylist()),e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetEverything((function(){videojs$1.browser.IE_VERSION||videojs$1.browser.IS_EDGE?i.tech_.setCurrentTime(i.tech_.currentTime()+.04):i.tech_.setCurrentTime(i.tech_.currentTime())})))},i.play=function play(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}},i.setupFirstPlay=function setupFirstPlay(){var e=this,i=this.masterPlaylistLoader_.media();if(!i||this.tech_.paused()||this.hasPlayed_)return!1;if(!i.endList){var n=this.seekable();if(!n.length)return!1;if(videojs$1.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",(function(){e.trigger("firstplay"),e.tech_.setCurrentTime(n.end(0)),e.hasPlayed_=!0})),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(n.end(0))}return this.hasPlayed_=!0,this.load(),!0},i.handleSourceOpen_=function handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,(function(e){}))}this.trigger("sourceopen")},i.handleSourceEnded_=function handleSourceEnded_(){if(this.inbandTextTracks_.metadataTrack_){var e=this.inbandTextTracks_.metadataTrack_.cues;if(e&&e.length){var i=this.duration();e[e.length-1].endTime=isNaN(i)||Math.abs(i)===1/0?Number.MAX_VALUE:i}}},i.handleDurationChange_=function handleDurationChange_(){this.tech_.trigger("durationchange")},i.onEndOfStream=function onEndOfStream(){var e=this.mainSegmentLoader_.ended_;this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.currentMediaInfo_||this.mainSegmentLoader_.currentMediaInfo_.hasVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},i.stuckAtPlaylistEnd_=function stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;var i=this.syncController_.getExpiredTime(e,this.duration());if(null===i)return!1;var n=Ms.Playlist.playlistEnd(e,i),a=this.tech_.currentTime(),s=this.tech_.buffered();if(!s.length)return n-a<=.1;var o=s.end(s.length-1);return o-a<=.1&&n-o<=.1},i.blacklistCurrentPlaylist=function blacklistCurrentPlaylist(e,i){void 0===e&&(e={});var n=e.playlist||this.masterPlaylistLoader_.media();if(i=i||e.blacklistDuration||this.blacklistDuration,!n)return this.error=e,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));var a=this.masterPlaylistLoader_.master.playlists,s=a.filter(ha),o=1===s.length&&s[0]===n;if(1===a.length&&i!==1/0)return videojs$1.log.warn("Problem encountered with playlist "+n.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(o);if(o){var u=!1;a.forEach((function(e){if(e!==n){var i=e.excludeUntil;void 0!==i&&i!==1/0&&(u=!0,delete e.excludeUntil)}})),u&&(videojs$1.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}n.excludeUntil=Date.now()+1e3*i,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({"type":"usage","name":"vhs-rendition-blacklisted"}),this.tech_.trigger({"type":"usage","name":"hls-rendition-blacklisted"});var l=this.selectPlaylist();if(!l)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");var c=e.internal?this.logger_:videojs$1.log.warn,h=e.message?" "+e.message:"";c((e.internal?"Internal problem":"Problem")+" encountered with playlist "+n.id+"."+h+" Switching to playlist "+l.id+"."),l.attributes.AUDIO!==n.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),l.attributes.SUBTITLES!==n.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var f=l.targetDuration/2*1e3||5e3,m="number"==typeof l.lastRequest&&Date.now()-l.lastRequest<=f;return this.masterPlaylistLoader_.media(l,o||m)},i.pauseLoading=function pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()},i.delegateLoaders_=function delegateLoaders_(e,i){var n=this,a=[],s="all"===e;(s||"main"===e)&&a.push(this.masterPlaylistLoader_);var o=[];(s||"audio"===e)&&o.push("AUDIO"),(s||"subtitle"===e)&&(o.push("CLOSED-CAPTIONS"),o.push("SUBTITLES")),o.forEach((function(e){var i=n.mediaTypes_[e]&&n.mediaTypes_[e].activePlaylistLoader;i&&a.push(i)})),["main","audio","subtitle"].forEach((function(i){var s=n[i+"SegmentLoader_"];!s||e!==i&&"all"!==e||a.push(s)})),a.forEach((function(e){return i.forEach((function(i){"function"==typeof e[i]&&e[i]()}))}))},i.setCurrentTime=function setCurrentTime(e){var i=ea(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?i&&i.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0},i.duration=function duration(){if(!this.masterPlaylistLoader_)return 0;var e=this.masterPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Ms.Playlist.duration(e):1/0:0},i.seekable=function seekable(){return this.seekable_},i.onSyncInfoUpdate_=function onSyncInfoUpdate_(){var e;if(this.masterPlaylistLoader_){var i=this.masterPlaylistLoader_.media();if(i){var n=this.syncController_.getExpiredTime(i,this.duration());if(null!==n){var a=this.masterPlaylistLoader_.master.suggestedPresentationDelay,s=Ms.Playlist.seekable(i,n,a);if(0!==s.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(n=this.syncController_.getExpiredTime(i,this.duration())))return;if(0===(e=Ms.Playlist.seekable(i,n,a)).length)return}var o,u;this.seekable_&&this.seekable_.length&&(o=this.seekable_.end(0),u=this.seekable_.start(0)),e?e.start(0)>s.end(0)||s.start(0)>e.end(0)?this.seekable_=s:this.seekable_=videojs$1.createTimeRanges([[e.start(0)>s.start(0)?e.start(0):s.start(0),e.end(0)<s.end(0)?e.end(0):s.end(0)]]):this.seekable_=s,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===o&&this.seekable_.start(0)===u||(this.logger_("seekable updated ["+ia(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},i.updateDuration=function updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,e),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(e){var i=this.seekable();if(!i.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<i.end(i.length-1))&&this.sourceUpdater_.setDuration(i.end(i.length-1))}else{var n=this.tech_.buffered(),a=Ms.Playlist.duration(this.masterPlaylistLoader_.media());n.length>0&&(a=Math.max(a,n.end(n.length-1))),this.mediaSource.duration!==a&&this.sourceUpdater_.setDuration(a)}},i.dispose=function dispose(){var e=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach((function(i){var n=e.mediaTypes_[i].groups;for(var a in n)n[a].forEach((function(e){e.playlistLoader&&e.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},i.master=function master(){return this.masterPlaylistLoader_.master},i.media=function media(){return this.masterPlaylistLoader_.media()||this.initialMedia_},i.areMediaTypesKnown_=function areMediaTypesKnown_(){var e=!!this.mediaTypes_.AUDIO.activePlaylistLoader;return!(!this.mainSegmentLoader_.currentMediaInfo_||e&&!this.audioSegmentLoader_.currentMediaInfo_)},i.getCodecsOrExclude_=function getCodecsOrExclude_(){var e=this,i={"main":this.mainSegmentLoader_.currentMediaInfo_||{},"audio":this.audioSegmentLoader_.currentMediaInfo_||{}};i.video=i.main;var n=gs(this.master(),this.media()),a={},s=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(i.main.hasVideo&&(a.video=n.video||i.main.videoCodec||Fe.DEFAULT_VIDEO_CODEC),i.main.isMuxed&&(a.video+=","+(n.audio||i.main.audioCodec||Fe.DEFAULT_AUDIO_CODEC)),(i.main.hasAudio&&!i.main.isMuxed||i.audio.hasAudio||s)&&(a.audio=n.audio||i.main.audioCodec||i.audio.audioCodec||Fe.DEFAULT_AUDIO_CODEC,i.audio.isFmp4=i.main.hasAudio&&!i.main.isMuxed?i.main.isFmp4:i.audio.isFmp4),a.audio||a.video){var o,u={};if(["video","audio"].forEach((function(e){if(a.hasOwnProperty(e)&&!function supportFunction(e,i){return e?Object(Fe.browserSupportsCodec)(i):Object(Fe.muxerSupportsCodec)(i)}(i[e].isFmp4,a[e])){var n=i[e].isFmp4?"browser":"muxer";u[n]=u[n]||[],u[n].push(a[e]),"audio"===e&&(o=n)}})),s&&o&&this.media().attributes.AUDIO){var l=this.media().attributes.AUDIO;this.master().playlists.forEach((function(i){(i.attributes&&i.attributes.AUDIO)===l&&i!==e.media()&&(i.excludeUntil=1/0)})),this.logger_("excluding audio group "+l+" as "+o+' does not support codec(s): "'+a.audio+'"')}if(!Object.keys(u).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var c=[];if(["video","audio"].forEach((function(i){var n=(Object(Fe.parseCodecs)(e.sourceUpdater_.codecs[i]||"")[i]||{}).type,s=(Object(Fe.parseCodecs)(a[i]||"")[i]||{}).type;n&&s&&n.toLowerCase()!==s.toLowerCase()&&c.push('"'+e.sourceUpdater_.codecs[i]+'" -> "'+a[i]+'"')})),c.length)return void this.blacklistCurrentPlaylist({"playlist":this.media(),"message":"Codec switching not supported: "+c.join(", ")+".","blacklistDuration":1/0,"internal":!0})}return a}var h=Object.keys(u).reduce((function(e,i){return e&&(e+=", "),e+=i+' does not support codec(s): "'+u[i].join(",")+'"'}),"")+".";this.blacklistCurrentPlaylist({"playlist":this.media(),"internal":!0,"message":h,"blacklistDuration":1/0})}else this.blacklistCurrentPlaylist({"playlist":this.media(),"message":"Could not determine codecs for playlist.","blacklistDuration":1/0})},i.tryToCreateSourceBuffers_=function tryToCreateSourceBuffers_(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.hasCreatedSourceBuffers()&&this.areMediaTypesKnown_()){var e=this.getCodecsOrExclude_();if(e){this.sourceUpdater_.createSourceBuffers(e);var i=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(i)}}},i.excludeUnsupportedVariants_=function excludeUnsupportedVariants_(){var e=this,i=this.master().playlists,n=[];Object.keys(i).forEach((function(a){var s=i[a];if(-1===n.indexOf(s.id)){n.push(s.id);var o=gs(e.master,s),u=[];!o.audio||Object(Fe.muxerSupportsCodec)(o.audio)||Object(Fe.browserSupportsCodec)(o.audio)||(s.excludeUntil=1/0,u.push("audio codec "+o.audio)),!o.video||Object(Fe.muxerSupportsCodec)(o.video)||Object(Fe.browserSupportsCodec)(o.video)||(s.excludeUntil=1/0,u.push("video codec "+o.video)),o.text&&"stpp.ttml.im1t"===o.text&&(s.excludeUntil=1/0,u.push("text codec "+o.text)),u.length&&e.logger_("excluding "+s.id+" as codecs "+u.join(", ")+" are unsupported")}}))},i.excludeIncompatibleVariants_=function excludeIncompatibleVariants_(e){var i=this,n=Object(Fe.parseCodecs)(e),a=Object.keys(n).length;this.master().playlists.forEach((function(e){if(e.excludeUntil!==1/0){var s={},o=2,u=[],l=gs(i.masterPlaylistLoader_.master,e);if(l.audio||l.video){var c=[l.video,l.audio].filter(Boolean).join(",");s=Object(Fe.parseCodecs)(c),o=Object.keys(s).length}o!==a&&(u.push('codec count "'+o+'" !== "'+a+'"'),e.excludeUntil=1/0),i.sourceUpdater_.canChangeType()||(s.video&&n.video&&s.video.type.toLowerCase()!==n.video.type.toLowerCase()&&(u.push('video codec "'+s.video.type+'" !== "'+n.video.type+'"'),e.excludeUntil=1/0),s.audio&&n.audio&&s.audio.type.toLowerCase()!==n.audio.type.toLowerCase()&&(e.excludeUntil=1/0,u.push('audio codec "'+s.audio.type+'" !== "'+n.audio.type+'"'))),u.length&&i.logger_("blacklisting "+e.id+": "+u.join(" && "))}}))},i.updateAdCues_=function updateAdCues_(e){var i=0,n=this.seekable();n.length&&(i=n.start(0)),function updateAdCues(e,i,n){if(void 0===n&&(n=0),e.segments)for(var a,o=n,u=0;u<e.segments.length;u++){var l=e.segments[u];if(a||(a=no(i,o+l.duration/2)),a){if("cueIn"in l){a.endTime=o,a.adEndTime=o,o+=l.duration,a=null;continue}if(o<a.endTime){o+=l.duration;continue}a.endTime+=l.duration}else if("cueOut"in l&&((a=new s.a.VTTCue(o,o+l.duration,l.cueOut)).adStartTime=o,a.adEndTime=o+parseFloat(l.cueOut),i.addCue(a)),"cueOutCont"in l){var c=l.cueOutCont.split("/").map(parseFloat),h=c[0],f=c[1];(a=new s.a.VTTCue(o,o+l.duration,"")).adStartTime=o-h,a.adEndTime=a.adStartTime+f,i.addCue(a)}o+=l.duration}}(e,this.cueTagsTrack_,i)},i.goalBufferLength=function goalBufferLength(){var e=this.tech_.currentTime(),i=Ua.GOAL_BUFFER_LENGTH,n=Ua.GOAL_BUFFER_LENGTH_RATE,a=Math.max(i,Ua.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+e*n,a)},i.bufferLowWaterLine=function bufferLowWaterLine(){var e=this.tech_.currentTime(),i=Ua.BUFFER_LOW_WATER_LINE,n=Ua.BUFFER_LOW_WATER_LINE_RATE,a=Math.max(i,Ua.MAX_BUFFER_LOW_WATER_LINE),s=Math.max(i,Ua.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+e*n,this.experimentalBufferBasedABR?s:a)},i.bufferHighWaterLine=function bufferHighWaterLine(){return Ua.BUFFER_HIGH_WATER_LINE},MasterPlaylistController}(videojs$1.EventTarget),To=function Representation(e,i,n){var a=e.masterPlaylistController_,s=a[(e.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(a);if(i.attributes.RESOLUTION){var o=i.attributes.RESOLUTION;this.width=o.width,this.height=o.height}this.bandwidth=i.attributes.BANDWIDTH,this.codecs=gs(a.master(),i),this.playlist=i,this.id=n,this.enabled=function enableFunction(e,i,n){return function(a){var s=e.master.playlists[i],o=da(s),u=ha(s);return void 0===a?u:(a?delete s.disabled:s.disabled=!0,a===u||o||(n(),a?e.trigger("renditionenabled"):e.trigger("renditiondisabled")),a)}}(e.playlists,i.id,s)},bo=["seeking","seeked","pause","playing","error"],So=function(){function PlaybackWatcher(e){var i=this;this.masterPlaylistController_=e.masterPlaylistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=vs("PlaybackWatcher"),this.logger_("initialize");var n=function canPlayHandler(){return i.monitorCurrentTime_()},a=function waitingHandler(){return i.techWaiting_()},o=function cancelTimerHandler(){return i.cancelTimer_()},u=function fixesBadSeeksHandler(){return i.fixesBadSeeks_()},l=this.masterPlaylistController_,c=["main","subtitle","audio"],h={};c.forEach((function(e){h[e]={"reset":function reset(){return i.resetSegmentDownloads_(e)},"updateend":function updateend(){return i.checkSegmentDownloads_(e)}},l[e+"SegmentLoader_"].on("appendsdone",h[e].updateend),l[e+"SegmentLoader_"].on("playlistupdate",h[e].reset),i.tech_.on(["seeked","seeking"],h[e].reset)})),this.tech_.on("seekablechanged",u),this.tech_.on("waiting",a),this.tech_.on(bo,o),this.tech_.on("canplay",n),this.dispose=function(){i.logger_("dispose"),i.tech_.off("seekablechanged",u),i.tech_.off("waiting",a),i.tech_.off(bo,o),i.tech_.off("canplay",n),c.forEach((function(e){l[e+"SegmentLoader_"].off("appendsdone",h[e].updateend),l[e+"SegmentLoader_"].off("playlistupdate",h[e].reset),i.tech_.off(["seeked","seeking"],h[e].reset)})),i.checkCurrentTimeTimeout_&&s.a.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}var e=PlaybackWatcher.prototype;return e.monitorCurrentTime_=function monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&s.a.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=s.a.setTimeout(this.monitorCurrentTime_.bind(this),250)},e.resetSegmentDownloads_=function resetSegmentDownloads_(e){var i=this.masterPlaylistController_[e+"SegmentLoader_"];this[e+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+e+" loader"),this[e+"StalledDownloads_"]=0,this[e+"Buffered_"]=i.buffered_()},e.checkSegmentDownloads_=function checkSegmentDownloads_(e){var i=this.masterPlaylistController_,n=i[e+"SegmentLoader_"],a=n.buffered_(),s=function isRangeDifferent(e,i){if(e===i)return!1;if(!e&&i||!i&&e)return!0;if(e.length!==i.length)return!0;for(var n=0;n<e.length;n++)if(e.start(n)!==i.start(n)||e.end(n)!==i.end(n))return!0;return!1}(this[e+"Buffered_"],a);this[e+"Buffered_"]=a,s?this.resetSegmentDownloads_(e):(this[e+"StalledDownloads_"]++,this.logger_("found #"+this[e+"StalledDownloads_"]+" "+e+" appends that did not increase buffer (possible stalled download)",{"playlistId":n.playlist_&&n.playlist_.id,"buffered":na(a)}),this[e+"StalledDownloads_"]<10||(this.logger_(e+" loader stalled download exclusion"),this.resetSegmentDownloads_(e),this.tech_.trigger({"type":"usage","name":"vhs-"+e+"-download-exclusion"}),"subtitle"!==e&&i.blacklistCurrentPlaylist({"message":"Excessive "+e+" segment downloading detected."},1/0)))},e.checkCurrentTime_=function checkCurrentTime_(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),i=this.tech_.buffered();if(this.lastRecordedTime===e&&(!i.length||e+.1>=i.end(i.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}},e.cancelTimer_=function cancelTimer_(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},e.fixesBadSeeks_=function fixesBadSeeks_(){if(!this.tech_.seeking())return!1;var e,i=this.seekable(),n=this.tech_.currentTime();this.afterSeekableWindow_(i,n,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(e=i.end(i.length-1));if(this.beforeSeekableWindow_(i,n)){var a=i.start(0);e=a+(a===i.end(0)?0:.1)}if(void 0!==e)return this.logger_("Trying to seek outside of seekable at time "+n+" with seekable range "+ia(i)+". Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0;var s=this.tech_.buffered();return!!function closeToBufferedContent(e){var i=e.buffered,n=e.targetDuration,a=e.currentTime;return!!i.length&&(!(i.end(0)-i.start(0)<2*n)&&(!(a>i.start(0))&&i.start(0)-a<n))}({"buffered":s,"targetDuration":this.media().targetDuration,"currentTime":n})&&(e=s.start(0)+.1,this.logger_("Buffered region starts ("+s.start(0)+")  just beyond seek point ("+n+"). Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0)},e.waiting_=function waiting_(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),i=this.tech_.buffered(),n=ea(i,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),this.tech_.trigger({"type":"usage","name":"vhs-unknown-waiting"}),void this.tech_.trigger({"type":"usage","name":"hls-unknown-waiting"})):void 0}},e.techWaiting_=function techWaiting_(){var e=this.seekable(),i=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,i)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+i+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.tech_.setCurrentTime(n),this.tech_.trigger({"type":"usage","name":"vhs-live-resync"}),this.tech_.trigger({"type":"usage","name":"hls-live-resync"}),!0}var a=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,s=this.tech_.buffered();if(this.videoUnderflow_({"audioBuffered":a.audioBuffered(),"videoBuffered":a.videoBuffered(),"currentTime":i}))return this.cancelTimer_(),this.tech_.setCurrentTime(i),this.tech_.trigger({"type":"usage","name":"vhs-video-underflow"}),this.tech_.trigger({"type":"usage","name":"hls-video-underflow"}),!0;var o=ta(s,i);if(o.length>0){var u=o.start(0)-i;return this.logger_("Stopped at "+i+", setting timer for "+u+", seeking to "+o.start(0)),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*u,i),!0}return!1},e.afterSeekableWindow_=function afterSeekableWindow_(e,i,n,a){if(void 0===a&&(a=!1),!e.length)return!1;var s=e.end(e.length-1)+.1;return!n.endList&&a&&(s=e.end(e.length-1)+3*n.targetDuration),i>s},e.beforeSeekableWindow_=function beforeSeekableWindow_(e,i){return!!(e.length&&e.start(0)>0&&i<e.start(0)-this.liveRangeSafeTimeDelta)},e.videoUnderflow_=function videoUnderflow_(e){var i=e.videoBuffered,n=e.audioBuffered,a=e.currentTime;if(i){var s;if(i.length&&n.length){var o=ea(i,a-3),u=ea(i,a),l=ea(n,a);l.length&&!u.length&&o.length&&(s={"start":o.end(0),"end":l.end(0)})}else{ta(i,a).length||(s=this.gapFromVideoUnderflow_(i,a))}return!!s&&(this.logger_("Encountered a gap in video from "+s.start+" to "+s.end+". Seeking to current time "+a),!0)}},e.skipTheGap_=function skipTheGap_(e){var i=this.tech_.buffered(),n=this.tech_.currentTime(),a=ta(i,n);this.cancelTimer_(),0!==a.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",a.start(0)),this.tech_.setCurrentTime(a.start(0)+1/30),this.tech_.trigger({"type":"usage","name":"vhs-gap-skip"}),this.tech_.trigger({"type":"usage","name":"hls-gap-skip"}))},e.gapFromVideoUnderflow_=function gapFromVideoUnderflow_(e,i){for(var n=function findGaps(e){if(e.length<2)return videojs$1.createTimeRanges();for(var i=[],n=1;n<e.length;n++){var a=e.end(n-1),s=e.start(n);i.push([a,s])}return videojs$1.createTimeRanges(i)}(e),a=0;a<n.length;a++){var s=n.start(a),o=n.end(a);if(i-s<4&&i-s>2)return{"start":s,"end":o}}return null},PlaybackWatcher}(),Co={"errorInterval":30,"getSource":function getSource(e){return e(this.tech({"IWillNotUseThisInPlugins":!0}).currentSource_||this.currentSource())}},ko=function reloadSourceOnError(e){!function initPlugin(e,i){var n=0,a=0,s=videojs$1.mergeOptions(Co,i);e.ready((function(){e.trigger({"type":"usage","name":"vhs-error-reload-initialized"}),e.trigger({"type":"usage","name":"hls-error-reload-initialized"})}));var o=function loadedMetadataHandler(){a&&e.currentTime(a)},u=function setSource(i){null!=i&&(a=e.duration()!==1/0&&e.currentTime()||0,e.one("loadedmetadata",o),e.src(i),e.trigger({"type":"usage","name":"vhs-error-reload"}),e.trigger({"type":"usage","name":"hls-error-reload"}),e.play())},l=function errorHandler(){return Date.now()-n<1e3*s.errorInterval?(e.trigger({"type":"usage","name":"vhs-error-reload-canceled"}),void e.trigger({"type":"usage","name":"hls-error-reload-canceled"})):s.getSource&&"function"==typeof s.getSource?(n=Date.now(),s.getSource.call(e,u)):void videojs$1.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")},c=function cleanupEvents(){e.off("loadedmetadata",o),e.off("error",l),e.off("dispose",cleanupEvents)};e.on("error",l),e.on("dispose",c),e.reloadSourceOnError=function reinitPlugin(i){c(),initPlugin(e,i)}}(this,e)},Eo={"PlaylistLoader":Jr,"Playlist":ma,"utils":Ia,"STANDARD_PLAYLIST_SELECTOR":ks,"INITIAL_PLAYLIST_SELECTOR":function lowestBitrateCompatibleVariantSelector(){var e=this,i=this.playlists.master.playlists.filter(ma.isEnabled);return bs(i,(function(e,i){return Ss(e,i)})),i.filter((function(i){return!!gs(e.playlists.master,i).video}))[0]||null},"lastBandwidthSelector":ks,"movingAverageBandwidthSelector":function movingAverageBandwidthSelector(e){var i=-1;if(e<0||e>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var n=this.useDevicePixelRatio&&s.a.devicePixelRatio||1;return i<0&&(i=this.systemBandwidth),i=e*this.systemBandwidth+(1-e)*i,Cs(this.playlists.master,i,parseInt(Ts(this.tech_.el(),"width"),10)*n,parseInt(Ts(this.tech_.el(),"height"),10)*n,this.limitRenditionByPlayerDimensions)}},"comparePlaylistBandwidth":Ss,"comparePlaylistResolution":function comparePlaylistResolution(e,i){var n,a;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||s.a.Number.MAX_VALUE,i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width&&(a=i.attributes.RESOLUTION.width),n===(a=a||s.a.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&i.attributes.BANDWIDTH?e.attributes.BANDWIDTH-i.attributes.BANDWIDTH:n-a},"xhr":_a()};Object.keys(Ua).forEach((function(e){Object.defineProperty(Eo,e,{"get":function get(){return videojs$1.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing"),Ua[e]},"set":function set(i){videojs$1.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing"),"number"!=typeof i||i<0?videojs$1.log.warn("value of Vhs."+e+" must be greater than or equal to 0"):Ua[e]=i}})}));var wo=function handleVhsMediaChange(e,i){for(var n=i.media(),a=-1,s=0;s<e.length;s++)if(e[s].id===n.id){a=s;break}e.selectedIndex_=a,e.trigger({"selectedIndex":a,"type":"change"})};Eo.canPlaySource=function(){return videojs$1.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Po=function waitForKeySessionCreation(e){var i=e.player,n=e.sourceKeySystems,a=e.audioMedia,s=e.mainPlaylists;if(!i.eme.initializeMediaKeys)return Promise.resolve();var o=function getAllPsshKeySystemsOptions(e,i){return e.reduce((function(e,n){if(!n.contentProtection)return e;var a=i.reduce((function(e,i){var a=n.contentProtection[i];return a&&a.pssh&&(e[i]={"pssh":a.pssh}),e}),{});return Object.keys(a).length&&e.push(a),e}),[])}(a?s.concat([a]):s,Object.keys(n)),u=[],l=[];return o.forEach((function(e){l.push(new Promise((function(e,n){i.tech_.one("keysessioncreated",e)}))),u.push(new Promise((function(n,a){i.eme.initializeMediaKeys({"keySystems":e},(function(e){e?a(e):n()}))})))})),Promise.race([Promise.all(u),Promise.race(l)])},Io=function setupEmeOptions(e){var i=e.player,n=function emeKeySystems(e,i,n){if(!e)return e;var a={"video":i&&i.attributes&&i.attributes.CODECS,"audio":n&&n.attributes&&n.attributes.CODECS};!a.audio&&a.video&&a.video.split(",").length>1&&a.video.split(",").forEach((function(e){e=e.trim(),Object(Fe.isAudioCodec)(e)?a.audio=e:Object(Fe.isVideoCodec)(e)&&(a.video=e)}));var s=a.video?'video/mp4;codecs="'+a.video+'"':null,o=a.audio?'audio/mp4;codecs="'+a.audio+'"':null,u={};for(var l in e)u[l]={"audioContentType":o,"videoContentType":s},i.contentProtection&&i.contentProtection[l]&&i.contentProtection[l].pssh&&(u[l].pssh=i.contentProtection[l].pssh),"string"==typeof e[l]&&(u[l].url=e[l]);return videojs$1.mergeOptions(e,u)}(e.sourceKeySystems,e.media,e.audioMedia);return!!n&&(i.currentSource().keySystems=n,!(n&&!i.eme)||(videojs$1.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1))},xo=function getVhsLocalStorage(){if(!s.a.localStorage)return null;var e=s.a.localStorage.getItem("videojs-vhs");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};Eo.supportsNativeHls=function(){if(!u.a||!u.a.createElement)return!1;var e=u.a.createElement("video");if(!videojs$1.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(i){return/maybe|probably/i.test(e.canPlayType(i))}))}(),Eo.supportsNativeDash=!!(u.a&&u.a.createElement&&videojs$1.getTech("Html5").isSupported())&&/maybe|probably/i.test(u.a.createElement("video").canPlayType("application/dash+xml")),Eo.supportsTypeNatively=function(e){return"hls"===e?Eo.supportsNativeHls:"dash"===e&&Eo.supportsNativeDash},Eo.isSupported=function(){return videojs$1.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Ao=function(e){function VhsHandler(i,n,a){var s;if(s=e.call(this,n,videojs$1.mergeOptions(a.hls,a.vhs))||this,a.hls&&Object.keys(a.hls).length&&videojs$1.log.warn("Using hls options is deprecated. Use vhs instead."),s.logger_=vs("VhsHandler"),n.options_&&n.options_.playerId){var o=videojs$1(n.options_.playerId);o.hasOwnProperty("hls")||Object.defineProperty(o,"hls",{"get":function get(){return videojs$1.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),n.trigger({"type":"usage","name":"hls-player-access"}),f()(s)},"configurable":!0}),o.hasOwnProperty("vhs")||Object.defineProperty(o,"vhs",{"get":function get(){return videojs$1.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),n.trigger({"type":"usage","name":"vhs-player-access"}),f()(s)},"configurable":!0}),o.hasOwnProperty("dash")||Object.defineProperty(o,"dash",{"get":function get(){return videojs$1.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),f()(s)},"configurable":!0}),s.player_=o}if(s.tech_=n,s.source_=i,s.stats={},s.ignoreNextSeekingEvent_=!1,s.setOptions_(),s.options_.overrideNative&&n.overrideNativeAudioTracks&&n.overrideNativeVideoTracks)n.overrideNativeAudioTracks(!0),n.overrideNativeVideoTracks(!0);else if(s.options_.overrideNative&&(n.featuresNativeVideoTracks||n.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return s.on(u.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var i=u.a.fullscreenElement||u.a.webkitFullscreenElement||u.a.mozFullScreenElement||u.a.msFullscreenElement;i&&i.contains(s.tech_.el())&&s.masterPlaylistController_.smoothQualityChange_()})),s.on(s.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),s.on(s.tech_,"error",(function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()})),s.on(s.tech_,"play",s.play),s}g()(VhsHandler,e);var i=VhsHandler.prototype;return i.setOptions_=function setOptions_(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=!1!==this.options_.handleManifestRedirects,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.handlePartialData=this.options_.handlePartialData||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var i=xo();i&&i.bandwidth&&(this.options_.bandwidth=i.bandwidth,this.tech_.trigger({"type":"usage","name":"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({"type":"usage","name":"hls-bandwidth-from-local-storage"})),i&&i.throughput&&(this.options_.throughput=i.throughput,this.tech_.trigger({"type":"usage","name":"vhs-throughput-from-local-storage"}),this.tech_.trigger({"type":"usage","name":"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Ua.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ua.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","handlePartialData","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta"].forEach((function(i){void 0!==e.source_[i]&&(e.options_[i]=e.source_[i])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},i.src=function src(e,i){var n=this;if(e){this.setOptions_(),this.options_.src=function expandDataUri(e){return 0===e.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(e.substring(e.indexOf(",")+1)):e}(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Eo,this.options_.sourceType=Object(j.simpleTypeFromSourceType)(i),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e)},this.masterPlaylistController_=new _o(this.options_);var a=videojs$1.mergeOptions({"liveRangeSafeTimeDelta":.1},this.options_,{"seekable":function seekable(){return n.seekable()},"media":function media(){return n.masterPlaylistController_.media()},"masterPlaylistController":this.masterPlaylistController_});this.playbackWatcher_=new So(a),this.masterPlaylistController_.on("error",(function(){var e=videojs$1.players[n.tech_.options_.playerId],i=n.masterPlaylistController_.error;"object"!=typeof i||i.code?"string"==typeof i&&(i={"message":i,"code":3}):i.code=3,e.error(i)}));var o=this.options_.experimentalBufferBasedABR?Eo.movingAverageBandwidthSelector(.55):Eo.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):o.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Eo.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{"selectPlaylist":{"get":function get(){return this.masterPlaylistController_.selectPlaylist},"set":function set(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},"throughput":{"get":function get(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},"set":function set(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},"bandwidth":{"get":function get(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},"set":function set(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={"rate":0,"count":0}}},"systemBandwidth":{"get":function get(){var e,i=1/(this.bandwidth||1);return e=this.throughput>0?1/this.throughput:0,Math.floor(1/(i+e))},"set":function set(){videojs$1.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{"bandwidth":{"get":function get(){return n.bandwidth||0},"enumerable":!0},"mediaRequests":{"get":function get(){return n.masterPlaylistController_.mediaRequests_()||0},"enumerable":!0},"mediaRequestsAborted":{"get":function get(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},"enumerable":!0},"mediaRequestsTimedout":{"get":function get(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},"enumerable":!0},"mediaRequestsErrored":{"get":function get(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},"enumerable":!0},"mediaTransferDuration":{"get":function get(){return n.masterPlaylistController_.mediaTransferDuration_()||0},"enumerable":!0},"mediaBytesTransferred":{"get":function get(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},"enumerable":!0},"mediaSecondsLoaded":{"get":function get(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},"enumerable":!0},"buffered":{"get":function get(){return na(n.tech_.buffered())},"enumerable":!0},"currentTime":{"get":function get(){return n.tech_.currentTime()},"enumerable":!0},"currentSource":{"get":function get(){return n.tech_.currentSource_},"enumerable":!0},"currentTech":{"get":function get(){return n.tech_.name_},"enumerable":!0},"duration":{"get":function get(){return n.tech_.duration()},"enumerable":!0},"master":{"get":function get(){return n.playlists.master},"enumerable":!0},"playerDimensions":{"get":function get(){return n.tech_.currentDimensions()},"enumerable":!0},"seekable":{"get":function get(){return na(n.tech_.seekable())},"enumerable":!0},"timestamp":{"get":function get(){return Date.now()},"enumerable":!0},"videoPlaybackQuality":{"get":function get(){return n.tech_.getVideoPlaybackQuality()},"enumerable":!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",(function(){n.options_.useBandwidthFromLocalStorage&&function updateVhsLocalStorage(e){if(!s.a.localStorage)return!1;var i=xo();i=i?videojs$1.mergeOptions(i,e):e;try{s.a.localStorage.setItem("videojs-vhs",JSON.stringify(i))}catch(e){return!1}}({"bandwidth":n.bandwidth,"throughput":Math.round(n.throughput)})})),this.masterPlaylistController_.on("selectedinitialmedia",(function(){!function renditionSelectionMixin(e){var i=e.playlists;e.representations=function(){return i&&i.master&&i.master.playlists?i.master.playlists.filter((function(e){return!da(e)})).map((function(i,n){return new To(e,i,i.id)})):[]}}(n)})),this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",(function(){n.setupEme_()})),this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.masterPlaylistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=s.a.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},i.setupEme_=function setupEme_(){var e=this,i=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,n=Io({"player":this.player_,"sourceKeySystems":this.source_.keySystems,"media":this.playlists.media(),"audioMedia":i&&i.media()});11!==videojs$1.browser.IE_VERSION&&n?(this.logger_("waiting for EME key session creation"),Po({"player":this.player_,"sourceKeySystems":this.source_.keySystems,"audioMedia":i&&i.media(),"mainPlaylists":this.playlists.master.playlists}).then((function(){e.logger_("created EME key session"),e.masterPlaylistController_.sourceUpdater_.initializedEme()})).catch((function(i){e.logger_("error while creating EME key session",i),e.player_.error({"message":"Failed to initialize media keys for EME","code":3})}))):this.masterPlaylistController_.sourceUpdater_.initializedEme()},i.setupQualityLevels_=function setupQualityLevels_(){var e=this,i=videojs$1.players[this.tech_.options_.playerId];i&&i.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=i.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",(function(){!function handleVhsLoadedMetadata(e,i){i.representations().forEach((function(i){e.addQualityLevel(i)})),wo(e,i.playlists)}(e.qualityLevels_,e)})),this.playlists.on("mediachange",(function(){wo(e.qualityLevels_,e.playlists)})))},VhsHandler.version=function version$5(){return{"@videojs/http-streaming":"2.4.2","mux.js":"5.8.0","mpd-parser":"0.15.0","m3u8-parser":"4.5.0","aes-decrypter":"3.1.0"}},i.version=function version(){return this.constructor.version()},i.canChangeType=function canChangeType(){return Zs.canChangeType()},i.play=function play(){this.masterPlaylistController_.play()},i.setCurrentTime=function setCurrentTime(e){this.masterPlaylistController_.setCurrentTime(e)},i.duration=function duration(){return this.masterPlaylistController_.duration()},i.seekable=function seekable(){return this.masterPlaylistController_.seekable()},i.dispose=function dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&s.a.URL.revokeObjectURL&&(s.a.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),e.prototype.dispose.call(this)},i.convertToProgramTime=function convertToProgramTime(e,i){return xa({"playlist":this.masterPlaylistController_.media(),"time":e,"callback":i})},i.seekToProgramTime=function seekToProgramTime$1(e,i,n,a){return void 0===n&&(n=!0),void 0===a&&(a=2),Aa({"programTime":e,"playlist":this.masterPlaylistController_.media(),"retryCount":a,"pauseAfterSeek":n,"seekTo":this.options_.seekTo,"tech":this.options_.tech,"callback":i})},VhsHandler}(videojs$1.getComponent("Component")),Lo={"name":"videojs-http-streaming","VERSION":"2.4.2","canHandleSource":function canHandleSource(e,i){void 0===i&&(i={});var n=videojs$1.mergeOptions(videojs$1.options,i);return Lo.canPlayType(e.type,n)},"handleSource":function handleSource(e,i,n){void 0===n&&(n={});var a=videojs$1.mergeOptions(videojs$1.options,n);return i.vhs=new Ao(e,i,a),videojs$1.hasOwnProperty("hls")||Object.defineProperty(i,"hls",{"get":function get(){return videojs$1.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),i.vhs},"configurable":!0}),i.vhs.xhr=_a(),i.vhs.src(e.src,e.type),i.vhs},"canPlayType":function canPlayType(e,i){void 0===i&&(i={});var n=videojs$1.mergeOptions(videojs$1.options,i).vhs.overrideNative,a=void 0===n?!videojs$1.browser.IS_ANY_SAFARI:n,s=Object(j.simpleTypeFromSourceType)(e);return s&&(!Eo.supportsTypeNatively(s)||a)?"maybe":""}};(function supportsNativeMediaSources(){return Object(Fe.browserSupportsCodec)("avc1.4d400d,mp4a.40.2")})()&&videojs$1.getTech("Html5").registerSourceHandler(Lo,0),videojs$1.VhsHandler=Ao,Object.defineProperty(videojs$1,"HlsHandler",{"get":function get(){return videojs$1.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),Ao},"configurable":!0}),videojs$1.VhsSourceHandler=Lo,Object.defineProperty(videojs$1,"HlsSourceHandler",{"get":function get(){return videojs$1.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),Lo},"configurable":!0}),videojs$1.Vhs=Eo,Object.defineProperty(videojs$1,"Hls",{"get":function get(){return videojs$1.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),Eo},"configurable":!0}),videojs$1.use||(videojs$1.registerComponent("Hls",Eo),videojs$1.registerComponent("Vhs",Eo)),videojs$1.options.vhs=videojs$1.options.vhs||{},videojs$1.options.hls=videojs$1.options.hls||{},videojs$1.registerPlugin?videojs$1.registerPlugin("reloadSourceOnError",ko):videojs$1.plugin("reloadSourceOnError",ko);i.a=videojs$1}])]);